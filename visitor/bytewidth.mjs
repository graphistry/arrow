/* istanbul ignore file */
import { Visitor } from '../visitor';
import { TimeUnit } from '../enum';
/** @ignore */ const sum = (x, y) => x + y;
/** @ignore */ const variableWidthColumnErrorMessage = (type) => `Cannot compute the byte width of variable-width column ${type}`;
export class ByteWidthVisitor extends Visitor {
    visitNull(____) { return 0; }
    visitInt(type) { return type.bitWidth / 8; }
    visitFloat(type) { return type.ArrayType.BYTES_PER_ELEMENT; }
    visitBinary(type) { throw new Error(variableWidthColumnErrorMessage(type)); }
    visitUtf8(type) { throw new Error(variableWidthColumnErrorMessage(type)); }
    visitBool(____) { return 1 / 8; }
    visitDecimal(____) { return 16; }
    visitDate(type) { return (type.unit + 1) * 4; }
    visitTime(type) { return type.bitWidth / 8; }
    visitTimestamp(type) { return type.unit === TimeUnit.SECOND ? 4 : 8; }
    visitInterval(type) { return (type.unit + 1) * 4; }
    visitList(type) { throw new Error(variableWidthColumnErrorMessage(type)); }
    visitStruct(type) { return this.visitFields(type.children).reduce(sum, 0); }
    visitUnion(type) { return this.visitFields(type.children).reduce(sum, 0); }
    visitFixedSizeBinary(type) { return type.byteWidth; }
    visitFixedSizeList(type) { return type.listSize * this.visitFields(type.children).reduce(sum, 0); }
    visitMap(type) { return this.visitFields(type.children).reduce(sum, 0); }
    visitDictionary(type) { return this.visit(type.indices); }
    visitFields(fields) { return (fields || []).map((field) => this.visit(field.type)); }
    visitSchema(schema) { return this.visitFields(schema.fields).reduce(sum, 0); }
}
export const instance = new ByteWidthVisitor();

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZpc2l0b3IvYnl0ZXdpZHRoLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLDBCQUEwQjtBQW9CMUIsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLFlBQVksQ0FBQztBQUVyQyxPQUFPLEVBQVEsUUFBUSxFQUFFLE1BQU0sU0FBUyxDQUFDO0FBU3pDLGNBQWMsQ0FBQyxNQUFNLEdBQUcsR0FBRyxDQUFDLENBQVMsRUFBRSxDQUFTLEVBQUUsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDM0QsY0FBYyxDQUFDLE1BQU0sK0JBQStCLEdBQUcsQ0FBQyxJQUFjLEVBQUUsRUFBRSxDQUFDLDBEQUEwRCxJQUFJLEVBQUUsQ0FBQztBQVM1SSxNQUFNLE9BQU8sZ0JBQWlCLFNBQVEsT0FBTztJQUNsQyxTQUFTLENBQWEsSUFBVSxJQUFnQixPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDM0QsUUFBUSxDQUFjLElBQVMsSUFBaUIsT0FBTyxJQUFJLENBQUMsUUFBUSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDM0UsVUFBVSxDQUFZLElBQVcsSUFBZSxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDO0lBQzFGLFdBQVcsQ0FBVyxJQUFZLElBQWMsTUFBTSxJQUFJLEtBQUssQ0FBQywrQkFBK0IsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN6RyxTQUFTLENBQWEsSUFBVSxJQUFnQixNQUFNLElBQUksS0FBSyxDQUFDLCtCQUErQixDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3pHLFNBQVMsQ0FBYSxJQUFVLElBQWdCLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDL0QsWUFBWSxDQUFVLElBQWEsSUFBYSxPQUFPLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDNUQsU0FBUyxDQUFhLElBQVcsSUFBZSxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzdFLFNBQVMsQ0FBYSxJQUFVLElBQWdCLE9BQU8sSUFBSSxDQUFDLFFBQVEsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzNFLGNBQWMsQ0FBUSxJQUFlLElBQVcsT0FBTyxJQUFJLENBQUMsSUFBSSxLQUFLLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUMvRixhQUFhLENBQVMsSUFBYyxJQUFZLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDN0UsU0FBUyxDQUFhLElBQVUsSUFBZ0IsTUFBTSxJQUFJLEtBQUssQ0FBQywrQkFBK0IsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN6RyxXQUFXLENBQVcsSUFBWSxJQUFjLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDeEcsVUFBVSxDQUFZLElBQVcsSUFBZSxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3hHLG9CQUFvQixDQUFFLElBQXFCLElBQUssT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztJQUN4RSxrQkFBa0IsQ0FBSSxJQUFtQixJQUFPLE9BQU8sSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN4SCxRQUFRLENBQWMsSUFBVSxJQUFnQixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3hHLGVBQWUsQ0FBTyxJQUFnQixJQUFVLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2xGLFdBQVcsQ0FBVyxNQUFlLElBQVcsT0FBTyxDQUFDLE1BQU0sSUFBSSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQy9HLFdBQVcsQ0FBVyxNQUFjLElBQVksT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztDQUNsSDtBQUVELE1BQU0sQ0FBQyxNQUFNLFFBQVEsR0FBRyxJQUFJLGdCQUFnQixFQUFFLENBQUMiLCJmaWxlIjoidmlzaXRvci9ieXRld2lkdGguanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBpc3RhbmJ1bCBpZ25vcmUgZmlsZSAqL1xuXG4vLyBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4vLyBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbi8vIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4vLyByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4vLyB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4vLyBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Vcbi8vIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbi8vXG4vLyAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuLy9cbi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbi8vIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4vLyBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuLy8gS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4vLyBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4vLyB1bmRlciB0aGUgTGljZW5zZS5cblxuaW1wb3J0IHsgRGF0YSB9IGZyb20gJy4uL2RhdGEnO1xuaW1wb3J0IHsgVmlzaXRvciB9IGZyb20gJy4uL3Zpc2l0b3InO1xuaW1wb3J0IHsgVmVjdG9yIH0gZnJvbSAnLi4vaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBUeXBlLCBUaW1lVW5pdCB9IGZyb20gJy4uL2VudW0nO1xuaW1wb3J0IHsgU2NoZW1hLCBGaWVsZCB9IGZyb20gJy4uL3NjaGVtYSc7XG5pbXBvcnQge1xuICAgIERhdGFUeXBlLCBEaWN0aW9uYXJ5LFxuICAgIEZsb2F0LCBJbnQsIERhdGVfLCBJbnRlcnZhbCwgVGltZSwgVGltZXN0YW1wLFxuICAgIEJvb2wsIE51bGwsIFV0ZjgsIEJpbmFyeSwgRGVjaW1hbCwgRml4ZWRTaXplQmluYXJ5LFxuICAgIExpc3QsIEZpeGVkU2l6ZUxpc3QsIE1hcF8sIFN0cnVjdCwgVW5pb24sXG59IGZyb20gJy4uL3R5cGUnO1xuXG4vKiogQGlnbm9yZSAqLyBjb25zdCBzdW0gPSAoeDogbnVtYmVyLCB5OiBudW1iZXIpID0+IHggKyB5O1xuLyoqIEBpZ25vcmUgKi8gY29uc3QgdmFyaWFibGVXaWR0aENvbHVtbkVycm9yTWVzc2FnZSA9ICh0eXBlOiBEYXRhVHlwZSkgPT4gYENhbm5vdCBjb21wdXRlIHRoZSBieXRlIHdpZHRoIG9mIHZhcmlhYmxlLXdpZHRoIGNvbHVtbiAke3R5cGV9YDtcblxuZXhwb3J0IGludGVyZmFjZSBCeXRlV2lkdGhWaXNpdG9yIGV4dGVuZHMgVmlzaXRvciB7XG4gICAgdmlzaXQ8VCBleHRlbmRzIERhdGFUeXBlPihub2RlOiBUKTogbnVtYmVyO1xuICAgIHZpc2l0TWFueTxUIGV4dGVuZHMgRGF0YVR5cGU+KG5vZGVzOiBUW10pOiBudW1iZXJbXTtcbiAgICBnZXRWaXNpdEZuPFQgZXh0ZW5kcyBUeXBlPiAgICAobm9kZTogVCk6ICh0eXBlOiBEYXRhVHlwZTxUPikgPT4gbnVtYmVyO1xuICAgIGdldFZpc2l0Rm48VCBleHRlbmRzIERhdGFUeXBlPihub2RlOiBWZWN0b3I8VD4gfCBEYXRhPFQ+IHwgVCk6ICh0eXBlOiBUKSA9PiBudW1iZXI7XG59XG5cbmV4cG9ydCBjbGFzcyBCeXRlV2lkdGhWaXNpdG9yIGV4dGVuZHMgVmlzaXRvciB7XG4gICAgcHVibGljIHZpc2l0TnVsbCAgICAgICAgICAgIChfX19fOiBOdWxsICAgICAgICAgICAgKSB7IHJldHVybiAwOyB9XG4gICAgcHVibGljIHZpc2l0SW50ICAgICAgICAgICAgICh0eXBlOiBJbnQgICAgICAgICAgICAgKSB7IHJldHVybiB0eXBlLmJpdFdpZHRoIC8gODsgfVxuICAgIHB1YmxpYyB2aXNpdEZsb2F0ICAgICAgICAgICAodHlwZTogRmxvYXQgICAgICAgICAgICkgeyByZXR1cm4gdHlwZS5BcnJheVR5cGUuQllURVNfUEVSX0VMRU1FTlQ7IH1cbiAgICBwdWJsaWMgdmlzaXRCaW5hcnkgICAgICAgICAgKHR5cGU6IEJpbmFyeSAgICAgICAgICApIHsgdGhyb3cgbmV3IEVycm9yKHZhcmlhYmxlV2lkdGhDb2x1bW5FcnJvck1lc3NhZ2UodHlwZSkpOyB9XG4gICAgcHVibGljIHZpc2l0VXRmOCAgICAgICAgICAgICh0eXBlOiBVdGY4ICAgICAgICAgICAgKSB7IHRocm93IG5ldyBFcnJvcih2YXJpYWJsZVdpZHRoQ29sdW1uRXJyb3JNZXNzYWdlKHR5cGUpKTsgfVxuICAgIHB1YmxpYyB2aXNpdEJvb2wgICAgICAgICAgICAoX19fXzogQm9vbCAgICAgICAgICAgICkgeyByZXR1cm4gMSAvIDg7IH1cbiAgICBwdWJsaWMgdmlzaXREZWNpbWFsICAgICAgICAgKF9fX186IERlY2ltYWwgICAgICAgICApIHsgcmV0dXJuIDE2OyB9XG4gICAgcHVibGljIHZpc2l0RGF0ZSAgICAgICAgICAgICh0eXBlOiBEYXRlXyAgICAgICAgICAgKSB7IHJldHVybiAodHlwZS51bml0ICsgMSkgKiA0OyB9XG4gICAgcHVibGljIHZpc2l0VGltZSAgICAgICAgICAgICh0eXBlOiBUaW1lICAgICAgICAgICAgKSB7IHJldHVybiB0eXBlLmJpdFdpZHRoIC8gODsgfVxuICAgIHB1YmxpYyB2aXNpdFRpbWVzdGFtcCAgICAgICAodHlwZTogVGltZXN0YW1wICAgICAgICkgeyByZXR1cm4gdHlwZS51bml0ID09PSBUaW1lVW5pdC5TRUNPTkQgPyA0IDogODsgfVxuICAgIHB1YmxpYyB2aXNpdEludGVydmFsICAgICAgICAodHlwZTogSW50ZXJ2YWwgICAgICAgICkgeyByZXR1cm4gKHR5cGUudW5pdCArIDEpICogNDsgfVxuICAgIHB1YmxpYyB2aXNpdExpc3QgICAgICAgICAgICAodHlwZTogTGlzdCAgICAgICAgICAgICkgeyB0aHJvdyBuZXcgRXJyb3IodmFyaWFibGVXaWR0aENvbHVtbkVycm9yTWVzc2FnZSh0eXBlKSk7IH1cbiAgICBwdWJsaWMgdmlzaXRTdHJ1Y3QgICAgICAgICAgKHR5cGU6IFN0cnVjdCAgICAgICAgICApIHsgcmV0dXJuIHRoaXMudmlzaXRGaWVsZHModHlwZS5jaGlsZHJlbikucmVkdWNlKHN1bSwgMCk7IH1cbiAgICBwdWJsaWMgdmlzaXRVbmlvbiAgICAgICAgICAgKHR5cGU6IFVuaW9uICAgICAgICAgICApIHsgcmV0dXJuIHRoaXMudmlzaXRGaWVsZHModHlwZS5jaGlsZHJlbikucmVkdWNlKHN1bSwgMCk7IH1cbiAgICBwdWJsaWMgdmlzaXRGaXhlZFNpemVCaW5hcnkgKHR5cGU6IEZpeGVkU2l6ZUJpbmFyeSApIHsgcmV0dXJuIHR5cGUuYnl0ZVdpZHRoOyB9XG4gICAgcHVibGljIHZpc2l0Rml4ZWRTaXplTGlzdCAgICh0eXBlOiBGaXhlZFNpemVMaXN0ICAgKSB7IHJldHVybiB0eXBlLmxpc3RTaXplICogdGhpcy52aXNpdEZpZWxkcyh0eXBlLmNoaWxkcmVuKS5yZWR1Y2Uoc3VtLCAwKTsgfVxuICAgIHB1YmxpYyB2aXNpdE1hcCAgICAgICAgICAgICAodHlwZTogTWFwXyAgICAgICAgICAgICkgeyByZXR1cm4gdGhpcy52aXNpdEZpZWxkcyh0eXBlLmNoaWxkcmVuKS5yZWR1Y2Uoc3VtLCAwKTsgfVxuICAgIHB1YmxpYyB2aXNpdERpY3Rpb25hcnkgICAgICAodHlwZTogRGljdGlvbmFyeSAgICAgICkgeyByZXR1cm4gdGhpcy52aXNpdCh0eXBlLmluZGljZXMpOyB9XG4gICAgcHVibGljIHZpc2l0RmllbGRzICAgICAgICAgIChmaWVsZHM6IEZpZWxkW10gICAgICAgKSB7IHJldHVybiAoZmllbGRzIHx8IFtdKS5tYXAoKGZpZWxkKSA9PiB0aGlzLnZpc2l0KGZpZWxkLnR5cGUpKTsgfVxuICAgIHB1YmxpYyB2aXNpdFNjaGVtYSAgICAgICAgICAoc2NoZW1hOiBTY2hlbWEgICAgICAgICkgeyByZXR1cm4gdGhpcy52aXNpdEZpZWxkcyhzY2hlbWEuZmllbGRzKS5yZWR1Y2Uoc3VtLCAwKTsgfVxufVxuXG5leHBvcnQgY29uc3QgaW5zdGFuY2UgPSBuZXcgQnl0ZVdpZHRoVmlzaXRvcigpO1xuIl19
