/* istanbul ignore file */
import { Visitor } from '../visitor';
import { TimeUnit } from '../enum';
const sum = (x, y) => x + y;
const variableWidthColumnErrorMessage = (type) => `Cannot compute the byte width of variable-width column ${type}`;
export class ByteWidthVisitor extends Visitor {
    visitNull(____) { return 0; }
    visitInt(type) { return type.bitWidth / 8; }
    visitFloat(type) { return type.ArrayType.BYTES_PER_ELEMENT; }
    visitBinary(type) { throw new Error(variableWidthColumnErrorMessage(type)); }
    visitUtf8(type) { throw new Error(variableWidthColumnErrorMessage(type)); }
    visitBool(____) { return 1 / 8; }
    visitDecimal(____) { return 16; }
    visitDate(type) { return (type.unit + 1) * 4; }
    visitTime(type) { return type.bitWidth / 8; }
    visitTimestamp(type) { return type.unit === TimeUnit.SECOND ? 4 : 8; }
    visitInterval(type) { return (type.unit + 1) * 4; }
    visitList(type) { throw new Error(variableWidthColumnErrorMessage(type)); }
    visitStruct(type) { return this.visitFields(type.children).reduce(sum, 0); }
    visitUnion(type) { return this.visitFields(type.children).reduce(sum, 0); }
    visitFixedSizeBinary(type) { return type.byteWidth; }
    visitFixedSizeList(type) { return type.listSize * this.visitFields(type.children).reduce(sum, 0); }
    visitMap(type) { return this.visitFields(type.children).reduce(sum, 0); }
    visitDictionary(type) { return this.visit(type.indices); }
    visitFields(fields) { return (fields || []).map((field) => this.visit(field.type)); }
    visitSchema(schema) { return this.visitFields(schema.fields).reduce(sum, 0); }
}
export const instance = new ByteWidthVisitor();

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZpc2l0b3IvYnl0ZXdpZHRoLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLDBCQUEwQjtBQW9CMUIsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLFlBQVksQ0FBQztBQUVyQyxPQUFPLEVBQVEsUUFBUSxFQUFFLE1BQU0sU0FBUyxDQUFDO0FBU3pDLE1BQU0sR0FBRyxHQUFHLENBQUMsQ0FBUyxFQUFFLENBQVMsRUFBRSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUM1QyxNQUFNLCtCQUErQixHQUFHLENBQUMsSUFBYyxFQUFFLEVBQUUsQ0FBQywwREFBMEQsSUFBSSxFQUFFLENBQUM7QUFXN0gsTUFBTSxPQUFPLGdCQUFpQixTQUFRLE9BQU87SUFDbEMsU0FBUyxDQUFhLElBQVUsSUFBZ0IsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzNELFFBQVEsQ0FBYyxJQUFTLElBQWlCLE9BQU8sSUFBSSxDQUFDLFFBQVEsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzNFLFVBQVUsQ0FBWSxJQUFXLElBQWUsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQztJQUMxRixXQUFXLENBQVcsSUFBWSxJQUFjLE1BQU0sSUFBSSxLQUFLLENBQUMsK0JBQStCLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDekcsU0FBUyxDQUFhLElBQVUsSUFBZ0IsTUFBTSxJQUFJLEtBQUssQ0FBQywrQkFBK0IsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN6RyxTQUFTLENBQWEsSUFBVSxJQUFnQixPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQy9ELFlBQVksQ0FBVSxJQUFhLElBQWEsT0FBTyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQzVELFNBQVMsQ0FBYSxJQUFXLElBQWUsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM3RSxTQUFTLENBQWEsSUFBVSxJQUFnQixPQUFPLElBQUksQ0FBQyxRQUFRLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUMzRSxjQUFjLENBQVEsSUFBZSxJQUFXLE9BQU8sSUFBSSxDQUFDLElBQUksS0FBSyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDL0YsYUFBYSxDQUFTLElBQWMsSUFBWSxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzdFLFNBQVMsQ0FBYSxJQUFVLElBQWdCLE1BQU0sSUFBSSxLQUFLLENBQUMsK0JBQStCLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDekcsV0FBVyxDQUFXLElBQVksSUFBYyxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3hHLFVBQVUsQ0FBWSxJQUFXLElBQWUsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN4RyxvQkFBb0IsQ0FBRSxJQUFxQixJQUFLLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7SUFDeEUsa0JBQWtCLENBQUksSUFBbUIsSUFBTyxPQUFPLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDeEgsUUFBUSxDQUFjLElBQVUsSUFBZ0IsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN4RyxlQUFlLENBQU8sSUFBZ0IsSUFBVSxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNsRixXQUFXLENBQVcsTUFBZSxJQUFXLE9BQU8sQ0FBQyxNQUFNLElBQUksRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUMvRyxXQUFXLENBQVcsTUFBYyxJQUFZLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7Q0FDbEg7QUFFRCxNQUFNLENBQUMsTUFBTSxRQUFRLEdBQUcsSUFBSSxnQkFBZ0IsRUFBRSxDQUFDIiwiZmlsZSI6InZpc2l0b3IvYnl0ZXdpZHRoLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogaXN0YW5idWwgaWdub3JlIGZpbGUgKi9cblxuLy8gTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZVxuLy8gb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXG4vLyBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuLy8gcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZVxuLy8gdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxuLy8gXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4vLyB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4vL1xuLy8gICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbi8vXG4vLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4vLyBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxuLy8gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbi8vIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZVxuLy8gc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xuLy8gdW5kZXIgdGhlIExpY2Vuc2UuXG5cbmltcG9ydCB7IERhdGEgfSBmcm9tICcuLi9kYXRhJztcbmltcG9ydCB7IFZpc2l0b3IgfSBmcm9tICcuLi92aXNpdG9yJztcbmltcG9ydCB7IFZlY3RvciB9IGZyb20gJy4uL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgVHlwZSwgVGltZVVuaXQgfSBmcm9tICcuLi9lbnVtJztcbmltcG9ydCB7IFNjaGVtYSwgRmllbGQgfSBmcm9tICcuLi9zY2hlbWEnO1xuaW1wb3J0IHtcbiAgICBEYXRhVHlwZSwgRGljdGlvbmFyeSxcbiAgICBGbG9hdCwgSW50LCBEYXRlXywgSW50ZXJ2YWwsIFRpbWUsIFRpbWVzdGFtcCxcbiAgICBCb29sLCBOdWxsLCBVdGY4LCBCaW5hcnksIERlY2ltYWwsIEZpeGVkU2l6ZUJpbmFyeSxcbiAgICBMaXN0LCBGaXhlZFNpemVMaXN0LCBNYXBfLCBTdHJ1Y3QsIFVuaW9uLFxufSBmcm9tICcuLi90eXBlJztcblxuY29uc3Qgc3VtID0gKHg6IG51bWJlciwgeTogbnVtYmVyKSA9PiB4ICsgeTtcbmNvbnN0IHZhcmlhYmxlV2lkdGhDb2x1bW5FcnJvck1lc3NhZ2UgPSAodHlwZTogRGF0YVR5cGUpID0+IGBDYW5ub3QgY29tcHV0ZSB0aGUgYnl0ZSB3aWR0aCBvZiB2YXJpYWJsZS13aWR0aCBjb2x1bW4gJHt0eXBlfWA7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQnl0ZVdpZHRoVmlzaXRvciBleHRlbmRzIFZpc2l0b3Ige1xuICAgIHZpc2l0TWFueSA8VCBleHRlbmRzIERhdGFUeXBlPihub2RlczogVFtdICAgICApOiBudW1iZXJbXTtcbiAgICB2aXNpdCAgICAgPFQgZXh0ZW5kcyBEYXRhVHlwZT4obm9kZTogVCAgICAgICAgKTogbnVtYmVyO1xuICAgIGdldFZpc2l0Rm48VCBleHRlbmRzIFR5cGU+ICAgIChub2RlOiBUICAgICAgICApOiAodHlwZTogRGF0YVR5cGU8VD4pID0+IG51bWJlcjtcbiAgICBnZXRWaXNpdEZuPFQgZXh0ZW5kcyBEYXRhVHlwZT4obm9kZTogVmVjdG9yPFQ+KTogKHR5cGU6IFQgICAgICAgICAgKSA9PiBudW1iZXI7XG4gICAgZ2V0VmlzaXRGbjxUIGV4dGVuZHMgRGF0YVR5cGU+KG5vZGU6IERhdGE8VD4gICk6ICh0eXBlOiBUICAgICAgICAgICkgPT4gbnVtYmVyO1xuICAgIGdldFZpc2l0Rm48VCBleHRlbmRzIERhdGFUeXBlPihub2RlOiBUICAgICAgICApOiAodHlwZTogVCAgICAgICAgICApID0+IG51bWJlcjtcbn1cblxuZXhwb3J0IGNsYXNzIEJ5dGVXaWR0aFZpc2l0b3IgZXh0ZW5kcyBWaXNpdG9yIHtcbiAgICBwdWJsaWMgdmlzaXROdWxsICAgICAgICAgICAgKF9fX186IE51bGwgICAgICAgICAgICApIHsgcmV0dXJuIDA7IH1cbiAgICBwdWJsaWMgdmlzaXRJbnQgICAgICAgICAgICAgKHR5cGU6IEludCAgICAgICAgICAgICApIHsgcmV0dXJuIHR5cGUuYml0V2lkdGggLyA4OyB9XG4gICAgcHVibGljIHZpc2l0RmxvYXQgICAgICAgICAgICh0eXBlOiBGbG9hdCAgICAgICAgICAgKSB7IHJldHVybiB0eXBlLkFycmF5VHlwZS5CWVRFU19QRVJfRUxFTUVOVDsgfVxuICAgIHB1YmxpYyB2aXNpdEJpbmFyeSAgICAgICAgICAodHlwZTogQmluYXJ5ICAgICAgICAgICkgeyB0aHJvdyBuZXcgRXJyb3IodmFyaWFibGVXaWR0aENvbHVtbkVycm9yTWVzc2FnZSh0eXBlKSk7IH1cbiAgICBwdWJsaWMgdmlzaXRVdGY4ICAgICAgICAgICAgKHR5cGU6IFV0ZjggICAgICAgICAgICApIHsgdGhyb3cgbmV3IEVycm9yKHZhcmlhYmxlV2lkdGhDb2x1bW5FcnJvck1lc3NhZ2UodHlwZSkpOyB9XG4gICAgcHVibGljIHZpc2l0Qm9vbCAgICAgICAgICAgIChfX19fOiBCb29sICAgICAgICAgICAgKSB7IHJldHVybiAxIC8gODsgfVxuICAgIHB1YmxpYyB2aXNpdERlY2ltYWwgICAgICAgICAoX19fXzogRGVjaW1hbCAgICAgICAgICkgeyByZXR1cm4gMTY7IH1cbiAgICBwdWJsaWMgdmlzaXREYXRlICAgICAgICAgICAgKHR5cGU6IERhdGVfICAgICAgICAgICApIHsgcmV0dXJuICh0eXBlLnVuaXQgKyAxKSAqIDQ7IH1cbiAgICBwdWJsaWMgdmlzaXRUaW1lICAgICAgICAgICAgKHR5cGU6IFRpbWUgICAgICAgICAgICApIHsgcmV0dXJuIHR5cGUuYml0V2lkdGggLyA4OyB9XG4gICAgcHVibGljIHZpc2l0VGltZXN0YW1wICAgICAgICh0eXBlOiBUaW1lc3RhbXAgICAgICAgKSB7IHJldHVybiB0eXBlLnVuaXQgPT09IFRpbWVVbml0LlNFQ09ORCA/IDQgOiA4OyB9XG4gICAgcHVibGljIHZpc2l0SW50ZXJ2YWwgICAgICAgICh0eXBlOiBJbnRlcnZhbCAgICAgICAgKSB7IHJldHVybiAodHlwZS51bml0ICsgMSkgKiA0OyB9XG4gICAgcHVibGljIHZpc2l0TGlzdCAgICAgICAgICAgICh0eXBlOiBMaXN0ICAgICAgICAgICAgKSB7IHRocm93IG5ldyBFcnJvcih2YXJpYWJsZVdpZHRoQ29sdW1uRXJyb3JNZXNzYWdlKHR5cGUpKTsgfVxuICAgIHB1YmxpYyB2aXNpdFN0cnVjdCAgICAgICAgICAodHlwZTogU3RydWN0ICAgICAgICAgICkgeyByZXR1cm4gdGhpcy52aXNpdEZpZWxkcyh0eXBlLmNoaWxkcmVuKS5yZWR1Y2Uoc3VtLCAwKTsgfVxuICAgIHB1YmxpYyB2aXNpdFVuaW9uICAgICAgICAgICAodHlwZTogVW5pb24gICAgICAgICAgICkgeyByZXR1cm4gdGhpcy52aXNpdEZpZWxkcyh0eXBlLmNoaWxkcmVuKS5yZWR1Y2Uoc3VtLCAwKTsgfVxuICAgIHB1YmxpYyB2aXNpdEZpeGVkU2l6ZUJpbmFyeSAodHlwZTogRml4ZWRTaXplQmluYXJ5ICkgeyByZXR1cm4gdHlwZS5ieXRlV2lkdGg7IH1cbiAgICBwdWJsaWMgdmlzaXRGaXhlZFNpemVMaXN0ICAgKHR5cGU6IEZpeGVkU2l6ZUxpc3QgICApIHsgcmV0dXJuIHR5cGUubGlzdFNpemUgKiB0aGlzLnZpc2l0RmllbGRzKHR5cGUuY2hpbGRyZW4pLnJlZHVjZShzdW0sIDApOyB9XG4gICAgcHVibGljIHZpc2l0TWFwICAgICAgICAgICAgICh0eXBlOiBNYXBfICAgICAgICAgICAgKSB7IHJldHVybiB0aGlzLnZpc2l0RmllbGRzKHR5cGUuY2hpbGRyZW4pLnJlZHVjZShzdW0sIDApOyB9XG4gICAgcHVibGljIHZpc2l0RGljdGlvbmFyeSAgICAgICh0eXBlOiBEaWN0aW9uYXJ5ICAgICAgKSB7IHJldHVybiB0aGlzLnZpc2l0KHR5cGUuaW5kaWNlcyk7IH1cbiAgICBwdWJsaWMgdmlzaXRGaWVsZHMgICAgICAgICAgKGZpZWxkczogRmllbGRbXSAgICAgICApIHsgcmV0dXJuIChmaWVsZHMgfHwgW10pLm1hcCgoZmllbGQpID0+IHRoaXMudmlzaXQoZmllbGQudHlwZSkpOyB9XG4gICAgcHVibGljIHZpc2l0U2NoZW1hICAgICAgICAgIChzY2hlbWE6IFNjaGVtYSAgICAgICAgKSB7IHJldHVybiB0aGlzLnZpc2l0RmllbGRzKHNjaGVtYS5maWVsZHMpLnJlZHVjZShzdW0sIDApOyB9XG59XG5cbmV4cG9ydCBjb25zdCBpbnN0YW5jZSA9IG5ldyBCeXRlV2lkdGhWaXNpdG9yKCk7XG4iXX0=
