"use strict";
// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.  You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.
Object.defineProperty(exports, "__esModule", { value: true });
const flatbuffers_1 = require("flatbuffers");
var Long = flatbuffers_1.flatbuffers.Long;
const Schema_ = require("../fb/Schema");
const visitor_1 = require("../visitor");
var Null = Schema_.org.apache.arrow.flatbuf.Null;
var Int = Schema_.org.apache.arrow.flatbuf.Int;
var FloatingPoint = Schema_.org.apache.arrow.flatbuf.FloatingPoint;
var Binary = Schema_.org.apache.arrow.flatbuf.Binary;
var Bool = Schema_.org.apache.arrow.flatbuf.Bool;
var Utf8 = Schema_.org.apache.arrow.flatbuf.Utf8;
var Decimal = Schema_.org.apache.arrow.flatbuf.Decimal;
var Date = Schema_.org.apache.arrow.flatbuf.Date;
var Time = Schema_.org.apache.arrow.flatbuf.Time;
var Timestamp = Schema_.org.apache.arrow.flatbuf.Timestamp;
var Interval = Schema_.org.apache.arrow.flatbuf.Interval;
var List = Schema_.org.apache.arrow.flatbuf.List;
var Struct = Schema_.org.apache.arrow.flatbuf.Struct_;
var Union = Schema_.org.apache.arrow.flatbuf.Union;
var DictionaryEncoding = Schema_.org.apache.arrow.flatbuf.DictionaryEncoding;
var FixedSizeBinary = Schema_.org.apache.arrow.flatbuf.FixedSizeBinary;
var FixedSizeList = Schema_.org.apache.arrow.flatbuf.FixedSizeList;
var Map_ = Schema_.org.apache.arrow.flatbuf.Map;
class TypeAssembler extends visitor_1.Visitor {
    visit(node, builder) {
        return (node == null || builder == null) ? undefined : super.visit(node, builder);
    }
    visitNull(_node, b) {
        Null.startNull(b);
        return Null.endNull(b);
    }
    visitInt(node, b) {
        Int.startInt(b);
        Int.addBitWidth(b, node.bitWidth);
        Int.addIsSigned(b, node.isSigned);
        return Int.endInt(b);
    }
    visitFloat(node, b) {
        FloatingPoint.startFloatingPoint(b);
        FloatingPoint.addPrecision(b, node.precision);
        return FloatingPoint.endFloatingPoint(b);
    }
    visitBinary(_node, b) {
        Binary.startBinary(b);
        return Binary.endBinary(b);
    }
    visitBool(_node, b) {
        Bool.startBool(b);
        return Bool.endBool(b);
    }
    visitUtf8(_node, b) {
        Utf8.startUtf8(b);
        return Utf8.endUtf8(b);
    }
    visitDecimal(node, b) {
        Decimal.startDecimal(b);
        Decimal.addScale(b, node.scale);
        Decimal.addPrecision(b, node.precision);
        return Decimal.endDecimal(b);
    }
    visitDate(node, b) {
        Date.startDate(b);
        Date.addUnit(b, node.unit);
        return Date.endDate(b);
    }
    visitTime(node, b) {
        Time.startTime(b);
        Time.addUnit(b, node.unit);
        Time.addBitWidth(b, node.bitWidth);
        return Time.endTime(b);
    }
    visitTimestamp(node, b) {
        const timezone = (node.timezone && b.createString(node.timezone)) || undefined;
        Timestamp.startTimestamp(b);
        Timestamp.addUnit(b, node.unit);
        if (timezone !== undefined) {
            Timestamp.addTimezone(b, timezone);
        }
        return Timestamp.endTimestamp(b);
    }
    visitInterval(node, b) {
        Interval.startInterval(b);
        Interval.addUnit(b, node.unit);
        return Interval.endInterval(b);
    }
    visitList(_node, b) {
        List.startList(b);
        return List.endList(b);
    }
    visitStruct(_node, b) {
        Struct.startStruct_(b);
        return Struct.endStruct_(b);
    }
    visitUnion(node, b) {
        Union.startTypeIdsVector(b, node.typeIds.length);
        const typeIds = Union.createTypeIdsVector(b, node.typeIds);
        Union.startUnion(b);
        Union.addMode(b, node.mode);
        Union.addTypeIds(b, typeIds);
        return Union.endUnion(b);
    }
    visitDictionary(node, b) {
        const indexType = this.visit(node.indices, b);
        DictionaryEncoding.startDictionaryEncoding(b);
        DictionaryEncoding.addId(b, new Long(node.id, 0));
        DictionaryEncoding.addIsOrdered(b, node.isOrdered);
        if (indexType !== undefined) {
            DictionaryEncoding.addIndexType(b, indexType);
        }
        return DictionaryEncoding.endDictionaryEncoding(b);
    }
    visitFixedSizeBinary(node, b) {
        FixedSizeBinary.startFixedSizeBinary(b);
        FixedSizeBinary.addByteWidth(b, node.byteWidth);
        return FixedSizeBinary.endFixedSizeBinary(b);
    }
    visitFixedSizeList(node, b) {
        FixedSizeList.startFixedSizeList(b);
        FixedSizeList.addListSize(b, node.listSize);
        return FixedSizeList.endFixedSizeList(b);
    }
    visitMap(node, b) {
        Map_.startMap(b);
        Map_.addKeysSorted(b, node.keysSorted);
        return Map_.endMap(b);
    }
}
exports.TypeAssembler = TypeAssembler;
exports.instance = new TypeAssembler();

//# sourceMappingURL=data:application/json;charset=utf8;base64,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LGVBQWUsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN4QyxlQUFlLENBQUMsWUFBWSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDaEQsT0FBTyxlQUFlLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDakQsQ0FBQztJQUNNLGtCQUFrQixDQUErQixJQUFPLEVBQUUsQ0FBVTtRQUN2RSxhQUFhLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDcEMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQzVDLE9BQU8sYUFBYSxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzdDLENBQUM7SUFDTSxRQUFRLENBQXNCLElBQU8sRUFBRSxDQUFVO1FBQ3BELElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDakIsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ3ZDLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUMxQixDQUFDO0NBQ0o7QUF2R0Qsc0NBdUdDO0FBRVksUUFBQSxRQUFRLEdBQUcsSUFBSSxhQUFhLEVBQUUsQ0FBQyIsImZpbGUiOiJ2aXNpdG9yL3R5cGVhc3NlbWJsZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4vLyBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbi8vIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4vLyByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4vLyB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4vLyBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Vcbi8vIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbi8vXG4vLyAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuLy9cbi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbi8vIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4vLyBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuLy8gS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4vLyBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4vLyB1bmRlciB0aGUgTGljZW5zZS5cblxuaW1wb3J0IHsgZmxhdGJ1ZmZlcnMgfSBmcm9tICdmbGF0YnVmZmVycyc7XG5pbXBvcnQgTG9uZyA9IGZsYXRidWZmZXJzLkxvbmc7XG5pbXBvcnQgQnVpbGRlciA9IGZsYXRidWZmZXJzLkJ1aWxkZXI7XG5pbXBvcnQgKiBhcyBTY2hlbWFfIGZyb20gJy4uL2ZiL1NjaGVtYSc7XG5cbmltcG9ydCAqIGFzIHR5cGUgZnJvbSAnLi4vdHlwZSc7XG5pbXBvcnQgeyBWaXNpdG9yIH0gZnJvbSAnLi4vdmlzaXRvcic7XG5cbmltcG9ydCBOdWxsID0gU2NoZW1hXy5vcmcuYXBhY2hlLmFycm93LmZsYXRidWYuTnVsbDtcbmltcG9ydCBJbnQgPSBTY2hlbWFfLm9yZy5hcGFjaGUuYXJyb3cuZmxhdGJ1Zi5JbnQ7XG5pbXBvcnQgRmxvYXRpbmdQb2ludCA9IFNjaGVtYV8ub3JnLmFwYWNoZS5hcnJvdy5mbGF0YnVmLkZsb2F0aW5nUG9pbnQ7XG5pbXBvcnQgQmluYXJ5ID0gU2NoZW1hXy5vcmcuYXBhY2hlLmFycm93LmZsYXRidWYuQmluYXJ5O1xuaW1wb3J0IEJvb2wgPSBTY2hlbWFfLm9yZy5hcGFjaGUuYXJyb3cuZmxhdGJ1Zi5Cb29sO1xuaW1wb3J0IFV0ZjggPSBTY2hlbWFfLm9yZy5hcGFjaGUuYXJyb3cuZmxhdGJ1Zi5VdGY4O1xuaW1wb3J0IERlY2ltYWwgPSBTY2hlbWFfLm9yZy5hcGFjaGUuYXJyb3cuZmxhdGJ1Zi5EZWNpbWFsO1xuaW1wb3J0IERhdGUgPSBTY2hlbWFfLm9yZy5hcGFjaGUuYXJyb3cuZmxhdGJ1Zi5EYXRlO1xuaW1wb3J0IFRpbWUgPSBTY2hlbWFfLm9yZy5hcGFjaGUuYXJyb3cuZmxhdGJ1Zi5UaW1lO1xuaW1wb3J0IFRpbWVzdGFtcCA9IFNjaGVtYV8ub3JnLmFwYWNoZS5hcnJvdy5mbGF0YnVmLlRpbWVzdGFtcDtcbmltcG9ydCBJbnRlcnZhbCA9IFNjaGVtYV8ub3JnLmFwYWNoZS5hcnJvdy5mbGF0YnVmLkludGVydmFsO1xuaW1wb3J0IExpc3QgPSBTY2hlbWFfLm9yZy5hcGFjaGUuYXJyb3cuZmxhdGJ1Zi5MaXN0O1xuaW1wb3J0IFN0cnVjdCA9IFNjaGVtYV8ub3JnLmFwYWNoZS5hcnJvdy5mbGF0YnVmLlN0cnVjdF87XG5pbXBvcnQgVW5pb24gPSBTY2hlbWFfLm9yZy5hcGFjaGUuYXJyb3cuZmxhdGJ1Zi5VbmlvbjtcbmltcG9ydCBEaWN0aW9uYXJ5RW5jb2RpbmcgPSBTY2hlbWFfLm9yZy5hcGFjaGUuYXJyb3cuZmxhdGJ1Zi5EaWN0aW9uYXJ5RW5jb2Rpbmc7XG5pbXBvcnQgRml4ZWRTaXplQmluYXJ5ID0gU2NoZW1hXy5vcmcuYXBhY2hlLmFycm93LmZsYXRidWYuRml4ZWRTaXplQmluYXJ5O1xuaW1wb3J0IEZpeGVkU2l6ZUxpc3QgPSBTY2hlbWFfLm9yZy5hcGFjaGUuYXJyb3cuZmxhdGJ1Zi5GaXhlZFNpemVMaXN0O1xuaW1wb3J0IE1hcF8gPSBTY2hlbWFfLm9yZy5hcGFjaGUuYXJyb3cuZmxhdGJ1Zi5NYXA7XG5cbmV4cG9ydCBpbnRlcmZhY2UgVHlwZUFzc2VtYmxlciBleHRlbmRzIFZpc2l0b3Ige1xuICAgIHZpc2l0PFQgZXh0ZW5kcyB0eXBlLkRhdGFUeXBlPihub2RlOiBULCBidWlsZGVyOiBCdWlsZGVyKTogbnVtYmVyIHwgdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgY2xhc3MgVHlwZUFzc2VtYmxlciBleHRlbmRzIFZpc2l0b3Ige1xuICAgIHB1YmxpYyB2aXNpdDxUIGV4dGVuZHMgdHlwZS5EYXRhVHlwZT4obm9kZTogVCwgYnVpbGRlcjogQnVpbGRlcik6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgICAgIHJldHVybiAobm9kZSA9PSBudWxsIHx8IGJ1aWxkZXIgPT0gbnVsbCkgPyB1bmRlZmluZWQgOiBzdXBlci52aXNpdChub2RlLCBidWlsZGVyKTtcbiAgICB9XG4gICAgcHVibGljIHZpc2l0TnVsbDxUIGV4dGVuZHMgdHlwZS5OdWxsPihfbm9kZTogVCwgYjogQnVpbGRlcikge1xuICAgICAgICBOdWxsLnN0YXJ0TnVsbChiKTtcbiAgICAgICAgcmV0dXJuIE51bGwuZW5kTnVsbChiKTtcbiAgICB9XG4gICAgcHVibGljIHZpc2l0SW50PFQgZXh0ZW5kcyB0eXBlLkludD4obm9kZTogVCwgYjogQnVpbGRlcikge1xuICAgICAgICBJbnQuc3RhcnRJbnQoYik7XG4gICAgICAgIEludC5hZGRCaXRXaWR0aChiLCBub2RlLmJpdFdpZHRoKTtcbiAgICAgICAgSW50LmFkZElzU2lnbmVkKGIsIG5vZGUuaXNTaWduZWQpO1xuICAgICAgICByZXR1cm4gSW50LmVuZEludChiKTtcbiAgICB9XG4gICAgcHVibGljIHZpc2l0RmxvYXQ8VCBleHRlbmRzIHR5cGUuRmxvYXQ+KG5vZGU6IFQsIGI6IEJ1aWxkZXIpIHtcbiAgICAgICAgRmxvYXRpbmdQb2ludC5zdGFydEZsb2F0aW5nUG9pbnQoYik7XG4gICAgICAgIEZsb2F0aW5nUG9pbnQuYWRkUHJlY2lzaW9uKGIsIG5vZGUucHJlY2lzaW9uKTtcbiAgICAgICAgcmV0dXJuIEZsb2F0aW5nUG9pbnQuZW5kRmxvYXRpbmdQb2ludChiKTtcbiAgICB9XG4gICAgcHVibGljIHZpc2l0QmluYXJ5PFQgZXh0ZW5kcyB0eXBlLkJpbmFyeT4oX25vZGU6IFQsIGI6IEJ1aWxkZXIpIHtcbiAgICAgICAgQmluYXJ5LnN0YXJ0QmluYXJ5KGIpO1xuICAgICAgICByZXR1cm4gQmluYXJ5LmVuZEJpbmFyeShiKTtcbiAgICB9XG4gICAgcHVibGljIHZpc2l0Qm9vbDxUIGV4dGVuZHMgdHlwZS5Cb29sPihfbm9kZTogVCwgYjogQnVpbGRlcikge1xuICAgICAgICBCb29sLnN0YXJ0Qm9vbChiKTtcbiAgICAgICAgcmV0dXJuIEJvb2wuZW5kQm9vbChiKTtcbiAgICB9XG4gICAgcHVibGljIHZpc2l0VXRmODxUIGV4dGVuZHMgdHlwZS5VdGY4Pihfbm9kZTogVCwgYjogQnVpbGRlcikge1xuICAgICAgICBVdGY4LnN0YXJ0VXRmOChiKTtcbiAgICAgICAgcmV0dXJuIFV0ZjguZW5kVXRmOChiKTtcbiAgICB9XG4gICAgcHVibGljIHZpc2l0RGVjaW1hbDxUIGV4dGVuZHMgdHlwZS5EZWNpbWFsPihub2RlOiBULCBiOiBCdWlsZGVyKSB7XG4gICAgICAgIERlY2ltYWwuc3RhcnREZWNpbWFsKGIpO1xuICAgICAgICBEZWNpbWFsLmFkZFNjYWxlKGIsIG5vZGUuc2NhbGUpO1xuICAgICAgICBEZWNpbWFsLmFkZFByZWNpc2lvbihiLCBub2RlLnByZWNpc2lvbik7XG4gICAgICAgIHJldHVybiBEZWNpbWFsLmVuZERlY2ltYWwoYik7XG4gICAgfVxuICAgIHB1YmxpYyB2aXNpdERhdGU8VCBleHRlbmRzIHR5cGUuRGF0ZV8+KG5vZGU6IFQsIGI6IEJ1aWxkZXIpIHtcbiAgICAgICAgRGF0ZS5zdGFydERhdGUoYik7XG4gICAgICAgIERhdGUuYWRkVW5pdChiLCBub2RlLnVuaXQpO1xuICAgICAgICByZXR1cm4gRGF0ZS5lbmREYXRlKGIpO1xuICAgIH1cbiAgICBwdWJsaWMgdmlzaXRUaW1lPFQgZXh0ZW5kcyB0eXBlLlRpbWU+KG5vZGU6IFQsIGI6IEJ1aWxkZXIpIHtcbiAgICAgICAgVGltZS5zdGFydFRpbWUoYik7XG4gICAgICAgIFRpbWUuYWRkVW5pdChiLCBub2RlLnVuaXQpO1xuICAgICAgICBUaW1lLmFkZEJpdFdpZHRoKGIsIG5vZGUuYml0V2lkdGgpO1xuICAgICAgICByZXR1cm4gVGltZS5lbmRUaW1lKGIpO1xuICAgIH1cbiAgICBwdWJsaWMgdmlzaXRUaW1lc3RhbXA8VCBleHRlbmRzIHR5cGUuVGltZXN0YW1wPihub2RlOiBULCBiOiBCdWlsZGVyKSB7XG4gICAgICAgIGNvbnN0IHRpbWV6b25lID0gKG5vZGUudGltZXpvbmUgJiYgYi5jcmVhdGVTdHJpbmcobm9kZS50aW1lem9uZSkpIHx8IHVuZGVmaW5lZDtcbiAgICAgICAgVGltZXN0YW1wLnN0YXJ0VGltZXN0YW1wKGIpO1xuICAgICAgICBUaW1lc3RhbXAuYWRkVW5pdChiLCBub2RlLnVuaXQpO1xuICAgICAgICBpZiAodGltZXpvbmUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgVGltZXN0YW1wLmFkZFRpbWV6b25lKGIsIHRpbWV6b25lKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gVGltZXN0YW1wLmVuZFRpbWVzdGFtcChiKTtcbiAgICB9XG4gICAgcHVibGljIHZpc2l0SW50ZXJ2YWw8VCBleHRlbmRzIHR5cGUuSW50ZXJ2YWw+KG5vZGU6IFQsIGI6IEJ1aWxkZXIpIHtcbiAgICAgICAgSW50ZXJ2YWwuc3RhcnRJbnRlcnZhbChiKTtcbiAgICAgICAgSW50ZXJ2YWwuYWRkVW5pdChiLCBub2RlLnVuaXQpO1xuICAgICAgICByZXR1cm4gSW50ZXJ2YWwuZW5kSW50ZXJ2YWwoYik7XG4gICAgfVxuICAgIHB1YmxpYyB2aXNpdExpc3Q8VCBleHRlbmRzIHR5cGUuTGlzdD4oX25vZGU6IFQsIGI6IEJ1aWxkZXIpIHtcbiAgICAgICAgTGlzdC5zdGFydExpc3QoYik7XG4gICAgICAgIHJldHVybiBMaXN0LmVuZExpc3QoYik7XG4gICAgfVxuICAgIHB1YmxpYyB2aXNpdFN0cnVjdDxUIGV4dGVuZHMgdHlwZS5TdHJ1Y3Q+KF9ub2RlOiBULCBiOiBCdWlsZGVyKSB7XG4gICAgICAgIFN0cnVjdC5zdGFydFN0cnVjdF8oYik7XG4gICAgICAgIHJldHVybiBTdHJ1Y3QuZW5kU3RydWN0XyhiKTtcbiAgICB9XG4gICAgcHVibGljIHZpc2l0VW5pb248VCBleHRlbmRzIHR5cGUuVW5pb24+KG5vZGU6IFQsIGI6IEJ1aWxkZXIpIHtcbiAgICAgICAgVW5pb24uc3RhcnRUeXBlSWRzVmVjdG9yKGIsIG5vZGUudHlwZUlkcy5sZW5ndGgpO1xuICAgICAgICBjb25zdCB0eXBlSWRzID0gVW5pb24uY3JlYXRlVHlwZUlkc1ZlY3RvcihiLCBub2RlLnR5cGVJZHMpO1xuICAgICAgICBVbmlvbi5zdGFydFVuaW9uKGIpO1xuICAgICAgICBVbmlvbi5hZGRNb2RlKGIsIG5vZGUubW9kZSk7XG4gICAgICAgIFVuaW9uLmFkZFR5cGVJZHMoYiwgdHlwZUlkcyk7XG4gICAgICAgIHJldHVybiBVbmlvbi5lbmRVbmlvbihiKTtcbiAgICB9XG4gICAgcHVibGljIHZpc2l0RGljdGlvbmFyeTxUIGV4dGVuZHMgdHlwZS5EaWN0aW9uYXJ5Pihub2RlOiBULCBiOiBCdWlsZGVyKSB7XG4gICAgICAgIGNvbnN0IGluZGV4VHlwZSA9IHRoaXMudmlzaXQobm9kZS5pbmRpY2VzLCBiKTtcbiAgICAgICAgRGljdGlvbmFyeUVuY29kaW5nLnN0YXJ0RGljdGlvbmFyeUVuY29kaW5nKGIpO1xuICAgICAgICBEaWN0aW9uYXJ5RW5jb2RpbmcuYWRkSWQoYiwgbmV3IExvbmcobm9kZS5pZCwgMCkpO1xuICAgICAgICBEaWN0aW9uYXJ5RW5jb2RpbmcuYWRkSXNPcmRlcmVkKGIsIG5vZGUuaXNPcmRlcmVkKTtcbiAgICAgICAgaWYgKGluZGV4VHlwZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBEaWN0aW9uYXJ5RW5jb2RpbmcuYWRkSW5kZXhUeXBlKGIsIGluZGV4VHlwZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIERpY3Rpb25hcnlFbmNvZGluZy5lbmREaWN0aW9uYXJ5RW5jb2RpbmcoYik7XG4gICAgfVxuICAgIHB1YmxpYyB2aXNpdEZpeGVkU2l6ZUJpbmFyeTxUIGV4dGVuZHMgdHlwZS5GaXhlZFNpemVCaW5hcnk+KG5vZGU6IFQsIGI6IEJ1aWxkZXIpIHtcbiAgICAgICAgRml4ZWRTaXplQmluYXJ5LnN0YXJ0Rml4ZWRTaXplQmluYXJ5KGIpO1xuICAgICAgICBGaXhlZFNpemVCaW5hcnkuYWRkQnl0ZVdpZHRoKGIsIG5vZGUuYnl0ZVdpZHRoKTtcbiAgICAgICAgcmV0dXJuIEZpeGVkU2l6ZUJpbmFyeS5lbmRGaXhlZFNpemVCaW5hcnkoYik7XG4gICAgfVxuICAgIHB1YmxpYyB2aXNpdEZpeGVkU2l6ZUxpc3Q8VCBleHRlbmRzIHR5cGUuRml4ZWRTaXplTGlzdD4obm9kZTogVCwgYjogQnVpbGRlcikge1xuICAgICAgICBGaXhlZFNpemVMaXN0LnN0YXJ0Rml4ZWRTaXplTGlzdChiKTtcbiAgICAgICAgRml4ZWRTaXplTGlzdC5hZGRMaXN0U2l6ZShiLCBub2RlLmxpc3RTaXplKTtcbiAgICAgICAgcmV0dXJuIEZpeGVkU2l6ZUxpc3QuZW5kRml4ZWRTaXplTGlzdChiKTtcbiAgICB9XG4gICAgcHVibGljIHZpc2l0TWFwPFQgZXh0ZW5kcyB0eXBlLk1hcF8+KG5vZGU6IFQsIGI6IEJ1aWxkZXIpIHtcbiAgICAgICAgTWFwXy5zdGFydE1hcChiKTtcbiAgICAgICAgTWFwXy5hZGRLZXlzU29ydGVkKGIsIG5vZGUua2V5c1NvcnRlZCk7XG4gICAgICAgIHJldHVybiBNYXBfLmVuZE1hcChiKTtcbiAgICB9XG59XG5cbmV4cG9ydCBjb25zdCBpbnN0YW5jZSA9IG5ldyBUeXBlQXNzZW1ibGVyKCk7XG4iXX0=
