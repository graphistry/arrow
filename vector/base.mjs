// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.  You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.
import { Vector } from '../vector';
import { ChunkedVector } from './chunked';
import { clampRange } from '../util/vector';
export class BaseVector extends Vector {
    constructor(data, children, stride) {
        super();
        this._stride = 1;
        this._numChildren = 0;
        this._children = children;
        this.bindDataAccessors(this._data = data);
        this._numChildren = data.childData.length;
        this._stride = Math.floor(Math.max(stride || 1, 1));
    }
    get data() { return this._data; }
    get stride() { return this._stride; }
    get numChildren() { return this._numChildren; }
    get type() { return this.data.type; }
    get length() { return this.data.length; }
    get offset() { return this.data.offset; }
    get nullCount() { return this.data.nullCount; }
    get VectorName() { return this.constructor.name; }
    get TType() { return this.data.TType; }
    get TArray() { return this.data.TArray; }
    get TValue() { return this.data.TValue; }
    get ArrayType() { return this.data.ArrayType; }
    get values() { return this.data.values; }
    get typeIds() { return this.data.typeIds; }
    get nullBitmap() { return this.data.nullBitmap; }
    get valueOffsets() { return this.data.valueOffsets; }
    get [Symbol.toStringTag]() { return `${this.VectorName}<${this.type[Symbol.toStringTag]}>`; }
    clone(data, children = this._children, stride = this.stride) {
        return Vector.new(data, children, stride);
    }
    concat(...others) {
        return ChunkedVector.concat(this, ...others);
    }
    isValid(index) {
        if (this.nullCount > 0) {
            const idx = this.offset + index;
            const val = this.nullBitmap[idx >> 3];
            const mask = (val & (1 << (idx % 8)));
            return mask !== 0;
        }
        return true;
    }
    getChildAt(index) {
        return index < 0 || index >= this.numChildren ? null : ((this._children || (this._children = []))[index] ||
            (this._children[index] = Vector.new(this.data.childData[index])));
    }
    // @ts-ignore
    toJSON() { }
    slice(begin, end) {
        // Adjust args similar to Array.prototype.slice. Normalize begin/end to
        // clamp between 0 and length, and wrap around on negative indices, e.g.
        // slice(-1, 5) or slice(5, -1)
        return clampRange(this, begin, end, this.sliceInternal);
    }
    sliceInternal(vector, offset, length) {
        const stride = vector.stride;
        return vector.clone(vector.data.slice(offset * stride, (length - offset) * stride));
    }
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZlY3Rvci9iYXNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLDZEQUE2RDtBQUM3RCwrREFBK0Q7QUFDL0Qsd0RBQXdEO0FBQ3hELDZEQUE2RDtBQUM3RCxvREFBb0Q7QUFDcEQsNkRBQTZEO0FBQzdELDZEQUE2RDtBQUM3RCxFQUFFO0FBQ0YsK0NBQStDO0FBQy9DLEVBQUU7QUFDRiw2REFBNkQ7QUFDN0QsOERBQThEO0FBQzlELHlEQUF5RDtBQUN6RCw0REFBNEQ7QUFDNUQsMERBQTBEO0FBQzFELHFCQUFxQjtBQUdyQixPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBRW5DLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDMUMsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRTVDLE1BQU0sT0FBZ0IsVUFBcUMsU0FBUSxNQUFTO0lBUXhFLFlBQVksSUFBYSxFQUFFLFFBQW1CLEVBQUUsTUFBZTtRQUMzRCxLQUFLLEVBQUUsQ0FBQztRQUxGLFlBQU8sR0FBVyxDQUFDLENBQUM7UUFDcEIsaUJBQVksR0FBVyxDQUFDLENBQUM7UUFLL0IsSUFBSSxDQUFDLFNBQVMsR0FBRyxRQUFRLENBQUM7UUFDMUIsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLENBQUM7UUFDMUMsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQztRQUMxQyxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDeEQsQ0FBQztJQUVELElBQVcsSUFBSSxLQUFLLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDeEMsSUFBVyxNQUFNLEtBQUssT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztJQUM1QyxJQUFXLFdBQVcsS0FBSyxPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO0lBRXRELElBQVcsSUFBSSxLQUFLLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQzVDLElBQVcsTUFBTSxLQUFLLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO0lBQ2hELElBQVcsTUFBTSxLQUFLLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO0lBQ2hELElBQVcsU0FBUyxLQUFLLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO0lBQ3RELElBQVcsVUFBVSxLQUFLLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQ3pELElBQVcsS0FBSyxLQUFpQixPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztJQUMxRCxJQUFXLE1BQU0sS0FBa0IsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFDN0QsSUFBVyxNQUFNLEtBQWtCLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO0lBQzdELElBQVcsU0FBUyxLQUFxQixPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztJQUV0RSxJQUFXLE1BQU0sS0FBSyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUNoRCxJQUFXLE9BQU8sS0FBSyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztJQUNsRCxJQUFXLFVBQVUsS0FBSyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztJQUN4RCxJQUFXLFlBQVksS0FBSyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQztJQUU1RCxJQUFXLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxLQUFLLE9BQU8sR0FBRyxJQUFJLENBQUMsVUFBVSxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBRTdGLEtBQUssQ0FBeUIsSUFBYSxFQUFFLFFBQVEsR0FBRyxJQUFJLENBQUMsU0FBUyxFQUFFLE1BQU0sR0FBRyxJQUFJLENBQUMsTUFBTTtRQUMvRixPQUFPLE1BQU0sQ0FBQyxHQUFHLENBQUksSUFBSSxFQUFFLFFBQVEsRUFBRSxNQUFNLENBQUMsQ0FBQztJQUNqRCxDQUFDO0lBRU0sTUFBTSxDQUFDLEdBQUcsTUFBbUI7UUFDaEMsT0FBTyxhQUFhLENBQUMsTUFBTSxDQUFJLElBQUksRUFBRSxHQUFHLE1BQU0sQ0FBYyxDQUFDO0lBQ2pFLENBQUM7SUFFTSxPQUFPLENBQUMsS0FBYTtRQUN4QixJQUFJLElBQUksQ0FBQyxTQUFTLEdBQUcsQ0FBQyxFQUFFO1lBQ3BCLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDO1lBQ2hDLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDO1lBQ3RDLE1BQU0sSUFBSSxHQUFHLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN0QyxPQUFPLElBQUksS0FBSyxDQUFDLENBQUM7U0FDckI7UUFDRCxPQUFPLElBQUksQ0FBQztJQUNoQixDQUFDO0lBRU0sVUFBVSxDQUEyQixLQUFhO1FBQ3JELE9BQU8sS0FBSyxHQUFHLENBQUMsSUFBSSxLQUFLLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUNuRCxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDO1lBQ2hELENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBWSxDQUFDLENBQUMsQ0FDcEUsQ0FBQztJQUNuQixDQUFDO0lBRUQsYUFBYTtJQUNOLE1BQU0sS0FBUyxDQUFDO0lBRWhCLEtBQUssQ0FBQyxLQUFjLEVBQUUsR0FBWTtRQUNyQyx1RUFBdUU7UUFDdkUsd0VBQXdFO1FBQ3hFLCtCQUErQjtRQUMvQixPQUFPLFVBQVUsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxJQUFJLENBQUMsYUFBYSxDQUFRLENBQUM7SUFDbkUsQ0FBQztJQUVTLGFBQWEsQ0FBQyxNQUFxQixFQUFFLE1BQWMsRUFBRSxNQUFjO1FBQ3pFLE1BQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUM7UUFDN0IsT0FBTyxNQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FBRyxNQUFNLEVBQUUsQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUN4RixDQUFDO0NBQ0oiLCJmaWxlIjoidmVjdG9yL2Jhc2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4vLyBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbi8vIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4vLyByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4vLyB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4vLyBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Vcbi8vIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbi8vXG4vLyAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuLy9cbi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbi8vIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4vLyBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuLy8gS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4vLyBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4vLyB1bmRlciB0aGUgTGljZW5zZS5cblxuaW1wb3J0IHsgRGF0YSB9IGZyb20gJy4uL2RhdGEnO1xuaW1wb3J0IHsgVmVjdG9yIH0gZnJvbSAnLi4vdmVjdG9yJztcbmltcG9ydCB7IERhdGFUeXBlIH0gZnJvbSAnLi4vdHlwZSc7XG5pbXBvcnQgeyBDaHVua2VkVmVjdG9yIH0gZnJvbSAnLi9jaHVua2VkJztcbmltcG9ydCB7IGNsYW1wUmFuZ2UgfSBmcm9tICcuLi91dGlsL3ZlY3Rvcic7XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBCYXNlVmVjdG9yPFQgZXh0ZW5kcyBEYXRhVHlwZSA9IGFueT4gZXh0ZW5kcyBWZWN0b3I8VD4ge1xuXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHByb3RlY3RlZCBfZGF0YTogRGF0YTxUPjtcbiAgICBwcm90ZWN0ZWQgX3N0cmlkZTogbnVtYmVyID0gMTtcbiAgICBwcm90ZWN0ZWQgX251bUNoaWxkcmVuOiBudW1iZXIgPSAwO1xuICAgIHByb3RlY3RlZCBfY2hpbGRyZW4/OiBWZWN0b3JbXTtcblxuICAgIGNvbnN0cnVjdG9yKGRhdGE6IERhdGE8VD4sIGNoaWxkcmVuPzogVmVjdG9yW10sIHN0cmlkZT86IG51bWJlcikge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLl9jaGlsZHJlbiA9IGNoaWxkcmVuO1xuICAgICAgICB0aGlzLmJpbmREYXRhQWNjZXNzb3JzKHRoaXMuX2RhdGEgPSBkYXRhKTtcbiAgICAgICAgdGhpcy5fbnVtQ2hpbGRyZW4gPSBkYXRhLmNoaWxkRGF0YS5sZW5ndGg7XG4gICAgICAgIHRoaXMuX3N0cmlkZSA9IE1hdGguZmxvb3IoTWF0aC5tYXgoc3RyaWRlIHx8IDEsIDEpKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0IGRhdGEoKSB7IHJldHVybiB0aGlzLl9kYXRhOyB9XG4gICAgcHVibGljIGdldCBzdHJpZGUoKSB7IHJldHVybiB0aGlzLl9zdHJpZGU7IH1cbiAgICBwdWJsaWMgZ2V0IG51bUNoaWxkcmVuKCkgeyByZXR1cm4gdGhpcy5fbnVtQ2hpbGRyZW47IH1cblxuICAgIHB1YmxpYyBnZXQgdHlwZSgpIHsgcmV0dXJuIHRoaXMuZGF0YS50eXBlOyB9XG4gICAgcHVibGljIGdldCBsZW5ndGgoKSB7IHJldHVybiB0aGlzLmRhdGEubGVuZ3RoOyB9XG4gICAgcHVibGljIGdldCBvZmZzZXQoKSB7IHJldHVybiB0aGlzLmRhdGEub2Zmc2V0OyB9XG4gICAgcHVibGljIGdldCBudWxsQ291bnQoKSB7IHJldHVybiB0aGlzLmRhdGEubnVsbENvdW50OyB9XG4gICAgcHVibGljIGdldCBWZWN0b3JOYW1lKCkgeyByZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci5uYW1lOyB9XG4gICAgcHVibGljIGdldCBUVHlwZSgpOiBUWydUVHlwZSddIHsgcmV0dXJuIHRoaXMuZGF0YS5UVHlwZTsgfVxuICAgIHB1YmxpYyBnZXQgVEFycmF5KCk6IFRbJ1RBcnJheSddIHsgcmV0dXJuIHRoaXMuZGF0YS5UQXJyYXk7IH1cbiAgICBwdWJsaWMgZ2V0IFRWYWx1ZSgpOiBUWydUVmFsdWUnXSB7IHJldHVybiB0aGlzLmRhdGEuVFZhbHVlOyB9XG4gICAgcHVibGljIGdldCBBcnJheVR5cGUoKTogVFsnQXJyYXlUeXBlJ10geyByZXR1cm4gdGhpcy5kYXRhLkFycmF5VHlwZTsgfVxuXG4gICAgcHVibGljIGdldCB2YWx1ZXMoKSB7IHJldHVybiB0aGlzLmRhdGEudmFsdWVzOyB9XG4gICAgcHVibGljIGdldCB0eXBlSWRzKCkgeyByZXR1cm4gdGhpcy5kYXRhLnR5cGVJZHM7IH1cbiAgICBwdWJsaWMgZ2V0IG51bGxCaXRtYXAoKSB7IHJldHVybiB0aGlzLmRhdGEubnVsbEJpdG1hcDsgfVxuICAgIHB1YmxpYyBnZXQgdmFsdWVPZmZzZXRzKCkgeyByZXR1cm4gdGhpcy5kYXRhLnZhbHVlT2Zmc2V0czsgfVxuXG4gICAgcHVibGljIGdldCBbU3ltYm9sLnRvU3RyaW5nVGFnXSgpIHsgcmV0dXJuIGAke3RoaXMuVmVjdG9yTmFtZX08JHt0aGlzLnR5cGVbU3ltYm9sLnRvU3RyaW5nVGFnXX0+YDsgfVxuXG4gICAgcHVibGljIGNsb25lPFIgZXh0ZW5kcyBEYXRhVHlwZSA9IFQ+KGRhdGE6IERhdGE8Uj4sIGNoaWxkcmVuID0gdGhpcy5fY2hpbGRyZW4sIHN0cmlkZSA9IHRoaXMuc3RyaWRlKSB7XG4gICAgICAgIHJldHVybiBWZWN0b3IubmV3PFI+KGRhdGEsIGNoaWxkcmVuLCBzdHJpZGUpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjb25jYXQoLi4ub3RoZXJzOiBWZWN0b3I8VD5bXSk6IFZlY3RvcjxUPiB7XG4gICAgICAgIHJldHVybiBDaHVua2VkVmVjdG9yLmNvbmNhdDxUPih0aGlzLCAuLi5vdGhlcnMpIGFzIFZlY3RvcjxUPjtcbiAgICB9XG5cbiAgICBwdWJsaWMgaXNWYWxpZChpbmRleDogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgICAgIGlmICh0aGlzLm51bGxDb3VudCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGlkeCA9IHRoaXMub2Zmc2V0ICsgaW5kZXg7XG4gICAgICAgICAgICBjb25zdCB2YWwgPSB0aGlzLm51bGxCaXRtYXBbaWR4ID4+IDNdO1xuICAgICAgICAgICAgY29uc3QgbWFzayA9ICh2YWwgJiAoMSA8PCAoaWR4ICUgOCkpKTtcbiAgICAgICAgICAgIHJldHVybiBtYXNrICE9PSAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRDaGlsZEF0PFIgZXh0ZW5kcyBEYXRhVHlwZSA9IGFueT4oaW5kZXg6IG51bWJlcik6IFZlY3RvcjxSPiB8IG51bGwge1xuICAgICAgICByZXR1cm4gaW5kZXggPCAwIHx8IGluZGV4ID49IHRoaXMubnVtQ2hpbGRyZW4gPyBudWxsIDogKFxuICAgICAgICAgICAgKHRoaXMuX2NoaWxkcmVuIHx8ICh0aGlzLl9jaGlsZHJlbiA9IFtdKSlbaW5kZXhdIHx8XG4gICAgICAgICAgICAodGhpcy5fY2hpbGRyZW5baW5kZXhdID0gVmVjdG9yLm5ldzxSPih0aGlzLmRhdGEuY2hpbGREYXRhW2luZGV4XSBhcyBEYXRhPFI+KSlcbiAgICAgICAgKSBhcyBWZWN0b3I8Uj47XG4gICAgfVxuXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHB1YmxpYyB0b0pTT04oKTogYW55IHt9XG5cbiAgICBwdWJsaWMgc2xpY2UoYmVnaW4/OiBudW1iZXIsIGVuZD86IG51bWJlcik6IHRoaXMge1xuICAgICAgICAvLyBBZGp1c3QgYXJncyBzaW1pbGFyIHRvIEFycmF5LnByb3RvdHlwZS5zbGljZS4gTm9ybWFsaXplIGJlZ2luL2VuZCB0b1xuICAgICAgICAvLyBjbGFtcCBiZXR3ZWVuIDAgYW5kIGxlbmd0aCwgYW5kIHdyYXAgYXJvdW5kIG9uIG5lZ2F0aXZlIGluZGljZXMsIGUuZy5cbiAgICAgICAgLy8gc2xpY2UoLTEsIDUpIG9yIHNsaWNlKDUsIC0xKVxuICAgICAgICByZXR1cm4gY2xhbXBSYW5nZSh0aGlzLCBiZWdpbiwgZW5kLCB0aGlzLnNsaWNlSW50ZXJuYWwpIGFzIGFueTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgc2xpY2VJbnRlcm5hbCh2ZWN0b3I6IEJhc2VWZWN0b3I8VD4sIG9mZnNldDogbnVtYmVyLCBsZW5ndGg6IG51bWJlcikge1xuICAgICAgICBjb25zdCBzdHJpZGUgPSB2ZWN0b3Iuc3RyaWRlO1xuICAgICAgICByZXR1cm4gdmVjdG9yLmNsb25lKHZlY3Rvci5kYXRhLnNsaWNlKG9mZnNldCAqIHN0cmlkZSwgKGxlbmd0aCAtIG9mZnNldCkgKiBzdHJpZGUpKTtcbiAgICB9XG59XG4iXX0=
