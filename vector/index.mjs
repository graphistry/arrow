// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.  You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.
export { Row } from './row';
export { Vector } from '../vector';
export { BaseVector } from './base';
export { BinaryVector } from './binary';
export { BoolVector } from './bool';
export { Chunked } from './chunked';
export { DateVector, DateDayVector, DateMillisecondVector } from './date';
export { DecimalVector } from './decimal';
export { DictionaryVector } from './dictionary';
export { FixedSizeBinaryVector } from './fixedsizebinary';
export { FixedSizeListVector } from './fixedsizelist';
export { FloatVector, Float16Vector, Float32Vector, Float64Vector } from './float';
export { IntervalVector, IntervalDayTimeVector, IntervalYearMonthVector } from './interval';
export { IntVector, Int8Vector, Int16Vector, Int32Vector, Int64Vector, Uint8Vector, Uint16Vector, Uint32Vector, Uint64Vector } from './int';
export { ListVector } from './list';
export { MapVector } from './map';
export { NullVector } from './null';
export { StructVector } from './struct';
export { TimestampVector, TimestampSecondVector, TimestampMillisecondVector, TimestampMicrosecondVector, TimestampNanosecondVector } from './timestamp';
export { TimeVector, TimeSecondVector, TimeMillisecondVector, TimeMicrosecondVector, TimeNanosecondVector } from './time';
export { UnionVector, DenseUnionVector, SparseUnionVector } from './union';
export { Utf8Vector } from './utf8';
import { Type } from '../enum';
import { Vector } from '../vector';
import { BaseVector } from './base';
import { setBool } from '../util/bit';
import { instance as getVisitor } from '../visitor/get';
import { instance as setVisitor } from '../visitor/set';
import { instance as indexOfVisitor } from '../visitor/indexof';
import { instance as toArrayVisitor } from '../visitor/toarray';
import { instance as iteratorVisitor } from '../visitor/iterator';
import { instance as byteWidthVisitor } from '../visitor/bytewidth';
import { instance as getVectorConstructor } from '../visitor/vectorctor';
/** @nocollapse */
Vector.new = newVector;
function newVector(data, ...args) {
    return new (getVectorConstructor.getVisitFn(data.type)())(data, ...args);
}
//
// We provide the following method implementations for code navigability purposes only.
// They're overridden at runtime below with the specific Visitor implementation for each type,
// short-circuiting the usual Visitor traversal and reducing intermediate lookups and calls.
// This comment is here to remind you to not set breakpoints in these function bodies, or to inform
// you why the breakpoints you have already set are not being triggered. Have a great day!
//
BaseVector.prototype.get = function baseVectorGet(index) {
    return getVisitor.visit(this, index);
};
BaseVector.prototype.set = function baseVectorSet(index, value) {
    return setVisitor.visit(this, index, value);
};
BaseVector.prototype.indexOf = function baseVectorIndexOf(value, fromIndex) {
    return indexOfVisitor.visit(this, value, fromIndex);
};
BaseVector.prototype.toArray = function baseVectorToArray() {
    return toArrayVisitor.visit(this);
};
BaseVector.prototype.getByteWidth = function baseVectorGetByteWidth() {
    return byteWidthVisitor.visit(this.type);
};
BaseVector.prototype[Symbol.iterator] = function baseVectorSymbolIterator() {
    return iteratorVisitor.visit(this);
};
BaseVector.prototype._bindDataAccessors = bindBaseVectorDataAccessors;
// Perf: bind and assign the operator Visitor methods to each of the Vector subclasses for each Type
Object.keys(Type)
    .filter((typeId) => typeId !== Type.NONE && typeId !== Type[Type.NONE])
    .map((T) => Type[T]).filter((T) => typeof T === 'number')
    .forEach((typeId) => {
    let typeIds;
    switch (typeId) {
        case Type.Int:
            typeIds = [Type.Int8, Type.Int16, Type.Int32, Type.Int64, Type.Uint8, Type.Uint16, Type.Uint32, Type.Uint64];
            break;
        case Type.Float:
            typeIds = [Type.Float16, Type.Float32, Type.Float64];
            break;
        case Type.Date:
            typeIds = [Type.DateDay, Type.DateMillisecond];
            break;
        case Type.Time:
            typeIds = [Type.TimeSecond, Type.TimeMillisecond, Type.TimeMicrosecond, Type.TimeNanosecond];
            break;
        case Type.Timestamp:
            typeIds = [Type.TimestampSecond, Type.TimestampMillisecond, Type.TimestampMicrosecond, Type.TimestampNanosecond];
            break;
        case Type.Interval:
            typeIds = [Type.IntervalDayTime, Type.IntervalYearMonth];
            break;
        case Type.Union:
            typeIds = [Type.DenseUnion, Type.SparseUnion];
            break;
        default:
            typeIds = [typeId];
            break;
    }
    typeIds.forEach((typeId) => {
        const VectorCtor = getVectorConstructor.visit(typeId);
        VectorCtor.prototype['get'] = partial1(getVisitor.getVisitFn(typeId));
        VectorCtor.prototype['set'] = partial2(setVisitor.getVisitFn(typeId));
        VectorCtor.prototype['indexOf'] = partial2(indexOfVisitor.getVisitFn(typeId));
        VectorCtor.prototype['toArray'] = partial0(toArrayVisitor.getVisitFn(typeId));
        VectorCtor.prototype['getByteWidth'] = partial0(byteWidthVisitor.getVisitFn(typeId));
        VectorCtor.prototype[Symbol.iterator] = partial0(iteratorVisitor.getVisitFn(typeId));
    });
});
function partial0(visit) {
    return function () { return visit(this); };
}
function partial1(visit) {
    return function (a) { return visit(this, a); };
}
function partial2(visit) {
    return function (a, b) { return visit(this, a, b); };
}
function wrapNullable1(fn) {
    return function (i) { return this.isValid(i) ? fn.call(this, i) : null; };
}
function wrapNullableSet(fn) {
    return function (i, a) {
        if (setBool(this.nullBitmap, this.offset + i, a != null)) {
            fn.call(this, i, a);
        }
    };
}
// @ts-ignore
function bindBaseVectorDataAccessors(data) {
    const type = this.type;
    this['get'] = getVisitor.getVisitFn(type).bind(this, this);
    this['set'] = setVisitor.getVisitFn(type).bind(this, this);
    this['indexOf'] = indexOfVisitor.getVisitFn(type).bind(this, this);
    this['toArray'] = toArrayVisitor.getVisitFn(type).bind(this, this);
    this[Symbol.iterator] = iteratorVisitor.getVisitFn(type).bind(this, this);
    if (this.nullCount > 0) {
        this['get'] = wrapNullable1(this['get']);
        this['set'] = wrapNullableSet(this['set']);
    }
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,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LGNBQWMsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksRUFBUSxJQUFZLENBQUMsQ0FBQztJQUNqRixJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsY0FBYyxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFRLElBQVksQ0FBQyxDQUFDO0lBQ2pGLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsZUFBZSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFRLElBQVksQ0FBQyxDQUFDO0lBQ3hGLElBQUksSUFBSSxDQUFDLFNBQVMsR0FBRyxDQUFDLEVBQUU7UUFDcEIsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLGFBQWEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUN6QyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsZUFBZSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0tBQzlDO0FBQ0wsQ0FBQyIsImZpbGUiOiJ2ZWN0b3IvaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4vLyBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbi8vIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4vLyByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4vLyB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4vLyBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Vcbi8vIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbi8vXG4vLyAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuLy9cbi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbi8vIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4vLyBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuLy8gS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4vLyBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4vLyB1bmRlciB0aGUgTGljZW5zZS5cblxuZXhwb3J0IHsgUm93IH0gZnJvbSAnLi9yb3cnO1xuZXhwb3J0IHsgVmVjdG9yIH0gZnJvbSAnLi4vdmVjdG9yJztcbmV4cG9ydCB7IEJhc2VWZWN0b3IgfSBmcm9tICcuL2Jhc2UnO1xuZXhwb3J0IHsgQmluYXJ5VmVjdG9yIH0gZnJvbSAnLi9iaW5hcnknO1xuZXhwb3J0IHsgQm9vbFZlY3RvciB9IGZyb20gJy4vYm9vbCc7XG5leHBvcnQgeyBDaHVua2VkIH0gZnJvbSAnLi9jaHVua2VkJztcbmV4cG9ydCB7IERhdGVWZWN0b3IsIERhdGVEYXlWZWN0b3IsIERhdGVNaWxsaXNlY29uZFZlY3RvciB9IGZyb20gJy4vZGF0ZSc7XG5leHBvcnQgeyBEZWNpbWFsVmVjdG9yIH0gZnJvbSAnLi9kZWNpbWFsJztcbmV4cG9ydCB7IERpY3Rpb25hcnlWZWN0b3IgfSBmcm9tICcuL2RpY3Rpb25hcnknO1xuZXhwb3J0IHsgRml4ZWRTaXplQmluYXJ5VmVjdG9yIH0gZnJvbSAnLi9maXhlZHNpemViaW5hcnknO1xuZXhwb3J0IHsgRml4ZWRTaXplTGlzdFZlY3RvciB9IGZyb20gJy4vZml4ZWRzaXplbGlzdCc7XG5leHBvcnQgeyBGbG9hdFZlY3RvciwgRmxvYXQxNlZlY3RvciwgRmxvYXQzMlZlY3RvciwgRmxvYXQ2NFZlY3RvciB9IGZyb20gJy4vZmxvYXQnO1xuZXhwb3J0IHsgSW50ZXJ2YWxWZWN0b3IsIEludGVydmFsRGF5VGltZVZlY3RvciwgSW50ZXJ2YWxZZWFyTW9udGhWZWN0b3IgfSBmcm9tICcuL2ludGVydmFsJztcbmV4cG9ydCB7IEludFZlY3RvciwgSW50OFZlY3RvciwgSW50MTZWZWN0b3IsIEludDMyVmVjdG9yLCBJbnQ2NFZlY3RvciwgVWludDhWZWN0b3IsIFVpbnQxNlZlY3RvciwgVWludDMyVmVjdG9yLCBVaW50NjRWZWN0b3IgfSBmcm9tICcuL2ludCc7XG5leHBvcnQgeyBMaXN0VmVjdG9yIH0gZnJvbSAnLi9saXN0JztcbmV4cG9ydCB7IE1hcFZlY3RvciB9IGZyb20gJy4vbWFwJztcbmV4cG9ydCB7IE51bGxWZWN0b3IgfSBmcm9tICcuL251bGwnO1xuZXhwb3J0IHsgU3RydWN0VmVjdG9yIH0gZnJvbSAnLi9zdHJ1Y3QnO1xuZXhwb3J0IHsgVGltZXN0YW1wVmVjdG9yLCBUaW1lc3RhbXBTZWNvbmRWZWN0b3IsIFRpbWVzdGFtcE1pbGxpc2Vjb25kVmVjdG9yLCBUaW1lc3RhbXBNaWNyb3NlY29uZFZlY3RvciwgVGltZXN0YW1wTmFub3NlY29uZFZlY3RvciB9IGZyb20gJy4vdGltZXN0YW1wJztcbmV4cG9ydCB7IFRpbWVWZWN0b3IsIFRpbWVTZWNvbmRWZWN0b3IsIFRpbWVNaWxsaXNlY29uZFZlY3RvciwgVGltZU1pY3Jvc2Vjb25kVmVjdG9yLCBUaW1lTmFub3NlY29uZFZlY3RvciB9IGZyb20gJy4vdGltZSc7XG5leHBvcnQgeyBVbmlvblZlY3RvciwgRGVuc2VVbmlvblZlY3RvciwgU3BhcnNlVW5pb25WZWN0b3IgfSBmcm9tICcuL3VuaW9uJztcbmV4cG9ydCB7IFV0ZjhWZWN0b3IgfSBmcm9tICcuL3V0ZjgnO1xuXG5pbXBvcnQgeyBEYXRhIH0gZnJvbSAnLi4vZGF0YSc7XG5pbXBvcnQgeyBUeXBlIH0gZnJvbSAnLi4vZW51bSc7XG5pbXBvcnQgeyBWZWN0b3IgfSBmcm9tICcuLi92ZWN0b3InO1xuaW1wb3J0IHsgRGF0YVR5cGUgfSBmcm9tICcuLi90eXBlJztcbmltcG9ydCB7IEJhc2VWZWN0b3IgfSBmcm9tICcuL2Jhc2UnO1xuaW1wb3J0IHsgc2V0Qm9vbCB9IGZyb20gJy4uL3V0aWwvYml0JztcbmltcG9ydCB7IFZlY3RvciBhcyBWLCBWZWN0b3JDdG9yQXJncyB9IGZyb20gJy4uL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgaW5zdGFuY2UgYXMgZ2V0VmlzaXRvciB9IGZyb20gJy4uL3Zpc2l0b3IvZ2V0JztcbmltcG9ydCB7IGluc3RhbmNlIGFzIHNldFZpc2l0b3IgfSBmcm9tICcuLi92aXNpdG9yL3NldCc7XG5pbXBvcnQgeyBpbnN0YW5jZSBhcyBpbmRleE9mVmlzaXRvciB9IGZyb20gJy4uL3Zpc2l0b3IvaW5kZXhvZic7XG5pbXBvcnQgeyBpbnN0YW5jZSBhcyB0b0FycmF5VmlzaXRvciB9IGZyb20gJy4uL3Zpc2l0b3IvdG9hcnJheSc7XG5pbXBvcnQgeyBpbnN0YW5jZSBhcyBpdGVyYXRvclZpc2l0b3IgfSBmcm9tICcuLi92aXNpdG9yL2l0ZXJhdG9yJztcbmltcG9ydCB7IGluc3RhbmNlIGFzIGJ5dGVXaWR0aFZpc2l0b3IgfSBmcm9tICcuLi92aXNpdG9yL2J5dGV3aWR0aCc7XG5pbXBvcnQgeyBpbnN0YW5jZSBhcyBnZXRWZWN0b3JDb25zdHJ1Y3RvciB9IGZyb20gJy4uL3Zpc2l0b3IvdmVjdG9yY3Rvcic7XG5cbmRlY2xhcmUgbW9kdWxlICcuLi92ZWN0b3InIHtcbiAgICBuYW1lc3BhY2UgVmVjdG9yIHtcbiAgICAgICAgZXhwb3J0IHsgbmV3VmVjdG9yIGFzIG5ldyB9O1xuICAgIH1cbn1cblxuZGVjbGFyZSBtb2R1bGUgJy4vYmFzZScge1xuICAgIGludGVyZmFjZSBCYXNlVmVjdG9yPFQgZXh0ZW5kcyBEYXRhVHlwZT4ge1xuICAgICAgICBnZXQoaW5kZXg6IG51bWJlcik6IFRbJ1RWYWx1ZSddIHwgbnVsbDtcbiAgICAgICAgc2V0KGluZGV4OiBudW1iZXIsIHZhbHVlOiBUWydUVmFsdWUnXSB8IG51bGwpOiB2b2lkO1xuICAgICAgICBpbmRleE9mKHZhbHVlOiBUWydUVmFsdWUnXSB8IG51bGwsIGZyb21JbmRleD86IG51bWJlcik6IG51bWJlcjtcbiAgICAgICAgdG9BcnJheSgpOiBUWydUQXJyYXknXTtcbiAgICAgICAgZ2V0Qnl0ZVdpZHRoKCk6IG51bWJlcjtcbiAgICAgICAgW1N5bWJvbC5pdGVyYXRvcl0oKTogSXRlcmFibGVJdGVyYXRvcjxUWydUVmFsdWUnXSB8IG51bGw+O1xuICAgIH1cbn1cblxuLyoqIEBub2NvbGxhcHNlICovXG5WZWN0b3IubmV3ID0gbmV3VmVjdG9yO1xuXG5mdW5jdGlvbiBuZXdWZWN0b3I8VCBleHRlbmRzIERhdGFUeXBlPihkYXRhOiBEYXRhPFQ+LCAuLi5hcmdzOiBWZWN0b3JDdG9yQXJnczxWPFQ+Pik6IFY8VD4ge1xuICAgIHJldHVybiBuZXcgKGdldFZlY3RvckNvbnN0cnVjdG9yLmdldFZpc2l0Rm4oZGF0YS50eXBlKSgpKShkYXRhLCAuLi5hcmdzKSBhcyBWPFQ+O1xufVxuXG4vL1xuLy8gV2UgcHJvdmlkZSB0aGUgZm9sbG93aW5nIG1ldGhvZCBpbXBsZW1lbnRhdGlvbnMgZm9yIGNvZGUgbmF2aWdhYmlsaXR5IHB1cnBvc2VzIG9ubHkuXG4vLyBUaGV5J3JlIG92ZXJyaWRkZW4gYXQgcnVudGltZSBiZWxvdyB3aXRoIHRoZSBzcGVjaWZpYyBWaXNpdG9yIGltcGxlbWVudGF0aW9uIGZvciBlYWNoIHR5cGUsXG4vLyBzaG9ydC1jaXJjdWl0aW5nIHRoZSB1c3VhbCBWaXNpdG9yIHRyYXZlcnNhbCBhbmQgcmVkdWNpbmcgaW50ZXJtZWRpYXRlIGxvb2t1cHMgYW5kIGNhbGxzLlxuLy8gVGhpcyBjb21tZW50IGlzIGhlcmUgdG8gcmVtaW5kIHlvdSB0byBub3Qgc2V0IGJyZWFrcG9pbnRzIGluIHRoZXNlIGZ1bmN0aW9uIGJvZGllcywgb3IgdG8gaW5mb3JtXG4vLyB5b3Ugd2h5IHRoZSBicmVha3BvaW50cyB5b3UgaGF2ZSBhbHJlYWR5IHNldCBhcmUgbm90IGJlaW5nIHRyaWdnZXJlZC4gSGF2ZSBhIGdyZWF0IGRheSFcbi8vXG5cbkJhc2VWZWN0b3IucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIGJhc2VWZWN0b3JHZXQ8VCBleHRlbmRzIERhdGFUeXBlPih0aGlzOiBCYXNlVmVjdG9yPFQ+LCBpbmRleDogbnVtYmVyKTogVFsnVFZhbHVlJ10gfCBudWxsIHtcbiAgICByZXR1cm4gZ2V0VmlzaXRvci52aXNpdCh0aGlzLCBpbmRleCk7XG59O1xuXG5CYXNlVmVjdG9yLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiBiYXNlVmVjdG9yU2V0PFQgZXh0ZW5kcyBEYXRhVHlwZT4odGhpczogQmFzZVZlY3RvcjxUPiwgaW5kZXg6IG51bWJlciwgdmFsdWU6IFRbJ1RWYWx1ZSddIHwgbnVsbCk6IHZvaWQge1xuICAgIHJldHVybiBzZXRWaXNpdG9yLnZpc2l0KHRoaXMsIGluZGV4LCB2YWx1ZSk7XG59O1xuXG5CYXNlVmVjdG9yLnByb3RvdHlwZS5pbmRleE9mID0gZnVuY3Rpb24gYmFzZVZlY3RvckluZGV4T2Y8VCBleHRlbmRzIERhdGFUeXBlPih0aGlzOiBCYXNlVmVjdG9yPFQ+LCB2YWx1ZTogVFsnVFZhbHVlJ10gfCBudWxsLCBmcm9tSW5kZXg/OiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiBpbmRleE9mVmlzaXRvci52aXNpdCh0aGlzLCB2YWx1ZSwgZnJvbUluZGV4KTtcbn07XG5cbkJhc2VWZWN0b3IucHJvdG90eXBlLnRvQXJyYXkgPSBmdW5jdGlvbiBiYXNlVmVjdG9yVG9BcnJheTxUIGV4dGVuZHMgRGF0YVR5cGU+KHRoaXM6IEJhc2VWZWN0b3I8VD4pOiBUWydUQXJyYXknXSB7XG4gICAgcmV0dXJuIHRvQXJyYXlWaXNpdG9yLnZpc2l0KHRoaXMpO1xufTtcblxuQmFzZVZlY3Rvci5wcm90b3R5cGUuZ2V0Qnl0ZVdpZHRoID0gZnVuY3Rpb24gYmFzZVZlY3RvckdldEJ5dGVXaWR0aDxUIGV4dGVuZHMgRGF0YVR5cGU+KHRoaXM6IEJhc2VWZWN0b3I8VD4pOiBudW1iZXIge1xuICAgIHJldHVybiBieXRlV2lkdGhWaXNpdG9yLnZpc2l0KHRoaXMudHlwZSk7XG59O1xuXG5CYXNlVmVjdG9yLnByb3RvdHlwZVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gYmFzZVZlY3RvclN5bWJvbEl0ZXJhdG9yPFQgZXh0ZW5kcyBEYXRhVHlwZT4odGhpczogQmFzZVZlY3RvcjxUPik6IEl0ZXJhYmxlSXRlcmF0b3I8VFsnVFZhbHVlJ10gfCBudWxsPiB7XG4gICAgcmV0dXJuIGl0ZXJhdG9yVmlzaXRvci52aXNpdCh0aGlzKTtcbn07XG5cbihCYXNlVmVjdG9yLnByb3RvdHlwZSBhcyBhbnkpLl9iaW5kRGF0YUFjY2Vzc29ycyA9IGJpbmRCYXNlVmVjdG9yRGF0YUFjY2Vzc29ycztcblxuLy8gUGVyZjogYmluZCBhbmQgYXNzaWduIHRoZSBvcGVyYXRvciBWaXNpdG9yIG1ldGhvZHMgdG8gZWFjaCBvZiB0aGUgVmVjdG9yIHN1YmNsYXNzZXMgZm9yIGVhY2ggVHlwZVxuKE9iamVjdC5rZXlzKFR5cGUpIGFzIGFueVtdKVxuICAgIC5maWx0ZXIoKHR5cGVJZCkgPT4gdHlwZUlkICE9PSBUeXBlLk5PTkUgJiYgdHlwZUlkICE9PSBUeXBlW1R5cGUuTk9ORV0pXG4gICAgLm1hcCgoVDogYW55KSA9PiBUeXBlW1RdIGFzIGFueSkuZmlsdGVyKChUOiBhbnkpOiBUIGlzIFR5cGUgPT4gdHlwZW9mIFQgPT09ICdudW1iZXInKVxuICAgIC5mb3JFYWNoKCh0eXBlSWQpID0+IHtcbiAgICAgICAgbGV0IHR5cGVJZHM6IFR5cGVbXTtcbiAgICAgICAgc3dpdGNoICh0eXBlSWQpIHtcbiAgICAgICAgICAgIGNhc2UgVHlwZS5JbnQ6ICAgICAgIHR5cGVJZHMgPSBbVHlwZS5JbnQ4LCBUeXBlLkludDE2LCBUeXBlLkludDMyLCBUeXBlLkludDY0LCBUeXBlLlVpbnQ4LCBUeXBlLlVpbnQxNiwgVHlwZS5VaW50MzIsIFR5cGUuVWludDY0XTsgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFR5cGUuRmxvYXQ6ICAgICB0eXBlSWRzID0gW1R5cGUuRmxvYXQxNiwgVHlwZS5GbG9hdDMyLCBUeXBlLkZsb2F0NjRdOyBicmVhaztcbiAgICAgICAgICAgIGNhc2UgVHlwZS5EYXRlOiAgICAgIHR5cGVJZHMgPSBbVHlwZS5EYXRlRGF5LCBUeXBlLkRhdGVNaWxsaXNlY29uZF07IGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBUeXBlLlRpbWU6ICAgICAgdHlwZUlkcyA9IFtUeXBlLlRpbWVTZWNvbmQsIFR5cGUuVGltZU1pbGxpc2Vjb25kLCBUeXBlLlRpbWVNaWNyb3NlY29uZCwgVHlwZS5UaW1lTmFub3NlY29uZF07IGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBUeXBlLlRpbWVzdGFtcDogdHlwZUlkcyA9IFtUeXBlLlRpbWVzdGFtcFNlY29uZCwgVHlwZS5UaW1lc3RhbXBNaWxsaXNlY29uZCwgVHlwZS5UaW1lc3RhbXBNaWNyb3NlY29uZCwgVHlwZS5UaW1lc3RhbXBOYW5vc2Vjb25kXTsgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFR5cGUuSW50ZXJ2YWw6ICB0eXBlSWRzID0gW1R5cGUuSW50ZXJ2YWxEYXlUaW1lLCBUeXBlLkludGVydmFsWWVhck1vbnRoXTsgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFR5cGUuVW5pb246ICAgICB0eXBlSWRzID0gW1R5cGUuRGVuc2VVbmlvbiwgVHlwZS5TcGFyc2VVbmlvbl07IGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDogICAgICAgICAgICAgICAgdHlwZUlkcyA9IFt0eXBlSWRdOyBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB0eXBlSWRzLmZvckVhY2goKHR5cGVJZCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgVmVjdG9yQ3RvciA9IGdldFZlY3RvckNvbnN0cnVjdG9yLnZpc2l0KHR5cGVJZCk7XG4gICAgICAgICAgICBWZWN0b3JDdG9yLnByb3RvdHlwZVsnZ2V0J10gPSBwYXJ0aWFsMShnZXRWaXNpdG9yLmdldFZpc2l0Rm4odHlwZUlkKSk7XG4gICAgICAgICAgICBWZWN0b3JDdG9yLnByb3RvdHlwZVsnc2V0J10gPSBwYXJ0aWFsMihzZXRWaXNpdG9yLmdldFZpc2l0Rm4odHlwZUlkKSk7XG4gICAgICAgICAgICBWZWN0b3JDdG9yLnByb3RvdHlwZVsnaW5kZXhPZiddID0gcGFydGlhbDIoaW5kZXhPZlZpc2l0b3IuZ2V0VmlzaXRGbih0eXBlSWQpKTtcbiAgICAgICAgICAgIFZlY3RvckN0b3IucHJvdG90eXBlWyd0b0FycmF5J10gPSBwYXJ0aWFsMCh0b0FycmF5VmlzaXRvci5nZXRWaXNpdEZuKHR5cGVJZCkpO1xuICAgICAgICAgICAgVmVjdG9yQ3Rvci5wcm90b3R5cGVbJ2dldEJ5dGVXaWR0aCddID0gcGFydGlhbDAoYnl0ZVdpZHRoVmlzaXRvci5nZXRWaXNpdEZuKHR5cGVJZCkpO1xuICAgICAgICAgICAgVmVjdG9yQ3Rvci5wcm90b3R5cGVbU3ltYm9sLml0ZXJhdG9yXSA9IHBhcnRpYWwwKGl0ZXJhdG9yVmlzaXRvci5nZXRWaXNpdEZuKHR5cGVJZCkpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuZnVuY3Rpb24gcGFydGlhbDA8VD4odmlzaXQ6IChub2RlOiBUKSA9PiBhbnkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24odGhpczogVCkgeyByZXR1cm4gdmlzaXQodGhpcyk7IH07XG59XG5cbmZ1bmN0aW9uIHBhcnRpYWwxPFQ+KHZpc2l0OiAobm9kZTogVCwgYTogYW55KSA9PiBhbnkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24odGhpczogVCwgYTogYW55KSB7IHJldHVybiB2aXNpdCh0aGlzLCBhKTsgfTtcbn1cblxuZnVuY3Rpb24gcGFydGlhbDI8VD4odmlzaXQ6IChub2RlOiBULCBhOiBhbnksIGI6IGFueSkgPT4gYW55KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHRoaXM6IFQsIGE6IGFueSwgYjogYW55KSB7IHJldHVybiB2aXNpdCh0aGlzLCBhLCBiKTsgfTtcbn1cblxuZnVuY3Rpb24gd3JhcE51bGxhYmxlMTxUIGV4dGVuZHMgRGF0YVR5cGUsIFYgZXh0ZW5kcyBWZWN0b3I8VD4sIEYgZXh0ZW5kcyAoaTogbnVtYmVyKSA9PiBhbnk+KGZuOiBGKTogKC4uLmFyZ3M6IFBhcmFtZXRlcnM8Rj4pID0+IFJldHVyblR5cGU8Rj4ge1xuICAgIHJldHVybiBmdW5jdGlvbih0aGlzOiBWLCBpOiBudW1iZXIpIHsgcmV0dXJuIHRoaXMuaXNWYWxpZChpKSA/IGZuLmNhbGwodGhpcywgaSkgOiBudWxsOyB9O1xufVxuXG5mdW5jdGlvbiB3cmFwTnVsbGFibGVTZXQ8VCBleHRlbmRzIERhdGFUeXBlLCBWIGV4dGVuZHMgQmFzZVZlY3RvcjxUPiwgRiBleHRlbmRzIChpOiBudW1iZXIsIGE6IGFueSkgPT4gdm9pZD4oZm46IEYpOiAoLi4uYXJnczogUGFyYW1ldGVyczxGPikgPT4gdm9pZCB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHRoaXM6IFYsIGk6IG51bWJlciwgYTogYW55KSB7XG4gICAgICAgIGlmIChzZXRCb29sKHRoaXMubnVsbEJpdG1hcCwgdGhpcy5vZmZzZXQgKyBpLCBhICE9IG51bGwpKSB7XG4gICAgICAgICAgICBmbi5jYWxsKHRoaXMsIGksIGEpO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuLy8gQHRzLWlnbm9yZVxuZnVuY3Rpb24gYmluZEJhc2VWZWN0b3JEYXRhQWNjZXNzb3JzPFQgZXh0ZW5kcyBEYXRhVHlwZT4odGhpczogQmFzZVZlY3RvcjxUPiwgZGF0YTogRGF0YTxUPikge1xuICAgIGNvbnN0IHR5cGUgPSB0aGlzLnR5cGU7XG4gICAgdGhpc1snZ2V0J10gPSBnZXRWaXNpdG9yLmdldFZpc2l0Rm4odHlwZSkuYmluZCh0aGlzLCA8YW55PiB0aGlzIGFzIFY8VD4pO1xuICAgIHRoaXNbJ3NldCddID0gc2V0VmlzaXRvci5nZXRWaXNpdEZuKHR5cGUpLmJpbmQodGhpcywgPGFueT4gdGhpcyBhcyBWPFQ+KTtcbiAgICB0aGlzWydpbmRleE9mJ10gPSBpbmRleE9mVmlzaXRvci5nZXRWaXNpdEZuKHR5cGUpLmJpbmQodGhpcywgPGFueT4gdGhpcyBhcyBWPFQ+KTtcbiAgICB0aGlzWyd0b0FycmF5J10gPSB0b0FycmF5VmlzaXRvci5nZXRWaXNpdEZuKHR5cGUpLmJpbmQodGhpcywgPGFueT4gdGhpcyBhcyBWPFQ+KTtcbiAgICB0aGlzW1N5bWJvbC5pdGVyYXRvcl0gPSBpdGVyYXRvclZpc2l0b3IuZ2V0VmlzaXRGbih0eXBlKS5iaW5kKHRoaXMsIDxhbnk+IHRoaXMgYXMgVjxUPik7XG4gICAgaWYgKHRoaXMubnVsbENvdW50ID4gMCkge1xuICAgICAgICB0aGlzWydnZXQnXSA9IHdyYXBOdWxsYWJsZTEodGhpc1snZ2V0J10pO1xuICAgICAgICB0aGlzWydzZXQnXSA9IHdyYXBOdWxsYWJsZVNldCh0aGlzWydzZXQnXSk7XG4gICAgfVxufVxuIl19
