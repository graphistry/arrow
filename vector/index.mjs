// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.  You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.
export { Row } from './all';
export { Vector } from './all';
export { BaseVector } from './all';
export { BinaryVector } from './all';
export { BoolVector } from './all';
export { ChunkedVector } from './all';
export { DateVector, DateDayVector, DateMillisecondVector } from './all';
export { DecimalVector } from './all';
export { DictionaryVector } from './all';
export { FixedSizeBinaryVector } from './all';
export { FixedSizeListVector } from './all';
export { FloatVector, Float16Vector, Float32Vector, Float64Vector } from './all';
export { IntervalVector, IntervalDayTimeVector, IntervalYearMonthVector } from './all';
export { IntVector, Int8Vector, Int16Vector, Int32Vector, Int64Vector, Uint8Vector, Uint16Vector, Uint32Vector, Uint64Vector } from './all';
export { ListVector } from './all';
export { MapVector } from './all';
export { NullVector } from './all';
export { StructVector } from './all';
export { TimestampVector, TimestampSecondVector, TimestampMillisecondVector, TimestampMicrosecondVector, TimestampNanosecondVector } from './all';
export { TimeVector, TimeSecondVector, TimeMillisecondVector, TimeMicrosecondVector, TimeNanosecondVector } from './all';
export { UnionVector, DenseUnionVector, SparseUnionVector } from './all';
export { Utf8Vector } from './all';
import { Type } from '../enum';
import { Vector } from '../vector';
import { BaseVector } from './base';
import { setBool } from '../util/bit';
import { instance as getVisitor } from '../visitor/get';
import { instance as setVisitor } from '../visitor/set';
import { instance as indexOfVisitor } from '../visitor/indexof';
import { instance as toArrayVisitor } from '../visitor/toarray';
import { instance as iteratorVisitor } from '../visitor/iterator';
import { instance as byteWidthVisitor } from '../visitor/bytewidth';
import { instance as getVectorConstructor } from '../visitor/vectorctor';
/** @nocollapse */
Vector.new = newVector;
function newVector(data, ...args) {
    return new (getVectorConstructor.getVisitFn(data.type)())(data, ...args);
}
//
// We provide the following method implementations for code navigability purposes only.
// They're overridden at runtime below with the specific Visitor implementation for each type,
// short-circuiting the usual Visitor traversal and reducing intermediate lookups and calls.
// This comment is here to remind you to not set breakpoints in these function bodies, or to inform
// you why the breakpoints you have already set are not being triggered. Have a great day!
//
BaseVector.prototype.get = function baseVectorGet(index) {
    return getVisitor.visit(this, index);
};
BaseVector.prototype.set = function baseVectorSet(index, value) {
    return setVisitor.visit(this, index, value);
};
BaseVector.prototype.indexOf = function baseVectorIndexOf(value, fromIndex) {
    return indexOfVisitor.visit(this, value, fromIndex);
};
BaseVector.prototype.toArray = function baseVectorToArray() {
    return toArrayVisitor.visit(this);
};
BaseVector.prototype.getByteWidth = function baseVectorGetByteWidth() {
    return byteWidthVisitor.visit(this.type);
};
BaseVector.prototype[Symbol.iterator] = function baseVectorSymbolIterator() {
    return iteratorVisitor.visit(this);
};
// Perf: bind and assign the operator Visitor methods to each of the Vector subclasses for each Type
Object.keys(Type)
    .filter((TType) => TType !== Type.NONE && TType !== Type[Type.NONE])
    .map((T) => Type[T]).filter((T) => typeof T === 'number')
    .forEach((TType) => {
    let typeIds;
    switch (TType) {
        case Type['Int']:
            typeIds = [Type['Int8'], Type['Int16'], Type['Int32'], Type['Int64'], Type['Uint8'], Type['Uint16'], Type['Uint32'], Type['Uint64']];
            break;
        case Type['Float']:
            typeIds = [Type['Float16'], Type['Float32'], Type['Float64']];
            break;
        case Type['Date']:
            typeIds = [Type['DateDay'], Type['DateMillisecond']];
            break;
        case Type['Time']:
            typeIds = [Type['TimeSecond'], Type['TimeMillisecond'], Type['TimeMicrosecond'], Type['TimeNanosecond']];
            break;
        case Type['Timestamp']:
            typeIds = [Type['TimestampSecond'], Type['TimestampMillisecond'], Type['TimestampMicrosecond'], Type['TimestampNanosecond']];
            break;
        case Type['Interval']:
            typeIds = [Type['IntervalDayTime'], Type['IntervalYearMonth']];
            break;
        case Type['Union']:
            typeIds = [Type['DenseUnion'], Type['SparseUnion']];
            break;
        default:
            typeIds = [TType];
            break;
    }
    typeIds.forEach((TType) => {
        const VectorCtor = getVectorConstructor.visit(TType);
        VectorCtor.prototype['get'] = partial1(getVisitor.getVisitFn(TType));
        VectorCtor.prototype['set'] = partial2(setVisitor.getVisitFn(TType));
        VectorCtor.prototype['indexOf'] = partial2(indexOfVisitor.getVisitFn(TType));
        VectorCtor.prototype['toArray'] = partial0(toArrayVisitor.getVisitFn(TType));
        VectorCtor.prototype['getByteWidth'] = partial0(byteWidthVisitor.getVisitFn(TType));
        VectorCtor.prototype[Symbol.iterator] = partial0(iteratorVisitor.getVisitFn(TType));
    });
});
function partial0(visit) {
    return function () { return visit(this); };
}
function partial1(visit) {
    return function (a) { return visit(this, a); };
}
function partial2(visit) {
    return function (a, b) { return visit(this, a, b); };
}
function wrapNullableSet(fn) {
    return function (i, a) {
        if (setBool(this.nullBitmap, this.offset + i, a != null)) {
            fn.call(this, i, a);
        }
    };
}
// @ts-ignore
function bindBaseVectorDataAccessors(data) {
    const type = this.type;
    this['get'] = getVisitor.getVisitFn(type).bind(this, this);
    this['set'] = setVisitor.getVisitFn(type).bind(this, this);
    this['indexOf'] = indexOfVisitor.getVisitFn(type).bind(this, this);
    this['toArray'] = toArrayVisitor.getVisitFn(type).bind(this, this);
    this[Symbol.iterator] = iteratorVisitor.getVisitFn(type).bind(this, this);
    if (this.nullCount > 0) {
        this['set'] = wrapNullableSet(this['set']);
    }
    Vector.prototype.bindDataAccessors.call(this, data);
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,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QUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsY0FBYyxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFRLElBQVksQ0FBQyxDQUFDO0lBQ2pGLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsZUFBZSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFRLElBQVksQ0FBQyxDQUFDO0lBQ3hGLElBQUksSUFBSSxDQUFDLFNBQVMsR0FBRyxDQUFDLEVBQUU7UUFDcEIsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLGVBQWUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztLQUM5QztJQUNBLE1BQU0sQ0FBQyxTQUFpQixDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDakUsQ0FBQyIsImZpbGUiOiJ2ZWN0b3IvaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4vLyBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbi8vIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4vLyByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4vLyB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4vLyBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Vcbi8vIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbi8vXG4vLyAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuLy9cbi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbi8vIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4vLyBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuLy8gS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4vLyBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4vLyB1bmRlciB0aGUgTGljZW5zZS5cblxuZXhwb3J0IHsgUm93IH0gZnJvbSAnLi9hbGwnO1xuZXhwb3J0IHsgVmVjdG9yIH0gZnJvbSAnLi9hbGwnO1xuZXhwb3J0IHsgQmFzZVZlY3RvciB9IGZyb20gJy4vYWxsJztcbmV4cG9ydCB7IEJpbmFyeVZlY3RvciB9IGZyb20gJy4vYWxsJztcbmV4cG9ydCB7IEJvb2xWZWN0b3IgfSBmcm9tICcuL2FsbCc7XG5leHBvcnQgeyBDaHVua2VkVmVjdG9yIH0gZnJvbSAnLi9hbGwnO1xuZXhwb3J0IHsgRGF0ZVZlY3RvciwgRGF0ZURheVZlY3RvciwgRGF0ZU1pbGxpc2Vjb25kVmVjdG9yIH0gZnJvbSAnLi9hbGwnO1xuZXhwb3J0IHsgRGVjaW1hbFZlY3RvciB9IGZyb20gJy4vYWxsJztcbmV4cG9ydCB7IERpY3Rpb25hcnlWZWN0b3IgfSBmcm9tICcuL2FsbCc7XG5leHBvcnQgeyBGaXhlZFNpemVCaW5hcnlWZWN0b3IgfSBmcm9tICcuL2FsbCc7XG5leHBvcnQgeyBGaXhlZFNpemVMaXN0VmVjdG9yIH0gZnJvbSAnLi9hbGwnO1xuZXhwb3J0IHsgRmxvYXRWZWN0b3IsIEZsb2F0MTZWZWN0b3IsIEZsb2F0MzJWZWN0b3IsIEZsb2F0NjRWZWN0b3IgfSBmcm9tICcuL2FsbCc7XG5leHBvcnQgeyBJbnRlcnZhbFZlY3RvciwgSW50ZXJ2YWxEYXlUaW1lVmVjdG9yLCBJbnRlcnZhbFllYXJNb250aFZlY3RvciB9IGZyb20gJy4vYWxsJztcbmV4cG9ydCB7IEludFZlY3RvciwgSW50OFZlY3RvciwgSW50MTZWZWN0b3IsIEludDMyVmVjdG9yLCBJbnQ2NFZlY3RvciwgVWludDhWZWN0b3IsIFVpbnQxNlZlY3RvciwgVWludDMyVmVjdG9yLCBVaW50NjRWZWN0b3IgfSBmcm9tICcuL2FsbCc7XG5leHBvcnQgeyBMaXN0VmVjdG9yIH0gZnJvbSAnLi9hbGwnO1xuZXhwb3J0IHsgTWFwVmVjdG9yIH0gZnJvbSAnLi9hbGwnO1xuZXhwb3J0IHsgTnVsbFZlY3RvciB9IGZyb20gJy4vYWxsJztcbmV4cG9ydCB7IFN0cnVjdFZlY3RvciB9IGZyb20gJy4vYWxsJztcbmV4cG9ydCB7IFRpbWVzdGFtcFZlY3RvciwgVGltZXN0YW1wU2Vjb25kVmVjdG9yLCBUaW1lc3RhbXBNaWxsaXNlY29uZFZlY3RvciwgVGltZXN0YW1wTWljcm9zZWNvbmRWZWN0b3IsIFRpbWVzdGFtcE5hbm9zZWNvbmRWZWN0b3IgfSBmcm9tICcuL2FsbCc7XG5leHBvcnQgeyBUaW1lVmVjdG9yLCBUaW1lU2Vjb25kVmVjdG9yLCBUaW1lTWlsbGlzZWNvbmRWZWN0b3IsIFRpbWVNaWNyb3NlY29uZFZlY3RvciwgVGltZU5hbm9zZWNvbmRWZWN0b3IgfSBmcm9tICcuL2FsbCc7XG5leHBvcnQgeyBVbmlvblZlY3RvciwgRGVuc2VVbmlvblZlY3RvciwgU3BhcnNlVW5pb25WZWN0b3IgfSBmcm9tICcuL2FsbCc7XG5leHBvcnQgeyBVdGY4VmVjdG9yIH0gZnJvbSAnLi9hbGwnO1xuXG5pbXBvcnQgeyBEYXRhIH0gZnJvbSAnLi4vZGF0YSc7XG5pbXBvcnQgeyBUeXBlIH0gZnJvbSAnLi4vZW51bSc7XG5pbXBvcnQgeyBWZWN0b3IgfSBmcm9tICcuLi92ZWN0b3InO1xuaW1wb3J0IHsgRGF0YVR5cGUgfSBmcm9tICcuLi90eXBlJztcbmltcG9ydCB7IEJhc2VWZWN0b3IgfSBmcm9tICcuL2Jhc2UnO1xuaW1wb3J0IHsgc2V0Qm9vbCB9IGZyb20gJy4uL3V0aWwvYml0JztcbmltcG9ydCB7IFZlY3RvciBhcyBWLCBWZWN0b3JDdG9yQXJncyB9IGZyb20gJy4uL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgaW5zdGFuY2UgYXMgZ2V0VmlzaXRvciB9IGZyb20gJy4uL3Zpc2l0b3IvZ2V0JztcbmltcG9ydCB7IGluc3RhbmNlIGFzIHNldFZpc2l0b3IgfSBmcm9tICcuLi92aXNpdG9yL3NldCc7XG5pbXBvcnQgeyBpbnN0YW5jZSBhcyBpbmRleE9mVmlzaXRvciB9IGZyb20gJy4uL3Zpc2l0b3IvaW5kZXhvZic7XG5pbXBvcnQgeyBpbnN0YW5jZSBhcyB0b0FycmF5VmlzaXRvciB9IGZyb20gJy4uL3Zpc2l0b3IvdG9hcnJheSc7XG5pbXBvcnQgeyBpbnN0YW5jZSBhcyBpdGVyYXRvclZpc2l0b3IgfSBmcm9tICcuLi92aXNpdG9yL2l0ZXJhdG9yJztcbmltcG9ydCB7IGluc3RhbmNlIGFzIGJ5dGVXaWR0aFZpc2l0b3IgfSBmcm9tICcuLi92aXNpdG9yL2J5dGV3aWR0aCc7XG5pbXBvcnQgeyBpbnN0YW5jZSBhcyBnZXRWZWN0b3JDb25zdHJ1Y3RvciB9IGZyb20gJy4uL3Zpc2l0b3IvdmVjdG9yY3Rvcic7XG5cbmRlY2xhcmUgbW9kdWxlICcuLi92ZWN0b3InIHtcbiAgICBuYW1lc3BhY2UgVmVjdG9yIHtcbiAgICAgICAgZXhwb3J0IHsgbmV3VmVjdG9yIGFzIG5ldyB9O1xuICAgIH1cbn1cblxuZGVjbGFyZSBtb2R1bGUgJy4vYmFzZScge1xuICAgIGludGVyZmFjZSBCYXNlVmVjdG9yPFQgZXh0ZW5kcyBEYXRhVHlwZT4ge1xuICAgICAgICBnZXQoaW5kZXg6IG51bWJlcik6IFRbJ1RWYWx1ZSddIHwgbnVsbDtcbiAgICAgICAgc2V0KGluZGV4OiBudW1iZXIsIHZhbHVlOiBUWydUVmFsdWUnXSB8IG51bGwpOiB2b2lkO1xuICAgICAgICBpbmRleE9mKHZhbHVlOiBUWydUVmFsdWUnXSB8IG51bGwsIGZyb21JbmRleD86IG51bWJlcik6IG51bWJlcjtcbiAgICAgICAgdG9BcnJheSgpOiBUWydUQXJyYXknXTtcbiAgICAgICAgZ2V0Qnl0ZVdpZHRoKCk6IG51bWJlcjtcbiAgICAgICAgW1N5bWJvbC5pdGVyYXRvcl0oKTogSXRlcmFibGVJdGVyYXRvcjxUWydUVmFsdWUnXSB8IG51bGw+O1xuICAgIH1cbn1cblxuLyoqIEBub2NvbGxhcHNlICovXG5WZWN0b3IubmV3ID0gbmV3VmVjdG9yO1xuXG5mdW5jdGlvbiBuZXdWZWN0b3I8VCBleHRlbmRzIERhdGFUeXBlPihkYXRhOiBEYXRhPFQ+LCAuLi5hcmdzOiBWZWN0b3JDdG9yQXJnczxWPFQ+Pik6IFY8VD4ge1xuICAgIHJldHVybiBuZXcgKGdldFZlY3RvckNvbnN0cnVjdG9yLmdldFZpc2l0Rm4oZGF0YS50eXBlKSgpKShkYXRhLCAuLi5hcmdzKSBhcyBWPFQ+O1xufVxuXG4vL1xuLy8gV2UgcHJvdmlkZSB0aGUgZm9sbG93aW5nIG1ldGhvZCBpbXBsZW1lbnRhdGlvbnMgZm9yIGNvZGUgbmF2aWdhYmlsaXR5IHB1cnBvc2VzIG9ubHkuXG4vLyBUaGV5J3JlIG92ZXJyaWRkZW4gYXQgcnVudGltZSBiZWxvdyB3aXRoIHRoZSBzcGVjaWZpYyBWaXNpdG9yIGltcGxlbWVudGF0aW9uIGZvciBlYWNoIHR5cGUsXG4vLyBzaG9ydC1jaXJjdWl0aW5nIHRoZSB1c3VhbCBWaXNpdG9yIHRyYXZlcnNhbCBhbmQgcmVkdWNpbmcgaW50ZXJtZWRpYXRlIGxvb2t1cHMgYW5kIGNhbGxzLlxuLy8gVGhpcyBjb21tZW50IGlzIGhlcmUgdG8gcmVtaW5kIHlvdSB0byBub3Qgc2V0IGJyZWFrcG9pbnRzIGluIHRoZXNlIGZ1bmN0aW9uIGJvZGllcywgb3IgdG8gaW5mb3JtXG4vLyB5b3Ugd2h5IHRoZSBicmVha3BvaW50cyB5b3UgaGF2ZSBhbHJlYWR5IHNldCBhcmUgbm90IGJlaW5nIHRyaWdnZXJlZC4gSGF2ZSBhIGdyZWF0IGRheSFcbi8vXG5cbkJhc2VWZWN0b3IucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIGJhc2VWZWN0b3JHZXQ8VCBleHRlbmRzIERhdGFUeXBlPih0aGlzOiBCYXNlVmVjdG9yPFQ+LCBpbmRleDogbnVtYmVyKTogVFsnVFZhbHVlJ10gfCBudWxsIHtcbiAgICByZXR1cm4gZ2V0VmlzaXRvci52aXNpdCh0aGlzLCBpbmRleCk7XG59O1xuXG5CYXNlVmVjdG9yLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiBiYXNlVmVjdG9yU2V0PFQgZXh0ZW5kcyBEYXRhVHlwZT4odGhpczogQmFzZVZlY3RvcjxUPiwgaW5kZXg6IG51bWJlciwgdmFsdWU6IFRbJ1RWYWx1ZSddIHwgbnVsbCk6IHZvaWQge1xuICAgIHJldHVybiBzZXRWaXNpdG9yLnZpc2l0KHRoaXMsIGluZGV4LCB2YWx1ZSk7XG59O1xuXG5CYXNlVmVjdG9yLnByb3RvdHlwZS5pbmRleE9mID0gZnVuY3Rpb24gYmFzZVZlY3RvckluZGV4T2Y8VCBleHRlbmRzIERhdGFUeXBlPih0aGlzOiBCYXNlVmVjdG9yPFQ+LCB2YWx1ZTogVFsnVFZhbHVlJ10gfCBudWxsLCBmcm9tSW5kZXg/OiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiBpbmRleE9mVmlzaXRvci52aXNpdCh0aGlzLCB2YWx1ZSwgZnJvbUluZGV4KTtcbn07XG5cbkJhc2VWZWN0b3IucHJvdG90eXBlLnRvQXJyYXkgPSBmdW5jdGlvbiBiYXNlVmVjdG9yVG9BcnJheTxUIGV4dGVuZHMgRGF0YVR5cGU+KHRoaXM6IEJhc2VWZWN0b3I8VD4pOiBUWydUQXJyYXknXSB7XG4gICAgcmV0dXJuIHRvQXJyYXlWaXNpdG9yLnZpc2l0KHRoaXMpO1xufTtcblxuQmFzZVZlY3Rvci5wcm90b3R5cGUuZ2V0Qnl0ZVdpZHRoID0gZnVuY3Rpb24gYmFzZVZlY3RvckdldEJ5dGVXaWR0aDxUIGV4dGVuZHMgRGF0YVR5cGU+KHRoaXM6IEJhc2VWZWN0b3I8VD4pOiBudW1iZXIge1xuICAgIHJldHVybiBieXRlV2lkdGhWaXNpdG9yLnZpc2l0KHRoaXMudHlwZSk7XG59O1xuXG5CYXNlVmVjdG9yLnByb3RvdHlwZVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gYmFzZVZlY3RvclN5bWJvbEl0ZXJhdG9yPFQgZXh0ZW5kcyBEYXRhVHlwZT4odGhpczogQmFzZVZlY3RvcjxUPik6IEl0ZXJhYmxlSXRlcmF0b3I8VFsnVFZhbHVlJ10gfCBudWxsPiB7XG4gICAgcmV0dXJuIGl0ZXJhdG9yVmlzaXRvci52aXNpdCh0aGlzKTtcbn07XG5cbi8vIFBlcmY6IGJpbmQgYW5kIGFzc2lnbiB0aGUgb3BlcmF0b3IgVmlzaXRvciBtZXRob2RzIHRvIGVhY2ggb2YgdGhlIFZlY3RvciBzdWJjbGFzc2VzIGZvciBlYWNoIFR5cGVcbihPYmplY3Qua2V5cyhUeXBlKSBhcyBhbnlbXSlcbiAgICAuZmlsdGVyKChUVHlwZSkgPT4gVFR5cGUgIT09IFR5cGUuTk9ORSAmJiBUVHlwZSAhPT0gVHlwZVtUeXBlLk5PTkVdKVxuICAgIC5tYXAoKFQ6IGFueSkgPT4gVHlwZVtUXSBhcyBhbnkpLmZpbHRlcigoVDogYW55KTogVCBpcyBUeXBlID0+IHR5cGVvZiBUID09PSAnbnVtYmVyJylcbiAgICAuZm9yRWFjaCgoVFR5cGUpID0+IHtcbiAgICAgICAgbGV0IHR5cGVJZHM6IFR5cGVbXTtcbiAgICAgICAgc3dpdGNoIChUVHlwZSkge1xuICAgICAgICAgICAgY2FzZSBUeXBlWydJbnQnXTogICAgICAgdHlwZUlkcyA9IFtUeXBlWydJbnQ4J10sIFR5cGVbJ0ludDE2J10sIFR5cGVbJ0ludDMyJ10sIFR5cGVbJ0ludDY0J10sIFR5cGVbJ1VpbnQ4J10sIFR5cGVbJ1VpbnQxNiddLCBUeXBlWydVaW50MzInXSwgVHlwZVsnVWludDY0J11dOyBicmVhaztcbiAgICAgICAgICAgIGNhc2UgVHlwZVsnRmxvYXQnXTogICAgIHR5cGVJZHMgPSBbVHlwZVsnRmxvYXQxNiddLCBUeXBlWydGbG9hdDMyJ10sIFR5cGVbJ0Zsb2F0NjQnXV07IGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBUeXBlWydEYXRlJ106ICAgICAgdHlwZUlkcyA9IFtUeXBlWydEYXRlRGF5J10sIFR5cGVbJ0RhdGVNaWxsaXNlY29uZCddXTsgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFR5cGVbJ1RpbWUnXTogICAgICB0eXBlSWRzID0gW1R5cGVbJ1RpbWVTZWNvbmQnXSwgVHlwZVsnVGltZU1pbGxpc2Vjb25kJ10sIFR5cGVbJ1RpbWVNaWNyb3NlY29uZCddLCBUeXBlWydUaW1lTmFub3NlY29uZCddXTsgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFR5cGVbJ1RpbWVzdGFtcCddOiB0eXBlSWRzID0gW1R5cGVbJ1RpbWVzdGFtcFNlY29uZCddLCBUeXBlWydUaW1lc3RhbXBNaWxsaXNlY29uZCddLCBUeXBlWydUaW1lc3RhbXBNaWNyb3NlY29uZCddLCBUeXBlWydUaW1lc3RhbXBOYW5vc2Vjb25kJ11dOyBicmVhaztcbiAgICAgICAgICAgIGNhc2UgVHlwZVsnSW50ZXJ2YWwnXTogIHR5cGVJZHMgPSBbVHlwZVsnSW50ZXJ2YWxEYXlUaW1lJ10sIFR5cGVbJ0ludGVydmFsWWVhck1vbnRoJ11dOyBicmVhaztcbiAgICAgICAgICAgIGNhc2UgVHlwZVsnVW5pb24nXTogICAgIHR5cGVJZHMgPSBbVHlwZVsnRGVuc2VVbmlvbiddLCBUeXBlWydTcGFyc2VVbmlvbiddXTsgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OiAgICAgICAgICAgICAgICB0eXBlSWRzID0gW1RUeXBlXTsgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdHlwZUlkcy5mb3JFYWNoKChUVHlwZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgVmVjdG9yQ3RvciA9IGdldFZlY3RvckNvbnN0cnVjdG9yLnZpc2l0KFRUeXBlKTtcbiAgICAgICAgICAgIFZlY3RvckN0b3IucHJvdG90eXBlWydnZXQnXSA9IHBhcnRpYWwxKGdldFZpc2l0b3IuZ2V0VmlzaXRGbihUVHlwZSkpO1xuICAgICAgICAgICAgVmVjdG9yQ3Rvci5wcm90b3R5cGVbJ3NldCddID0gcGFydGlhbDIoc2V0VmlzaXRvci5nZXRWaXNpdEZuKFRUeXBlKSk7XG4gICAgICAgICAgICBWZWN0b3JDdG9yLnByb3RvdHlwZVsnaW5kZXhPZiddID0gcGFydGlhbDIoaW5kZXhPZlZpc2l0b3IuZ2V0VmlzaXRGbihUVHlwZSkpO1xuICAgICAgICAgICAgVmVjdG9yQ3Rvci5wcm90b3R5cGVbJ3RvQXJyYXknXSA9IHBhcnRpYWwwKHRvQXJyYXlWaXNpdG9yLmdldFZpc2l0Rm4oVFR5cGUpKTtcbiAgICAgICAgICAgIFZlY3RvckN0b3IucHJvdG90eXBlWydnZXRCeXRlV2lkdGgnXSA9IHBhcnRpYWwwKGJ5dGVXaWR0aFZpc2l0b3IuZ2V0VmlzaXRGbihUVHlwZSkpO1xuICAgICAgICAgICAgVmVjdG9yQ3Rvci5wcm90b3R5cGVbU3ltYm9sLml0ZXJhdG9yXSA9IHBhcnRpYWwwKGl0ZXJhdG9yVmlzaXRvci5nZXRWaXNpdEZuKFRUeXBlKSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG5mdW5jdGlvbiBwYXJ0aWFsMDxUPih2aXNpdDogKG5vZGU6IFQpID0+IGFueSkge1xuICAgIHJldHVybiBmdW5jdGlvbih0aGlzOiBUKSB7IHJldHVybiB2aXNpdCh0aGlzKTsgfTtcbn1cblxuZnVuY3Rpb24gcGFydGlhbDE8VD4odmlzaXQ6IChub2RlOiBULCBhOiBhbnkpID0+IGFueSkge1xuICAgIHJldHVybiBmdW5jdGlvbih0aGlzOiBULCBhOiBhbnkpIHsgcmV0dXJuIHZpc2l0KHRoaXMsIGEpOyB9O1xufVxuXG5mdW5jdGlvbiBwYXJ0aWFsMjxUPih2aXNpdDogKG5vZGU6IFQsIGE6IGFueSwgYjogYW55KSA9PiBhbnkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24odGhpczogVCwgYTogYW55LCBiOiBhbnkpIHsgcmV0dXJuIHZpc2l0KHRoaXMsIGEsIGIpOyB9O1xufVxuXG5mdW5jdGlvbiB3cmFwTnVsbGFibGVTZXQ8VCBleHRlbmRzIERhdGFUeXBlLCBWIGV4dGVuZHMgQmFzZVZlY3RvcjxUPiwgRiBleHRlbmRzIChpOiBudW1iZXIsIGE6IGFueSkgPT4gdm9pZD4oZm46IEYpOiAoLi4uYXJnczogUGFyYW1ldGVyczxGPikgPT4gdm9pZCB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHRoaXM6IFYsIGk6IG51bWJlciwgYTogYW55KSB7XG4gICAgICAgIGlmIChzZXRCb29sKHRoaXMubnVsbEJpdG1hcCwgdGhpcy5vZmZzZXQgKyBpLCBhICE9IG51bGwpKSB7XG4gICAgICAgICAgICBmbi5jYWxsKHRoaXMsIGksIGEpO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuLy8gQHRzLWlnbm9yZVxuZnVuY3Rpb24gYmluZEJhc2VWZWN0b3JEYXRhQWNjZXNzb3JzPFQgZXh0ZW5kcyBEYXRhVHlwZT4odGhpczogQmFzZVZlY3RvcjxUPiwgZGF0YTogRGF0YTxUPikge1xuICAgIGNvbnN0IHR5cGUgPSB0aGlzLnR5cGU7XG4gICAgdGhpc1snZ2V0J10gPSBnZXRWaXNpdG9yLmdldFZpc2l0Rm4odHlwZSkuYmluZCh0aGlzLCA8YW55PiB0aGlzIGFzIFY8VD4pO1xuICAgIHRoaXNbJ3NldCddID0gc2V0VmlzaXRvci5nZXRWaXNpdEZuKHR5cGUpLmJpbmQodGhpcywgPGFueT4gdGhpcyBhcyBWPFQ+KTtcbiAgICB0aGlzWydpbmRleE9mJ10gPSBpbmRleE9mVmlzaXRvci5nZXRWaXNpdEZuKHR5cGUpLmJpbmQodGhpcywgPGFueT4gdGhpcyBhcyBWPFQ+KTtcbiAgICB0aGlzWyd0b0FycmF5J10gPSB0b0FycmF5VmlzaXRvci5nZXRWaXNpdEZuKHR5cGUpLmJpbmQodGhpcywgPGFueT4gdGhpcyBhcyBWPFQ+KTtcbiAgICB0aGlzW1N5bWJvbC5pdGVyYXRvcl0gPSBpdGVyYXRvclZpc2l0b3IuZ2V0VmlzaXRGbih0eXBlKS5iaW5kKHRoaXMsIDxhbnk+IHRoaXMgYXMgVjxUPik7XG4gICAgaWYgKHRoaXMubnVsbENvdW50ID4gMCkge1xuICAgICAgICB0aGlzWydzZXQnXSA9IHdyYXBOdWxsYWJsZVNldCh0aGlzWydzZXQnXSk7XG4gICAgfVxuICAgIChWZWN0b3IucHJvdG90eXBlIGFzIGFueSkuYmluZERhdGFBY2Nlc3NvcnMuY2FsbCh0aGlzLCBkYXRhKTtcbn1cbiJdfQ==
