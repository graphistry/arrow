"use strict";
// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.  You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.
Object.defineProperty(exports, "__esModule", { value: true });
const vector_1 = require("../vector");
const chunked_1 = require("./chunked");
const vector_2 = require("../util/vector");
class BaseVector extends vector_1.Vector {
    constructor(data, children, stride) {
        super();
        this._stride = 1;
        this._numChildren = 0;
        this._children = children;
        this._numChildren = data.childData.length;
        this._bindDataAccessors(this._data = data);
        this._stride = Math.floor(Math.max(stride || 1, 1));
    }
    get data() { return this._data; }
    get stride() { return this._stride; }
    get numChildren() { return this._numChildren; }
    get type() { return this.data.type; }
    get typeId() { return this.data.typeId; }
    get length() { return this.data.length; }
    get offset() { return this.data.offset; }
    get nullCount() { return this.data.nullCount; }
    get VectorName() { return this.constructor.name; }
    get ArrayType() { return this.data.ArrayType; }
    get values() { return this.data.values; }
    get typeIds() { return this.data.typeIds; }
    get nullBitmap() { return this.data.nullBitmap; }
    get valueOffsets() { return this.data.valueOffsets; }
    get [Symbol.toStringTag]() { return `${this.VectorName}<${this.type[Symbol.toStringTag]}>`; }
    clone(data, children = this._children, stride = this.stride) {
        return vector_1.Vector.new(data, children, stride);
    }
    concat(...others) {
        return chunked_1.ChunkedVector.concat(this, ...others);
    }
    isValid(index) {
        if (this.nullCount > 0) {
            const idx = this.offset + index;
            const val = this.nullBitmap[idx >> 3];
            const mask = (val & (1 << (idx % 8)));
            return mask !== 0;
        }
        return true;
    }
    getChildAt(index) {
        return index < 0 || index >= this.numChildren ? null : ((this._children || (this._children = []))[index] ||
            (this._children[index] = vector_1.Vector.new(this.data.childData[index])));
    }
    // @ts-ignore
    toJSON() { }
    slice(begin, end) {
        // Adjust args similar to Array.prototype.slice. Normalize begin/end to
        // clamp between 0 and length, and wrap around on negative indices, e.g.
        // slice(-1, 5) or slice(5, -1)
        return vector_2.clampRange(this, begin, end, this.sliceInternal);
    }
    sliceInternal(vector, offset, length) {
        const stride = vector.stride;
        return vector.clone(vector.data.slice(offset * stride, (length - offset) * stride));
    }
    // @ts-ignore
    _bindDataAccessors(data) {
        // Implementation in src/vectors/index.ts due to circular dependency/packaging shenanigans
    }
}
exports.BaseVector = BaseVector;

//# sourceMappingURL=data:application/json;charset=utf8;base64,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QUFDO0lBRWhCLEtBQUssQ0FBQyxLQUFjLEVBQUUsR0FBWTtRQUNyQyx1RUFBdUU7UUFDdkUsd0VBQXdFO1FBQ3hFLCtCQUErQjtRQUMvQixPQUFPLG1CQUFVLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsSUFBSSxDQUFDLGFBQWEsQ0FBUSxDQUFDO0lBQ25FLENBQUM7SUFFUyxhQUFhLENBQUMsTUFBcUIsRUFBRSxNQUFjLEVBQUUsTUFBYztRQUN6RSxNQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDO1FBQzdCLE9BQU8sTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsTUFBTSxFQUFFLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFDeEYsQ0FBQztJQUVELGFBQWE7SUFDSCxrQkFBa0IsQ0FBQyxJQUFhO1FBQ3RDLDBGQUEwRjtJQUM5RixDQUFDO0NBQ0o7QUFoRkQsZ0NBZ0ZDIiwiZmlsZSI6InZlY3Rvci9iYXNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZVxuLy8gb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXG4vLyBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuLy8gcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZVxuLy8gdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxuLy8gXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4vLyB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4vL1xuLy8gICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbi8vXG4vLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4vLyBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxuLy8gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbi8vIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZVxuLy8gc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xuLy8gdW5kZXIgdGhlIExpY2Vuc2UuXG5cbmltcG9ydCB7IERhdGEgfSBmcm9tICcuLi9kYXRhJztcbmltcG9ydCB7IFZlY3RvciB9IGZyb20gJy4uL3ZlY3Rvcic7XG5pbXBvcnQgeyBEYXRhVHlwZSB9IGZyb20gJy4uL3R5cGUnO1xuaW1wb3J0IHsgQ2h1bmtlZFZlY3RvciB9IGZyb20gJy4vY2h1bmtlZCc7XG5pbXBvcnQgeyBjbGFtcFJhbmdlIH0gZnJvbSAnLi4vdXRpbC92ZWN0b3InO1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQmFzZVZlY3RvcjxUIGV4dGVuZHMgRGF0YVR5cGUgPSBhbnk+IGV4dGVuZHMgVmVjdG9yPFQ+IHtcblxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBwcm90ZWN0ZWQgX2RhdGE6IERhdGE8VD47XG4gICAgcHJvdGVjdGVkIF9zdHJpZGU6IG51bWJlciA9IDE7XG4gICAgcHJvdGVjdGVkIF9udW1DaGlsZHJlbjogbnVtYmVyID0gMDtcbiAgICBwcm90ZWN0ZWQgX2NoaWxkcmVuPzogVmVjdG9yW107XG5cbiAgICBjb25zdHJ1Y3RvcihkYXRhOiBEYXRhPFQ+LCBjaGlsZHJlbj86IFZlY3RvcltdLCBzdHJpZGU/OiBudW1iZXIpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5fY2hpbGRyZW4gPSBjaGlsZHJlbjtcbiAgICAgICAgdGhpcy5fbnVtQ2hpbGRyZW4gPSBkYXRhLmNoaWxkRGF0YS5sZW5ndGg7XG4gICAgICAgIHRoaXMuX2JpbmREYXRhQWNjZXNzb3JzKHRoaXMuX2RhdGEgPSBkYXRhKTtcbiAgICAgICAgdGhpcy5fc3RyaWRlID0gTWF0aC5mbG9vcihNYXRoLm1heChzdHJpZGUgfHwgMSwgMSkpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXQgZGF0YSgpIHsgcmV0dXJuIHRoaXMuX2RhdGE7IH1cbiAgICBwdWJsaWMgZ2V0IHN0cmlkZSgpIHsgcmV0dXJuIHRoaXMuX3N0cmlkZTsgfVxuICAgIHB1YmxpYyBnZXQgbnVtQ2hpbGRyZW4oKSB7IHJldHVybiB0aGlzLl9udW1DaGlsZHJlbjsgfVxuXG4gICAgcHVibGljIGdldCB0eXBlKCkgeyByZXR1cm4gdGhpcy5kYXRhLnR5cGU7IH1cbiAgICBwdWJsaWMgZ2V0IHR5cGVJZCgpIHsgcmV0dXJuIHRoaXMuZGF0YS50eXBlSWQgYXMgVFsnVFR5cGUnXTsgfVxuICAgIHB1YmxpYyBnZXQgbGVuZ3RoKCkgeyByZXR1cm4gdGhpcy5kYXRhLmxlbmd0aDsgfVxuICAgIHB1YmxpYyBnZXQgb2Zmc2V0KCkgeyByZXR1cm4gdGhpcy5kYXRhLm9mZnNldDsgfVxuICAgIHB1YmxpYyBnZXQgbnVsbENvdW50KCkgeyByZXR1cm4gdGhpcy5kYXRhLm51bGxDb3VudDsgfVxuICAgIHB1YmxpYyBnZXQgVmVjdG9yTmFtZSgpIHsgcmV0dXJuIHRoaXMuY29uc3RydWN0b3IubmFtZTsgfVxuXG4gICAgcHVibGljIGdldCBBcnJheVR5cGUoKTogVFsnQXJyYXlUeXBlJ10geyByZXR1cm4gdGhpcy5kYXRhLkFycmF5VHlwZTsgfVxuXG4gICAgcHVibGljIGdldCB2YWx1ZXMoKSB7IHJldHVybiB0aGlzLmRhdGEudmFsdWVzOyB9XG4gICAgcHVibGljIGdldCB0eXBlSWRzKCkgeyByZXR1cm4gdGhpcy5kYXRhLnR5cGVJZHM7IH1cbiAgICBwdWJsaWMgZ2V0IG51bGxCaXRtYXAoKSB7IHJldHVybiB0aGlzLmRhdGEubnVsbEJpdG1hcDsgfVxuICAgIHB1YmxpYyBnZXQgdmFsdWVPZmZzZXRzKCkgeyByZXR1cm4gdGhpcy5kYXRhLnZhbHVlT2Zmc2V0czsgfVxuXG4gICAgcHVibGljIGdldCBbU3ltYm9sLnRvU3RyaW5nVGFnXSgpIHsgcmV0dXJuIGAke3RoaXMuVmVjdG9yTmFtZX08JHt0aGlzLnR5cGVbU3ltYm9sLnRvU3RyaW5nVGFnXX0+YDsgfVxuXG4gICAgcHVibGljIGNsb25lPFIgZXh0ZW5kcyBEYXRhVHlwZSA9IFQ+KGRhdGE6IERhdGE8Uj4sIGNoaWxkcmVuID0gdGhpcy5fY2hpbGRyZW4sIHN0cmlkZSA9IHRoaXMuc3RyaWRlKSB7XG4gICAgICAgIHJldHVybiBWZWN0b3IubmV3PFI+KGRhdGEsIGNoaWxkcmVuLCBzdHJpZGUpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjb25jYXQoLi4ub3RoZXJzOiBWZWN0b3I8VD5bXSk6IFZlY3RvcjxUPiB7XG4gICAgICAgIHJldHVybiBDaHVua2VkVmVjdG9yLmNvbmNhdDxUPih0aGlzLCAuLi5vdGhlcnMpIGFzIFZlY3RvcjxUPjtcbiAgICB9XG5cbiAgICBwdWJsaWMgaXNWYWxpZChpbmRleDogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgICAgIGlmICh0aGlzLm51bGxDb3VudCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGlkeCA9IHRoaXMub2Zmc2V0ICsgaW5kZXg7XG4gICAgICAgICAgICBjb25zdCB2YWwgPSB0aGlzLm51bGxCaXRtYXBbaWR4ID4+IDNdO1xuICAgICAgICAgICAgY29uc3QgbWFzayA9ICh2YWwgJiAoMSA8PCAoaWR4ICUgOCkpKTtcbiAgICAgICAgICAgIHJldHVybiBtYXNrICE9PSAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRDaGlsZEF0PFIgZXh0ZW5kcyBEYXRhVHlwZSA9IGFueT4oaW5kZXg6IG51bWJlcik6IFZlY3RvcjxSPiB8IG51bGwge1xuICAgICAgICByZXR1cm4gaW5kZXggPCAwIHx8IGluZGV4ID49IHRoaXMubnVtQ2hpbGRyZW4gPyBudWxsIDogKFxuICAgICAgICAgICAgKHRoaXMuX2NoaWxkcmVuIHx8ICh0aGlzLl9jaGlsZHJlbiA9IFtdKSlbaW5kZXhdIHx8XG4gICAgICAgICAgICAodGhpcy5fY2hpbGRyZW5baW5kZXhdID0gVmVjdG9yLm5ldzxSPih0aGlzLmRhdGEuY2hpbGREYXRhW2luZGV4XSBhcyBEYXRhPFI+KSlcbiAgICAgICAgKSBhcyBWZWN0b3I8Uj47XG4gICAgfVxuXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHB1YmxpYyB0b0pTT04oKTogYW55IHt9XG5cbiAgICBwdWJsaWMgc2xpY2UoYmVnaW4/OiBudW1iZXIsIGVuZD86IG51bWJlcik6IHRoaXMge1xuICAgICAgICAvLyBBZGp1c3QgYXJncyBzaW1pbGFyIHRvIEFycmF5LnByb3RvdHlwZS5zbGljZS4gTm9ybWFsaXplIGJlZ2luL2VuZCB0b1xuICAgICAgICAvLyBjbGFtcCBiZXR3ZWVuIDAgYW5kIGxlbmd0aCwgYW5kIHdyYXAgYXJvdW5kIG9uIG5lZ2F0aXZlIGluZGljZXMsIGUuZy5cbiAgICAgICAgLy8gc2xpY2UoLTEsIDUpIG9yIHNsaWNlKDUsIC0xKVxuICAgICAgICByZXR1cm4gY2xhbXBSYW5nZSh0aGlzLCBiZWdpbiwgZW5kLCB0aGlzLnNsaWNlSW50ZXJuYWwpIGFzIGFueTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgc2xpY2VJbnRlcm5hbCh2ZWN0b3I6IEJhc2VWZWN0b3I8VD4sIG9mZnNldDogbnVtYmVyLCBsZW5ndGg6IG51bWJlcikge1xuICAgICAgICBjb25zdCBzdHJpZGUgPSB2ZWN0b3Iuc3RyaWRlO1xuICAgICAgICByZXR1cm4gdmVjdG9yLmNsb25lKHZlY3Rvci5kYXRhLnNsaWNlKG9mZnNldCAqIHN0cmlkZSwgKGxlbmd0aCAtIG9mZnNldCkgKiBzdHJpZGUpKTtcbiAgICB9XG5cbiAgICAvLyBAdHMtaWdub3JlXG4gICAgcHJvdGVjdGVkIF9iaW5kRGF0YUFjY2Vzc29ycyhkYXRhOiBEYXRhPFQ+KSB7XG4gICAgICAgIC8vIEltcGxlbWVudGF0aW9uIGluIHNyYy92ZWN0b3JzL2luZGV4LnRzIGR1ZSB0byBjaXJjdWxhciBkZXBlbmRlbmN5L3BhY2thZ2luZyBzaGVuYW5pZ2Fuc1xuICAgIH1cbn1cbiJdfQ==
