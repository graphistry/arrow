// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.  You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.
import { ChunkedData, FlatData, BoolData, DictionaryData } from './data';
import { TypeVisitor, VectorVisitor } from './visitor';
import { TimeUnit } from './type';
import { Precision, DateUnit, IntervalUnit, UnionMode } from './type';
export class Vector {
    constructor(data, view) {
        this.data = data;
        this.type = data.type;
        this.length = data.length;
        let nulls;
        if ((data instanceof ChunkedData) && !(view instanceof ChunkedView)) {
            this.view = new ChunkedView(data);
        }
        else if (!(view instanceof ValidityView) && (nulls = data.nullBitmap) && nulls.length > 0 && data.nullCount > 0) {
            this.view = new ValidityView(data, view);
        }
        else {
            this.view = view;
        }
    }
    static create(data) {
        return createVector(data);
    }
    static concat(source, ...others) {
        return others.reduce((a, b) => a ? a.concat(b) : b, source);
    }
    get nullCount() { return this.data.nullCount; }
    get nullBitmap() { return this.data.nullBitmap; }
    get [Symbol.toStringTag]() {
        return `Vector<${this.type[Symbol.toStringTag]}>`;
    }
    toJSON() { return this.toArray(); }
    clone(data, view = this.view.clone(data)) {
        return new this.constructor(data, view);
    }
    isValid(index) {
        return this.view.isValid(index);
    }
    get(index) {
        return this.view.get(index);
    }
    set(index, value) {
        return this.view.set(index, value);
    }
    toArray() {
        return this.view.toArray();
    }
    indexOf(value) {
        return this.view.indexOf(value);
    }
    [Symbol.iterator]() {
        return this.view[Symbol.iterator]();
    }
    concat(...others) {
        if ((others = others.filter(Boolean)).length === 0) {
            return this;
        }
        const { view } = this;
        const vecs = !(view instanceof ChunkedView)
            ? [this, ...others]
            : [...view.chunkVectors, ...others];
        const offsets = ChunkedData.computeOffsets(vecs);
        const chunksLength = offsets[offsets.length - 1];
        const chunkedData = new ChunkedData(this.type, chunksLength, vecs, 0, -1, offsets);
        return this.clone(chunkedData, new ChunkedView(chunkedData));
    }
    slice(begin, end) {
        let { length } = this;
        let size = this.view.size || 1;
        let total = length, from = (begin || 0) * size;
        let to = (typeof end === 'number' ? end : total) * size;
        if (to < 0) {
            to = total - (to * -1) % total;
        }
        if (from < 0) {
            from = total - (from * -1) % total;
        }
        if (to < from) {
            [from, to] = [to, from];
        }
        total = !isFinite(total = (to - from)) || total < 0 ? 0 : total;
        const slicedData = this.data.slice(from, Math.min(total, length));
        return this.clone(slicedData, this.view.clone(slicedData));
    }
    acceptTypeVisitor(visitor) {
        return TypeVisitor.visitTypeInline(visitor, this.type);
    }
    acceptVectorVisitor(visitor) {
        return VectorVisitor.visitTypeInline(visitor, this.type, this);
    }
}
export class FlatVector extends Vector {
    get values() { return this.data.values; }
    lows() { return this.asInt32(0, 2); }
    highs() { return this.asInt32(1, 2); }
    asInt32(offset = 0, stride = 2) {
        let data = this.data.clone(new Int32());
        if (offset > 0) {
            data = data.slice(offset, this.length - offset);
        }
        const int32s = new IntVector(data, new PrimitiveView(data, stride));
        int32s.length = this.length / stride | 0;
        return int32s;
    }
}
export class ListVectorBase extends Vector {
    get values() { return this.data.values; }
    get valueOffsets() { return this.data.valueOffsets; }
    getValueOffset(index) {
        return this.valueOffsets[index];
    }
    getValueLength(index) {
        return this.valueOffsets[index + 1] - this.valueOffsets[index];
    }
}
export class NestedVector extends Vector {
    getChildAt(index) {
        return this.view.getChildAt(index);
    }
    get childData() {
        let data;
        if ((data = this._childData)) {
            // Return the cached childData reference first
            return data;
        }
        else if (!((data = this.data) instanceof ChunkedData)) {
            // If data isn't chunked, cache and return NestedData's childData
            return this._childData = data.childData;
        }
        // Otherwise if the data is chunked, concatenate the childVectors from each chunk
        // to construct a single chunked Vector for each column. Then return the ChunkedData
        // instance from each unified chunked column as the childData of a chunked NestedVector
        const chunks = data.chunkVectors;
        return this._childData = chunks
            .reduce((cols, chunk) => chunk.childData
            .reduce((cols, _, i) => ((cols[i] || (cols[i] = [])).push(chunk.getChildAt(i))) && cols || cols, cols), [])
            .map((vecs) => Vector.concat(...vecs).data);
    }
}
import { Binary, Utf8, Bool, } from './type';
import { Uint8, Uint16, Uint32, Uint64, Int8, Int16, Int32, Int64, Float16, Float32, Float64 } from './type';
import { Struct, Map_ } from './type';
import { ChunkedView } from './vector/chunked';
import { ValidityView } from './vector/validity';
import { DictionaryView } from './vector/dictionary';
import { ListView, FixedSizeListView, BinaryView, Utf8View } from './vector/list';
import { UnionView, DenseUnionView, StructView, MapView } from './vector/nested';
import { FlatView, NullView, BoolView, PrimitiveView, FixedSizeView, Float16View } from './vector/flat';
import { DateDayView, DateMillisecondView, IntervalYearMonthView } from './vector/flat';
import { TimestampDayView, TimestampSecondView, TimestampMillisecondView, TimestampMicrosecondView, TimestampNanosecondView } from './vector/flat';
import { packBools } from './util/bit';
export class NullVector extends Vector {
    constructor(data, view = new NullView(data)) {
        super(data, view);
    }
}
export class BoolVector extends Vector {
    static from(data) {
        return new BoolVector(new BoolData(new Bool(), data.length, null, packBools(data)));
    }
    get values() { return this.data.values; }
    constructor(data, view = new BoolView(data)) {
        super(data, view);
    }
}
export class IntVector extends FlatVector {
    constructor(data, view = IntVector.defaultView(data)) {
        super(data, view);
    }
    static from(data, is64) {
        if (is64 === true) {
            return data instanceof Int32Array
                ? new IntVector(new FlatData(new Int64(), data.length, null, data))
                : new IntVector(new FlatData(new Uint64(), data.length, null, data));
        }
        switch (data.constructor) {
            case Int8Array: return new IntVector(new FlatData(new Int8(), data.length, null, data));
            case Int16Array: return new IntVector(new FlatData(new Int16(), data.length, null, data));
            case Int32Array: return new IntVector(new FlatData(new Int32(), data.length, null, data));
            case Uint8Array: return new IntVector(new FlatData(new Uint8(), data.length, null, data));
            case Uint16Array: return new IntVector(new FlatData(new Uint16(), data.length, null, data));
            case Uint32Array: return new IntVector(new FlatData(new Uint32(), data.length, null, data));
        }
        throw new TypeError('Unrecognized Int data');
    }
    static defaultView(data) {
        return data.type.bitWidth <= 32 ? new FlatView(data) : new FixedSizeView(data, (data.type.bitWidth / 32) | 0);
    }
}
export class FloatVector extends FlatVector {
    constructor(data, view = FloatVector.defaultView(data)) {
        super(data, view);
    }
    static from(data) {
        switch (data.constructor) {
            case Uint16Array: return new FloatVector(new FlatData(new Float16(), data.length, null, data));
            case Float32Array: return new FloatVector(new FlatData(new Float32(), data.length, null, data));
            case Float64Array: return new FloatVector(new FlatData(new Float64(), data.length, null, data));
        }
        throw new TypeError('Unrecognized Float data');
    }
    static defaultView(data) {
        return data.type.precision !== Precision.HALF ? new FlatView(data) : new Float16View(data);
    }
}
export class DateVector extends FlatVector {
    static defaultView(data) {
        return data.type.unit === DateUnit.DAY ? new DateDayView(data) : new DateMillisecondView(data, 2);
    }
    constructor(data, view = DateVector.defaultView(data)) {
        super(data, view);
    }
    lows() {
        return this.type.unit === DateUnit.DAY ? this.asInt32(0, 1) : this.asInt32(0, 2);
    }
    highs() {
        return this.type.unit === DateUnit.DAY ? this.asInt32(0, 1) : this.asInt32(1, 2);
    }
    asEpochMilliseconds() {
        let data = this.data.clone(new Int32());
        switch (this.type.unit) {
            case DateUnit.DAY: return new IntVector(data, new TimestampDayView(data, 1));
            case DateUnit.MILLISECOND: return new IntVector(data, new TimestampMillisecondView(data, 2));
        }
        throw new TypeError(`Unrecognized date unit "${DateUnit[this.type.unit]}"`);
    }
}
export class DecimalVector extends FlatVector {
    constructor(data, view = new FixedSizeView(data, 4)) {
        super(data, view);
    }
}
export class TimeVector extends FlatVector {
    static defaultView(data) {
        return data.type.bitWidth <= 32 ? new FlatView(data) : new FixedSizeView(data, (data.type.bitWidth / 32) | 0);
    }
    constructor(data, view = TimeVector.defaultView(data)) {
        super(data, view);
    }
    lows() {
        return this.type.bitWidth <= 32 ? this.asInt32(0, 1) : this.asInt32(0, 2);
    }
    highs() {
        return this.type.bitWidth <= 32 ? this.asInt32(0, 1) : this.asInt32(1, 2);
    }
}
export class TimestampVector extends FlatVector {
    constructor(data, view = new FixedSizeView(data, 2)) {
        super(data, view);
    }
    asEpochMilliseconds() {
        let data = this.data.clone(new Int32());
        switch (this.type.unit) {
            case TimeUnit.SECOND: return new IntVector(data, new TimestampSecondView(data, 1));
            case TimeUnit.MILLISECOND: return new IntVector(data, new TimestampMillisecondView(data, 2));
            case TimeUnit.MICROSECOND: return new IntVector(data, new TimestampMicrosecondView(data, 2));
            case TimeUnit.NANOSECOND: return new IntVector(data, new TimestampNanosecondView(data, 2));
        }
        throw new TypeError(`Unrecognized time unit "${TimeUnit[this.type.unit]}"`);
    }
}
export class IntervalVector extends FlatVector {
    static defaultView(data) {
        return data.type.unit === IntervalUnit.YEAR_MONTH ? new IntervalYearMonthView(data) : new FixedSizeView(data, 2);
    }
    constructor(data, view = IntervalVector.defaultView(data)) {
        super(data, view);
    }
    lows() {
        return this.type.unit === IntervalUnit.YEAR_MONTH ? this.asInt32(0, 1) : this.asInt32(0, 2);
    }
    highs() {
        return this.type.unit === IntervalUnit.YEAR_MONTH ? this.asInt32(0, 1) : this.asInt32(1, 2);
    }
}
export class BinaryVector extends ListVectorBase {
    constructor(data, view = new BinaryView(data)) {
        super(data, view);
    }
    asUtf8() {
        return new Utf8Vector(this.data.clone(new Utf8()));
    }
}
export class FixedSizeBinaryVector extends FlatVector {
    constructor(data, view = new FixedSizeView(data, data.type.byteWidth)) {
        super(data, view);
    }
}
export class Utf8Vector extends ListVectorBase {
    constructor(data, view = new Utf8View(data)) {
        super(data, view);
    }
    asBinary() {
        return new BinaryVector(this.data.clone(new Binary()));
    }
}
export class ListVector extends ListVectorBase {
    constructor(data, view = new ListView(data)) {
        super(data, view);
    }
    getChildAt(index) {
        return this.view.getChildAt(index);
    }
}
export class FixedSizeListVector extends Vector {
    constructor(data, view = new FixedSizeListView(data)) {
        super(data, view);
    }
    getChildAt(index) {
        return this.view.getChildAt(index);
    }
}
export class MapVector extends NestedVector {
    constructor(data, view = new MapView(data)) {
        super(data, view);
    }
    asStruct() {
        return new StructVector(this.data.clone(new Struct(this.type.children)));
    }
}
export class StructVector extends NestedVector {
    constructor(data, view = new StructView(data)) {
        super(data, view);
    }
    asMap(keysSorted = false) {
        return new MapVector(this.data.clone(new Map_(keysSorted, this.type.children)));
    }
}
export class UnionVector extends NestedVector {
    constructor(data, view = (data.type.mode === UnionMode.Sparse ? new UnionView(data) : new DenseUnionView(data))) {
        super(data, view);
    }
}
export class DictionaryVector extends Vector {
    constructor(data, view = new DictionaryView(data.dictionary, new IntVector(data.indices))) {
        super(data, view);
        if (view instanceof ValidityView) {
            view = view.view;
        }
        if (data instanceof DictionaryData && view instanceof DictionaryView) {
            this.indices = view.indices;
            this.dictionary = data.dictionary;
        }
        else if (data instanceof ChunkedData && view instanceof ChunkedView) {
            const chunks = view.chunkVectors;
            // Assume the last chunk's dictionary data is the most up-to-date,
            // including data from DictionaryBatches that were marked as deltas
            this.dictionary = chunks[chunks.length - 1].dictionary;
            this.indices = chunks.reduce((idxs, dict) => !idxs ? dict.indices : idxs.concat(dict.indices), null);
        }
        else {
            throw new TypeError(`Unrecognized DictionaryVector view`);
        }
    }
    getKey(index) { return this.indices.get(index); }
    getValue(key) { return this.dictionary.get(key); }
    reverseLookup(value) { return this.dictionary.indexOf(value); }
}
export const createVector = ((VectorLoader) => ((data) => TypeVisitor.visitTypeInline(new VectorLoader(data), data.type)))(class VectorLoader extends TypeVisitor {
    constructor(data) {
        super();
        this.data = data;
    }
    visitNull(_type) { return new NullVector(this.data); }
    visitInt(_type) { return new IntVector(this.data); }
    visitFloat(_type) { return new FloatVector(this.data); }
    visitBinary(_type) { return new BinaryVector(this.data); }
    visitUtf8(_type) { return new Utf8Vector(this.data); }
    visitBool(_type) { return new BoolVector(this.data); }
    visitDecimal(_type) { return new DecimalVector(this.data); }
    visitDate(_type) { return new DateVector(this.data); }
    visitTime(_type) { return new TimeVector(this.data); }
    visitTimestamp(_type) { return new TimestampVector(this.data); }
    visitInterval(_type) { return new IntervalVector(this.data); }
    visitList(_type) { return new ListVector(this.data); }
    visitStruct(_type) { return new StructVector(this.data); }
    visitUnion(_type) { return new UnionVector(this.data); }
    visitFixedSizeBinary(_type) { return new FixedSizeBinaryVector(this.data); }
    visitFixedSizeList(_type) { return new FixedSizeListVector(this.data); }
    visitMap(_type) { return new MapVector(this.data); }
    visitDictionary(_type) { return new DictionaryVector(this.data); }
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZlY3Rvci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSw2REFBNkQ7QUFDN0QsK0RBQStEO0FBQy9ELHdEQUF3RDtBQUN4RCw2REFBNkQ7QUFDN0Qsb0RBQW9EO0FBQ3BELDZEQUE2RDtBQUM3RCw2REFBNkQ7QUFDN0QsRUFBRTtBQUNGLCtDQUErQztBQUMvQyxFQUFFO0FBQ0YsNkRBQTZEO0FBQzdELDhEQUE4RDtBQUM5RCx5REFBeUQ7QUFDekQsNERBQTREO0FBQzVELDBEQUEwRDtBQUMxRCxxQkFBcUI7QUFFckIsT0FBTyxFQUFRLFdBQVcsRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUE0QixjQUFjLEVBQUUsTUFBTSxRQUFRLENBQUM7QUFDekcsT0FBTyxFQUFlLFdBQVcsRUFBRSxhQUFhLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDcEUsT0FBTyxFQUEwRCxRQUFRLEVBQUUsTUFBTSxRQUFRLENBQUM7QUFDMUYsT0FBTyxFQUFxQixTQUFTLEVBQUUsUUFBUSxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQUUsTUFBTSxRQUFRLENBQUM7QUFjekYsTUFBTSxPQUFPLE1BQU07SUFXZixZQUFZLElBQWEsRUFBRSxJQUFhO1FBQ3BDLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO1FBQ2pCLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQztRQUN0QixJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUM7UUFDMUIsSUFBSSxLQUFpQixDQUFDO1FBQ3RCLElBQUksQ0FBTyxJQUFJLFlBQVksV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksWUFBWSxXQUFXLENBQUMsRUFBRTtZQUN2RSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksV0FBVyxDQUFDLElBQVcsQ0FBUSxDQUFDO1NBQ25EO2FBQU0sSUFBSSxDQUFDLENBQUMsSUFBSSxZQUFZLFlBQVksQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxVQUFXLENBQUMsSUFBSSxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsSUFBSSxJQUFJLENBQUMsU0FBUyxHQUFHLENBQUMsRUFBRTtZQUNoSCxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksWUFBWSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztTQUM1QzthQUFNO1lBQ0gsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7U0FDcEI7SUFDTCxDQUFDO0lBdEJNLE1BQU0sQ0FBQyxNQUFNLENBQXFCLElBQWE7UUFDbEQsT0FBTyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDOUIsQ0FBQztJQUNNLE1BQU0sQ0FBQyxNQUFNLENBQXFCLE1BQXlCLEVBQUUsR0FBRyxNQUFtQjtRQUN0RixPQUFPLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxNQUFPLENBQUMsQ0FBQztJQUNqRSxDQUFDO0lBbUJELElBQVcsU0FBUyxLQUFLLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO0lBQ3RELElBQVcsVUFBVSxLQUFLLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO0lBQ3hELElBQVcsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDO1FBQzNCLE9BQU8sVUFBVSxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDO0lBQ3RELENBQUM7SUFDTSxNQUFNLEtBQVUsT0FBTyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ3hDLEtBQUssQ0FBYyxJQUFhLEVBQUUsT0FBZ0IsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFRO1FBQ2pGLE9BQU8sSUFBSyxJQUFJLENBQUMsV0FBbUIsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDckQsQ0FBQztJQUNNLE9BQU8sQ0FBQyxLQUFhO1FBQ3hCLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDcEMsQ0FBQztJQUNNLEdBQUcsQ0FBQyxLQUFhO1FBQ3BCLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDaEMsQ0FBQztJQUNNLEdBQUcsQ0FBQyxLQUFhLEVBQUUsS0FBa0I7UUFDeEMsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDdkMsQ0FBQztJQUNNLE9BQU87UUFDVixPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7SUFDL0IsQ0FBQztJQUNNLE9BQU8sQ0FBQyxLQUFrQjtRQUM3QixPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3BDLENBQUM7SUFDTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUM7UUFDcEIsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDO0lBQ3hDLENBQUM7SUFDTSxNQUFNLENBQUMsR0FBRyxNQUFtQjtRQUNoQyxJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1lBQ2hELE9BQU8sSUFBSSxDQUFDO1NBQ2Y7UUFDRCxNQUFNLEVBQUUsSUFBSSxFQUFFLEdBQUcsSUFBSSxDQUFDO1FBQ3RCLE1BQU0sSUFBSSxHQUFHLENBQUMsQ0FBQyxJQUFJLFlBQVksV0FBVyxDQUFDO1lBQ3ZDLENBQUMsQ0FBQyxDQUFDLElBQUksRUFBRSxHQUFHLE1BQU0sQ0FBQztZQUNuQixDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxZQUFZLEVBQUUsR0FBRyxNQUFNLENBQUMsQ0FBQztRQUN4QyxNQUFNLE9BQU8sR0FBRyxXQUFXLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2pELE1BQU0sWUFBWSxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ2pELE1BQU0sV0FBVyxHQUFHLElBQUksV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsWUFBWSxFQUFFLElBQUksRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDbkYsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsRUFBRSxJQUFJLFdBQVcsQ0FBQyxXQUFXLENBQUMsQ0FBUyxDQUFDO0lBQ3pFLENBQUM7SUFDTSxLQUFLLENBQUMsS0FBYyxFQUFFLEdBQVk7UUFDckMsSUFBSSxFQUFFLE1BQU0sRUFBRSxHQUFHLElBQUksQ0FBQztRQUN0QixJQUFJLElBQUksR0FBSSxJQUFJLENBQUMsSUFBWSxDQUFDLElBQUksSUFBSSxDQUFDLENBQUM7UUFDeEMsSUFBSSxLQUFLLEdBQUcsTUFBTSxFQUFFLElBQUksR0FBRyxDQUFDLEtBQUssSUFBSSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUM7UUFDL0MsSUFBSSxFQUFFLEdBQUcsQ0FBQyxPQUFPLEdBQUcsS0FBSyxRQUFRLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsSUFBSSxDQUFDO1FBQ3hELElBQUksRUFBRSxHQUFHLENBQUMsRUFBRTtZQUFFLEVBQUUsR0FBRyxLQUFLLEdBQUcsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUM7U0FBRTtRQUMvQyxJQUFJLElBQUksR0FBRyxDQUFDLEVBQUU7WUFBRSxJQUFJLEdBQUcsS0FBSyxHQUFHLENBQUMsSUFBSSxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDO1NBQUU7UUFDckQsSUFBSSxFQUFFLEdBQUcsSUFBSSxFQUFFO1lBQUUsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDLENBQUM7U0FBRTtRQUMzQyxLQUFLLEdBQUcsQ0FBQyxRQUFRLENBQUMsS0FBSyxHQUFHLENBQUMsRUFBRSxHQUFHLElBQUksQ0FBQyxDQUFDLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUM7UUFDaEUsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUM7UUFDbEUsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBUyxDQUFDO0lBQ3ZFLENBQUM7SUFFTSxpQkFBaUIsQ0FBQyxPQUFvQjtRQUN6QyxPQUFPLFdBQVcsQ0FBQyxlQUFlLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUMzRCxDQUFDO0lBQ00sbUJBQW1CLENBQUMsT0FBc0I7UUFDN0MsT0FBTyxhQUFhLENBQUMsZUFBZSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ25FLENBQUM7Q0FDSjtBQUVELE1BQU0sT0FBZ0IsVUFBK0IsU0FBUSxNQUFTO0lBQ2xFLElBQVcsTUFBTSxLQUFLLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO0lBQ3pDLElBQUksS0FBdUIsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDdkQsS0FBSyxLQUF1QixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN4RCxPQUFPLENBQUMsU0FBaUIsQ0FBQyxFQUFFLFNBQWlCLENBQUM7UUFDakQsSUFBSSxJQUFJLEdBQUksSUFBSSxDQUFDLElBQXNCLENBQUMsS0FBSyxDQUFDLElBQUksS0FBSyxFQUFFLENBQUMsQ0FBQztRQUMzRCxJQUFJLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDWixJQUFJLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUMsQ0FBQztTQUNuRDtRQUNELE1BQU0sTUFBTSxHQUFHLElBQUksU0FBUyxDQUFDLElBQUksRUFBRSxJQUFJLGFBQWEsQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztRQUNwRSxNQUFNLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxHQUFHLENBQUMsQ0FBQztRQUN6QyxPQUFPLE1BQU0sQ0FBQztJQUNsQixDQUFDO0NBQ0o7QUFFRCxNQUFNLE9BQWdCLGNBQW9ELFNBQVEsTUFBUztJQUN2RixJQUFXLE1BQU0sS0FBSyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUNoRCxJQUFXLFlBQVksS0FBSyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQztJQUNyRCxjQUFjLENBQUMsS0FBYTtRQUMvQixPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDcEMsQ0FBQztJQUNNLGNBQWMsQ0FBQyxLQUFhO1FBQy9CLE9BQU8sSUFBSSxDQUFDLFlBQVksQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNuRSxDQUFDO0NBQ0o7QUFFRCxNQUFNLE9BQWdCLFlBQW1DLFNBQVEsTUFBUztJQUsvRCxVQUFVLENBQWdDLEtBQWE7UUFDMUQsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBSSxLQUFLLENBQUMsQ0FBQztJQUMxQyxDQUFDO0lBQ0QsSUFBVyxTQUFTO1FBQ2hCLElBQUksSUFBMkIsQ0FBQztRQUNoQyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsRUFBRTtZQUMxQiw4Q0FBOEM7WUFDOUMsT0FBTyxJQUFtQixDQUFDO1NBQzlCO2FBQU0sSUFBSSxDQUFDLENBQU8sQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxZQUFZLFdBQVcsQ0FBQyxFQUFFO1lBQzNELGlFQUFpRTtZQUNqRSxPQUFPLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQztTQUMzQztRQUNELGlGQUFpRjtRQUNqRixvRkFBb0Y7UUFDcEYsdUZBQXVGO1FBQ3ZGLE1BQU0sTUFBTSxHQUFLLElBQThCLENBQUMsWUFBa0MsQ0FBQztRQUNuRixPQUFPLElBQUksQ0FBQyxVQUFVLEdBQUcsTUFBTTthQUMxQixNQUFNLENBQXlCLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLFNBQVM7YUFDL0QsTUFBTSxDQUF5QixDQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUM1QyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQ3hELElBQUksSUFBSSxJQUFJLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFtQixDQUFDO2FBQ2pELEdBQUcsQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBSSxHQUFHLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25ELENBQUM7Q0FDSjtBQUVELE9BQU8sRUFBUSxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksR0FBRyxNQUFNLFFBQVEsQ0FBQztBQUVuRCxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLFFBQVEsQ0FBQztBQUM3RyxPQUFPLEVBQUUsTUFBTSxFQUFrRSxJQUFJLEVBQWMsTUFBTSxRQUFRLENBQUM7QUFFbEgsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQy9DLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNqRCxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDckQsT0FBTyxFQUFFLFFBQVEsRUFBRSxpQkFBaUIsRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ2xGLE9BQU8sRUFBRSxTQUFTLEVBQUUsY0FBYyxFQUFjLFVBQVUsRUFBRSxPQUFPLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUM3RixPQUFPLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsYUFBYSxFQUFFLGFBQWEsRUFBRSxXQUFXLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDeEcsT0FBTyxFQUFFLFdBQVcsRUFBRSxtQkFBbUIsRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN4RixPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsbUJBQW1CLEVBQUUsd0JBQXdCLEVBQUUsd0JBQXdCLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDbkosT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLFlBQVksQ0FBQztBQUV2QyxNQUFNLE9BQU8sVUFBVyxTQUFRLE1BQVk7SUFDeEMsWUFBWSxJQUFnQixFQUFFLE9BQW1CLElBQUksUUFBUSxDQUFDLElBQUksQ0FBQztRQUMvRCxLQUFLLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3RCLENBQUM7Q0FDSjtBQUVELE1BQU0sT0FBTyxVQUFXLFNBQVEsTUFBWTtJQUNqQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQWdDO1FBQy9DLE9BQU8sSUFBSSxVQUFVLENBQUMsSUFBSSxRQUFRLENBQUMsSUFBSSxJQUFJLEVBQUUsRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxTQUFTLENBQUMsSUFBSSxDQUFDLENBQWUsQ0FBQyxDQUFDO0lBQ3RHLENBQUM7SUFDRCxJQUFXLE1BQU0sS0FBSyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUNoRCxZQUFZLElBQWdCLEVBQUUsT0FBbUIsSUFBSSxRQUFRLENBQUMsSUFBSSxDQUFDO1FBQy9ELEtBQUssQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDdEIsQ0FBQztDQUNKO0FBRUQsTUFBTSxPQUFPLFNBQW9DLFNBQVEsVUFBYTtJQTRCbEUsWUFBWSxJQUFhLEVBQUUsT0FBZ0IsU0FBUyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUM7UUFDbEUsS0FBSyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztJQUN0QixDQUFDO0lBckJNLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBUyxFQUFFLElBQWM7UUFDeEMsSUFBSSxJQUFJLEtBQUssSUFBSSxFQUFFO1lBQ2YsT0FBTyxJQUFJLFlBQVksVUFBVTtnQkFDN0IsQ0FBQyxDQUFDLElBQUksU0FBUyxDQUFDLElBQUksUUFBUSxDQUFDLElBQUksS0FBSyxFQUFFLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7Z0JBQ25FLENBQUMsQ0FBQyxJQUFJLFNBQVMsQ0FBQyxJQUFJLFFBQVEsQ0FBQyxJQUFJLE1BQU0sRUFBRSxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7U0FDNUU7UUFDRCxRQUFRLElBQUksQ0FBQyxXQUFXLEVBQUU7WUFDdEIsS0FBSyxTQUFTLENBQUMsQ0FBQyxPQUFPLElBQUksU0FBUyxDQUFDLElBQUksUUFBUSxDQUFDLElBQUksSUFBSSxFQUFFLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQztZQUN4RixLQUFLLFVBQVUsQ0FBQyxDQUFDLE9BQU8sSUFBSSxTQUFTLENBQUMsSUFBSSxRQUFRLENBQUMsSUFBSSxLQUFLLEVBQUUsRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDO1lBQzFGLEtBQUssVUFBVSxDQUFDLENBQUMsT0FBTyxJQUFJLFNBQVMsQ0FBQyxJQUFJLFFBQVEsQ0FBQyxJQUFJLEtBQUssRUFBRSxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDMUYsS0FBSyxVQUFVLENBQUMsQ0FBQyxPQUFPLElBQUksU0FBUyxDQUFDLElBQUksUUFBUSxDQUFDLElBQUksS0FBSyxFQUFFLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQztZQUMxRixLQUFLLFdBQVcsQ0FBQyxDQUFDLE9BQU8sSUFBSSxTQUFTLENBQUMsSUFBSSxRQUFRLENBQUMsSUFBSSxNQUFNLEVBQUUsRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDO1lBQzVGLEtBQUssV0FBVyxDQUFDLENBQUMsT0FBTyxJQUFJLFNBQVMsQ0FBQyxJQUFJLFFBQVEsQ0FBQyxJQUFJLE1BQU0sRUFBRSxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7U0FDL0Y7UUFDRCxNQUFNLElBQUksU0FBUyxDQUFDLHVCQUF1QixDQUFDLENBQUM7SUFDakQsQ0FBQztJQUNELE1BQU0sQ0FBQyxXQUFXLENBQWdCLElBQWE7UUFDM0MsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLGFBQWEsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUNsSCxDQUFDO0NBSUo7QUFFRCxNQUFNLE9BQU8sV0FBMEMsU0FBUSxVQUFhO0lBZXhFLFlBQVksSUFBYSxFQUFFLE9BQWdCLFdBQVcsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDO1FBQ3BFLEtBQUssQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDdEIsQ0FBQztJQWJNLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBUztRQUN4QixRQUFRLElBQUksQ0FBQyxXQUFXLEVBQUU7WUFDdEIsS0FBSyxXQUFXLENBQUMsQ0FBQyxPQUFPLElBQUksV0FBVyxDQUFDLElBQUksUUFBUSxDQUFDLElBQUksT0FBTyxFQUFFLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQztZQUMvRixLQUFLLFlBQVksQ0FBQyxDQUFDLE9BQU8sSUFBSSxXQUFXLENBQUMsSUFBSSxRQUFRLENBQUMsSUFBSSxPQUFPLEVBQUUsRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDO1lBQ2hHLEtBQUssWUFBWSxDQUFDLENBQUMsT0FBTyxJQUFJLFdBQVcsQ0FBQyxJQUFJLFFBQVEsQ0FBQyxJQUFJLE9BQU8sRUFBRSxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7U0FDbkc7UUFDRCxNQUFNLElBQUksU0FBUyxDQUFDLHlCQUF5QixDQUFDLENBQUM7SUFDbkQsQ0FBQztJQUNELE1BQU0sQ0FBQyxXQUFXLENBQWtCLElBQWE7UUFDN0MsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsS0FBSyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxXQUFXLENBQUMsSUFBcUIsQ0FBQyxDQUFDO0lBQ2hILENBQUM7Q0FJSjtBQUVELE1BQU0sT0FBTyxVQUFXLFNBQVEsVUFBaUI7SUFDN0MsTUFBTSxDQUFDLFdBQVcsQ0FBa0IsSUFBYTtRQUM3QyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxLQUFLLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLG1CQUFtQixDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQztJQUN0RyxDQUFDO0lBQ0QsWUFBWSxJQUFpQixFQUFFLE9BQW9CLFVBQVUsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDO1FBQzNFLEtBQUssQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDdEIsQ0FBQztJQUNNLElBQUk7UUFDUCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxLQUFLLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUNyRixDQUFDO0lBQ00sS0FBSztRQUNSLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEtBQUssUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ3JGLENBQUM7SUFDTSxtQkFBbUI7UUFDdEIsSUFBSSxJQUFJLEdBQUksSUFBSSxDQUFDLElBQXNCLENBQUMsS0FBSyxDQUFDLElBQUksS0FBSyxFQUFFLENBQUMsQ0FBQztRQUMzRCxRQUFRLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFO1lBQ3BCLEtBQUssUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDLE9BQU8sSUFBSSxTQUFTLENBQUMsSUFBSSxFQUFFLElBQUksZ0JBQWdCLENBQUMsSUFBVyxFQUFFLENBQUMsQ0FBUSxDQUFDLENBQUM7WUFDM0YsS0FBSyxRQUFRLENBQUMsV0FBVyxDQUFDLENBQUMsT0FBTyxJQUFJLFNBQVMsQ0FBQyxJQUFJLEVBQUUsSUFBSSx3QkFBd0IsQ0FBQyxJQUFXLEVBQUUsQ0FBQyxDQUFRLENBQUMsQ0FBQztTQUM5RztRQUNELE1BQU0sSUFBSSxTQUFTLENBQUMsMkJBQTJCLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNoRixDQUFDO0NBQ0o7QUFFRCxNQUFNLE9BQU8sYUFBYyxTQUFRLFVBQW1CO0lBQ2xELFlBQVksSUFBbUIsRUFBRSxPQUFzQixJQUFJLGFBQWEsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO1FBQzdFLEtBQUssQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDdEIsQ0FBQztDQUNKO0FBRUQsTUFBTSxPQUFPLFVBQVcsU0FBUSxVQUFnQjtJQUM1QyxNQUFNLENBQUMsV0FBVyxDQUFpQixJQUFhO1FBQzVDLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxhQUFhLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDbEgsQ0FBQztJQUNELFlBQVksSUFBZ0IsRUFBRSxPQUFtQixVQUFVLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQztRQUN6RSxLQUFLLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3RCLENBQUM7SUFDTSxJQUFJO1FBQ1AsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUM5RSxDQUFDO0lBQ00sS0FBSztRQUNSLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDOUUsQ0FBQztDQUNKO0FBRUQsTUFBTSxPQUFPLGVBQWdCLFNBQVEsVUFBcUI7SUFDdEQsWUFBWSxJQUFxQixFQUFFLE9BQXdCLElBQUksYUFBYSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7UUFDakYsS0FBSyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztJQUN0QixDQUFDO0lBQ00sbUJBQW1CO1FBQ3RCLElBQUksSUFBSSxHQUFJLElBQUksQ0FBQyxJQUFzQixDQUFDLEtBQUssQ0FBQyxJQUFJLEtBQUssRUFBRSxDQUFDLENBQUM7UUFDM0QsUUFBUSxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRTtZQUNwQixLQUFLLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLElBQUksU0FBUyxDQUFDLElBQUksRUFBRSxJQUFJLG1CQUFtQixDQUFDLElBQVcsRUFBRSxDQUFDLENBQVEsQ0FBQyxDQUFDO1lBQ2pHLEtBQUssUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDLE9BQU8sSUFBSSxTQUFTLENBQUMsSUFBSSxFQUFFLElBQUksd0JBQXdCLENBQUMsSUFBVyxFQUFFLENBQUMsQ0FBUSxDQUFDLENBQUM7WUFDM0csS0FBSyxRQUFRLENBQUMsV0FBVyxDQUFDLENBQUMsT0FBTyxJQUFJLFNBQVMsQ0FBQyxJQUFJLEVBQUUsSUFBSSx3QkFBd0IsQ0FBQyxJQUFXLEVBQUUsQ0FBQyxDQUFRLENBQUMsQ0FBQztZQUMzRyxLQUFLLFFBQVEsQ0FBQyxVQUFVLENBQUMsQ0FBQyxPQUFPLElBQUksU0FBUyxDQUFDLElBQUksRUFBRSxJQUFJLHVCQUF1QixDQUFDLElBQVcsRUFBRSxDQUFDLENBQVEsQ0FBQyxDQUFDO1NBQzVHO1FBQ0QsTUFBTSxJQUFJLFNBQVMsQ0FBQywyQkFBMkIsUUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2hGLENBQUM7Q0FDSjtBQUVELE1BQU0sT0FBTyxjQUFlLFNBQVEsVUFBb0I7SUFDcEQsTUFBTSxDQUFDLFdBQVcsQ0FBcUIsSUFBYTtRQUNoRCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxLQUFLLFlBQVksQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLElBQUkscUJBQXFCLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksYUFBYSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQztJQUNySCxDQUFDO0lBQ0QsWUFBWSxJQUFvQixFQUFFLE9BQXVCLGNBQWMsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDO1FBQ3JGLEtBQUssQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDdEIsQ0FBQztJQUNNLElBQUk7UUFDUCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxLQUFLLFlBQVksQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUNoRyxDQUFDO0lBQ00sS0FBSztRQUNSLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEtBQUssWUFBWSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ2hHLENBQUM7Q0FDSjtBQUVELE1BQU0sT0FBTyxZQUFhLFNBQVEsY0FBc0I7SUFDcEQsWUFBWSxJQUFrQixFQUFFLE9BQXFCLElBQUksVUFBVSxDQUFDLElBQUksQ0FBQztRQUNyRSxLQUFLLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3RCLENBQUM7SUFDTSxNQUFNO1FBQ1QsT0FBTyxJQUFJLFVBQVUsQ0FBRSxJQUFJLENBQUMsSUFBMEIsQ0FBQyxLQUFLLENBQUMsSUFBSSxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDOUUsQ0FBQztDQUNKO0FBRUQsTUFBTSxPQUFPLHFCQUFzQixTQUFRLFVBQTJCO0lBQ2xFLFlBQVksSUFBMkIsRUFBRSxPQUE4QixJQUFJLGFBQWEsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUM7UUFDL0csS0FBSyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztJQUN0QixDQUFDO0NBQ0o7QUFFRCxNQUFNLE9BQU8sVUFBVyxTQUFRLGNBQW9CO0lBQ2hELFlBQVksSUFBZ0IsRUFBRSxPQUFtQixJQUFJLFFBQVEsQ0FBQyxJQUFJLENBQUM7UUFDL0QsS0FBSyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztJQUN0QixDQUFDO0lBQ00sUUFBUTtRQUNYLE9BQU8sSUFBSSxZQUFZLENBQUUsSUFBSSxDQUFDLElBQTBCLENBQUMsS0FBSyxDQUFDLElBQUksTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ2xGLENBQUM7Q0FDSjtBQUVELE1BQU0sT0FBTyxVQUEwQyxTQUFRLGNBQXVCO0lBR2xGLFlBQVksSUFBbUIsRUFBRSxPQUFvQixJQUFJLFFBQVEsQ0FBSSxJQUFXLENBQUM7UUFDN0UsS0FBSyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztJQUN0QixDQUFDO0lBQ00sVUFBVSxDQUFDLEtBQWE7UUFDM0IsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBSSxLQUFLLENBQUMsQ0FBQztJQUMxQyxDQUFDO0NBQ0o7QUFFRCxNQUFNLE9BQU8sbUJBQW1ELFNBQVEsTUFBd0I7SUFHNUYsWUFBWSxJQUE0QixFQUFFLE9BQStCLElBQUksaUJBQWlCLENBQUMsSUFBSSxDQUFDO1FBQ2hHLEtBQUssQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDdEIsQ0FBQztJQUNNLFVBQVUsQ0FBQyxLQUFhO1FBQzNCLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUksS0FBSyxDQUFDLENBQUM7SUFDMUMsQ0FBQztDQUNKO0FBRUQsTUFBTSxPQUFPLFNBQVUsU0FBUSxZQUFrQjtJQUM3QyxZQUFZLElBQWdCLEVBQUUsT0FBbUIsSUFBSSxPQUFPLENBQUMsSUFBSSxDQUFDO1FBQzlELEtBQUssQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDdEIsQ0FBQztJQUNNLFFBQVE7UUFDWCxPQUFPLElBQUksWUFBWSxDQUFFLElBQUksQ0FBQyxJQUF3QixDQUFDLEtBQUssQ0FBQyxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNsRyxDQUFDO0NBQ0o7QUFFRCxNQUFNLE9BQU8sWUFBYSxTQUFRLFlBQW9CO0lBQ2xELFlBQVksSUFBa0IsRUFBRSxPQUFxQixJQUFJLFVBQVUsQ0FBQyxJQUFJLENBQUM7UUFDckUsS0FBSyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztJQUN0QixDQUFDO0lBQ00sS0FBSyxDQUFDLGFBQXNCLEtBQUs7UUFDcEMsT0FBTyxJQUFJLFNBQVMsQ0FBRSxJQUFJLENBQUMsSUFBd0IsQ0FBQyxLQUFLLENBQUMsSUFBSSxJQUFJLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3pHLENBQUM7Q0FDSjtBQUVELE1BQU0sT0FBTyxXQUF3RCxTQUFRLFlBQWU7SUFDeEYsWUFBWSxJQUFhLEVBQUUsT0FBc0IsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLFNBQVMsQ0FBYyxJQUF5QixDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksY0FBYyxDQUFDLElBQXdCLENBQUMsQ0FBQztRQUN6TCxLQUFLLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3RCLENBQUM7Q0FDSjtBQUVELE1BQU0sT0FBTyxnQkFBZ0QsU0FBUSxNQUFxQjtJQUt0RixZQUFZLElBQXlCLEVBQUUsT0FBNEIsSUFBSSxjQUFjLENBQUksSUFBSSxDQUFDLFVBQVUsRUFBRSxJQUFJLFNBQVMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDbEksS0FBSyxDQUFDLElBQWlCLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDL0IsSUFBSSxJQUFJLFlBQVksWUFBWSxFQUFFO1lBQzlCLElBQUksR0FBSSxJQUFZLENBQUMsSUFBSSxDQUFDO1NBQzdCO1FBQ0QsSUFBSSxJQUFJLFlBQVksY0FBYyxJQUFJLElBQUksWUFBWSxjQUFjLEVBQUU7WUFDbEUsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDO1lBQzVCLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQztTQUNyQzthQUFNLElBQUksSUFBSSxZQUFZLFdBQVcsSUFBSSxJQUFJLFlBQVksV0FBVyxFQUFFO1lBQ25FLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxZQUFxQyxDQUFDO1lBQzFELGtFQUFrRTtZQUNsRSxtRUFBbUU7WUFDbkUsSUFBSSxDQUFDLFVBQVUsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUM7WUFDdkQsSUFBSSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUN4QixDQUFDLElBQXdCLEVBQUUsSUFBeUIsRUFBRSxFQUFFLENBQ3BELENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBUSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFRLENBQUMsRUFDdEQsSUFBSSxDQUNOLENBQUM7U0FDTjthQUFNO1lBQ0gsTUFBTSxJQUFJLFNBQVMsQ0FBQyxvQ0FBb0MsQ0FBQyxDQUFDO1NBQzdEO0lBQ0wsQ0FBQztJQUNNLE1BQU0sQ0FBQyxLQUFhLElBQUksT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDekQsUUFBUSxDQUFDLEdBQVcsSUFBSSxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUMxRCxhQUFhLENBQUMsS0FBUSxJQUFJLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0NBQzVFO0FBRUQsTUFBTSxDQUFDLE1BQU0sWUFBWSxHQUFHLENBQUMsQ0FBQyxZQUFvRSxFQUFFLEVBQUUsQ0FBQyxDQUNuRyxDQUFxQixJQUFhLEVBQUUsRUFBRSxDQUFDLFdBQVcsQ0FBQyxlQUFlLENBQUMsSUFBSSxZQUFZLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBYyxDQUNySCxDQUFDLENBQUMsTUFBTSxZQUFpQyxTQUFRLFdBQVc7SUFDekQsWUFBb0IsSUFBYTtRQUFJLEtBQUssRUFBRSxDQUFDO1FBQXpCLFNBQUksR0FBSixJQUFJLENBQVM7SUFBYSxDQUFDO0lBQy9DLFNBQVMsQ0FBWSxLQUFXLElBQWUsT0FBTyxJQUFJLFVBQVUsQ0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBWSxDQUFDO0lBQ25HLFFBQVEsQ0FBYSxLQUFVLElBQWdCLE9BQU8sSUFBSSxTQUFTLENBQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQWEsQ0FBQztJQUNuRyxVQUFVLENBQVcsS0FBWSxJQUFjLE9BQU8sSUFBSSxXQUFXLENBQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQVcsQ0FBQztJQUNuRyxXQUFXLENBQVUsS0FBYSxJQUFhLE9BQU8sSUFBSSxZQUFZLENBQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQVUsQ0FBQztJQUNuRyxTQUFTLENBQVksS0FBVyxJQUFlLE9BQU8sSUFBSSxVQUFVLENBQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQVksQ0FBQztJQUNuRyxTQUFTLENBQVksS0FBVyxJQUFlLE9BQU8sSUFBSSxVQUFVLENBQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQVksQ0FBQztJQUNuRyxZQUFZLENBQVMsS0FBYyxJQUFZLE9BQU8sSUFBSSxhQUFhLENBQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQVMsQ0FBQztJQUNuRyxTQUFTLENBQVksS0FBWSxJQUFjLE9BQU8sSUFBSSxVQUFVLENBQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQVksQ0FBQztJQUNuRyxTQUFTLENBQVksS0FBVyxJQUFlLE9BQU8sSUFBSSxVQUFVLENBQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQVksQ0FBQztJQUNuRyxjQUFjLENBQU8sS0FBZ0IsSUFBVSxPQUFPLElBQUksZUFBZSxDQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFPLENBQUM7SUFDbkcsYUFBYSxDQUFRLEtBQWUsSUFBVyxPQUFPLElBQUksY0FBYyxDQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFRLENBQUM7SUFDbkcsU0FBUyxDQUFZLEtBQVcsSUFBZSxPQUFPLElBQUksVUFBVSxDQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFZLENBQUM7SUFDbkcsV0FBVyxDQUFVLEtBQWEsSUFBYSxPQUFPLElBQUksWUFBWSxDQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFVLENBQUM7SUFDbkcsVUFBVSxDQUFXLEtBQVksSUFBYyxPQUFPLElBQUksV0FBVyxDQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFXLENBQUM7SUFDbkcsb0JBQW9CLENBQUMsS0FBc0IsSUFBSSxPQUFPLElBQUkscUJBQXFCLENBQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNuRyxrQkFBa0IsQ0FBRyxLQUFvQixJQUFNLE9BQU8sSUFBSSxtQkFBbUIsQ0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBRyxDQUFDO0lBQ25HLFFBQVEsQ0FBYSxLQUFXLElBQWUsT0FBTyxJQUFJLFNBQVMsQ0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBYSxDQUFDO0lBQ25HLGVBQWUsQ0FBTSxLQUFpQixJQUFTLE9BQU8sSUFBSSxnQkFBZ0IsQ0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBTSxDQUFDO0NBQ3RHLENBQUMsQ0FBQyIsImZpbGUiOiJ2ZWN0b3IuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4vLyBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbi8vIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4vLyByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4vLyB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4vLyBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Vcbi8vIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbi8vXG4vLyAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuLy9cbi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbi8vIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4vLyBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuLy8gS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4vLyBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4vLyB1bmRlciB0aGUgTGljZW5zZS5cblxuaW1wb3J0IHsgRGF0YSwgQ2h1bmtlZERhdGEsIEZsYXREYXRhLCBCb29sRGF0YSwgRmxhdExpc3REYXRhLCBOZXN0ZWREYXRhLCBEaWN0aW9uYXJ5RGF0YSB9IGZyb20gJy4vZGF0YSc7XG5pbXBvcnQgeyBWaXNpdG9yTm9kZSwgVHlwZVZpc2l0b3IsIFZlY3RvclZpc2l0b3IgfSBmcm9tICcuL3Zpc2l0b3InO1xuaW1wb3J0IHsgRGF0YVR5cGUsIExpc3RUeXBlLCBGbGF0VHlwZSwgTmVzdGVkVHlwZSwgRmxhdExpc3RUeXBlLCBUaW1lVW5pdCB9IGZyb20gJy4vdHlwZSc7XG5pbXBvcnQgeyBJdGVyYWJsZUFycmF5TGlrZSwgUHJlY2lzaW9uLCBEYXRlVW5pdCwgSW50ZXJ2YWxVbml0LCBVbmlvbk1vZGUgfSBmcm9tICcuL3R5cGUnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFZlY3Rvckxpa2UgeyBsZW5ndGg6IG51bWJlcjsgbnVsbENvdW50OiBudW1iZXI7IH1cblxuZXhwb3J0IGludGVyZmFjZSBWaWV3PFQgZXh0ZW5kcyBEYXRhVHlwZT4ge1xuICAgIGNsb25lKGRhdGE6IERhdGE8VD4pOiB0aGlzO1xuICAgIGlzVmFsaWQoaW5kZXg6IG51bWJlcik6IGJvb2xlYW47XG4gICAgZ2V0KGluZGV4OiBudW1iZXIpOiBUWydUVmFsdWUnXSB8IG51bGw7XG4gICAgc2V0KGluZGV4OiBudW1iZXIsIHZhbHVlOiBUWydUVmFsdWUnXSk6IHZvaWQ7XG4gICAgdG9BcnJheSgpOiBJdGVyYWJsZUFycmF5TGlrZTxUWydUVmFsdWUnXSB8IG51bGw+O1xuICAgIGluZGV4T2Yoc2VhcmNoOiBUWydUVmFsdWUnXSk6IG51bWJlcjtcbiAgICBbU3ltYm9sLml0ZXJhdG9yXSgpOiBJdGVyYWJsZUl0ZXJhdG9yPFRbJ1RWYWx1ZSddIHwgbnVsbD47XG59XG5cbmV4cG9ydCBjbGFzcyBWZWN0b3I8VCBleHRlbmRzIERhdGFUeXBlID0gYW55PiBpbXBsZW1lbnRzIFZlY3Rvckxpa2UsIFZpZXc8VD4sIFZpc2l0b3JOb2RlIHtcbiAgICBwdWJsaWMgc3RhdGljIGNyZWF0ZTxUIGV4dGVuZHMgRGF0YVR5cGU+KGRhdGE6IERhdGE8VD4pOiBWZWN0b3I8VD4ge1xuICAgICAgICByZXR1cm4gY3JlYXRlVmVjdG9yKGRhdGEpO1xuICAgIH1cbiAgICBwdWJsaWMgc3RhdGljIGNvbmNhdDxUIGV4dGVuZHMgRGF0YVR5cGU+KHNvdXJjZT86IFZlY3RvcjxUPiB8IG51bGwsIC4uLm90aGVyczogVmVjdG9yPFQ+W10pOiBWZWN0b3I8VD4ge1xuICAgICAgICByZXR1cm4gb3RoZXJzLnJlZHVjZSgoYSwgYikgPT4gYSA/IGEuY29uY2F0KGIpIDogYiwgc291cmNlISk7XG4gICAgfVxuICAgIHB1YmxpYyB0eXBlOiBUO1xuICAgIHB1YmxpYyBsZW5ndGg6IG51bWJlcjtcbiAgICBwdWJsaWMgcmVhZG9ubHkgZGF0YTogRGF0YTxUPjtcbiAgICBwdWJsaWMgcmVhZG9ubHkgdmlldzogVmlldzxUPjtcbiAgICBjb25zdHJ1Y3RvcihkYXRhOiBEYXRhPFQ+LCB2aWV3OiBWaWV3PFQ+KSB7XG4gICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gICAgICAgIHRoaXMudHlwZSA9IGRhdGEudHlwZTtcbiAgICAgICAgdGhpcy5sZW5ndGggPSBkYXRhLmxlbmd0aDtcbiAgICAgICAgbGV0IG51bGxzOiBVaW50OEFycmF5O1xuICAgICAgICBpZiAoKDxhbnk+IGRhdGEgaW5zdGFuY2VvZiBDaHVua2VkRGF0YSkgJiYgISh2aWV3IGluc3RhbmNlb2YgQ2h1bmtlZFZpZXcpKSB7XG4gICAgICAgICAgICB0aGlzLnZpZXcgPSBuZXcgQ2h1bmtlZFZpZXcoZGF0YSBhcyBhbnkpIGFzIGFueTtcbiAgICAgICAgfSBlbHNlIGlmICghKHZpZXcgaW5zdGFuY2VvZiBWYWxpZGl0eVZpZXcpICYmIChudWxscyA9IGRhdGEubnVsbEJpdG1hcCEpICYmIG51bGxzLmxlbmd0aCA+IDAgJiYgZGF0YS5udWxsQ291bnQgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnZpZXcgPSBuZXcgVmFsaWRpdHlWaWV3KGRhdGEsIHZpZXcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy52aWV3ID0gdmlldztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXQgbnVsbENvdW50KCkgeyByZXR1cm4gdGhpcy5kYXRhLm51bGxDb3VudDsgfVxuICAgIHB1YmxpYyBnZXQgbnVsbEJpdG1hcCgpIHsgcmV0dXJuIHRoaXMuZGF0YS5udWxsQml0bWFwOyB9XG4gICAgcHVibGljIGdldCBbU3ltYm9sLnRvU3RyaW5nVGFnXSgpIHtcbiAgICAgICAgcmV0dXJuIGBWZWN0b3I8JHt0aGlzLnR5cGVbU3ltYm9sLnRvU3RyaW5nVGFnXX0+YDtcbiAgICB9XG4gICAgcHVibGljIHRvSlNPTigpOiBhbnkgeyByZXR1cm4gdGhpcy50b0FycmF5KCk7IH1cbiAgICBwdWJsaWMgY2xvbmU8UiBleHRlbmRzIFQ+KGRhdGE6IERhdGE8Uj4sIHZpZXc6IFZpZXc8Uj4gPSB0aGlzLnZpZXcuY2xvbmUoZGF0YSkgYXMgYW55KTogdGhpcyB7XG4gICAgICAgIHJldHVybiBuZXcgKHRoaXMuY29uc3RydWN0b3IgYXMgYW55KShkYXRhLCB2aWV3KTtcbiAgICB9XG4gICAgcHVibGljIGlzVmFsaWQoaW5kZXg6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy52aWV3LmlzVmFsaWQoaW5kZXgpO1xuICAgIH1cbiAgICBwdWJsaWMgZ2V0KGluZGV4OiBudW1iZXIpOiBUWydUVmFsdWUnXSB8IG51bGwge1xuICAgICAgICByZXR1cm4gdGhpcy52aWV3LmdldChpbmRleCk7XG4gICAgfVxuICAgIHB1YmxpYyBzZXQoaW5kZXg6IG51bWJlciwgdmFsdWU6IFRbJ1RWYWx1ZSddKTogdm9pZCB7XG4gICAgICAgIHJldHVybiB0aGlzLnZpZXcuc2V0KGluZGV4LCB2YWx1ZSk7XG4gICAgfVxuICAgIHB1YmxpYyB0b0FycmF5KCk6IEl0ZXJhYmxlQXJyYXlMaWtlPFRbJ1RWYWx1ZSddIHwgbnVsbD4ge1xuICAgICAgICByZXR1cm4gdGhpcy52aWV3LnRvQXJyYXkoKTtcbiAgICB9XG4gICAgcHVibGljIGluZGV4T2YodmFsdWU6IFRbJ1RWYWx1ZSddKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnZpZXcuaW5kZXhPZih2YWx1ZSk7XG4gICAgfVxuICAgIHB1YmxpYyBbU3ltYm9sLml0ZXJhdG9yXSgpOiBJdGVyYWJsZUl0ZXJhdG9yPFRbJ1RWYWx1ZSddIHwgbnVsbD4ge1xuICAgICAgICByZXR1cm4gdGhpcy52aWV3W1N5bWJvbC5pdGVyYXRvcl0oKTtcbiAgICB9XG4gICAgcHVibGljIGNvbmNhdCguLi5vdGhlcnM6IFZlY3RvcjxUPltdKTogdGhpcyB7XG4gICAgICAgIGlmICgob3RoZXJzID0gb3RoZXJzLmZpbHRlcihCb29sZWFuKSkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IHZpZXcgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IHZlY3MgPSAhKHZpZXcgaW5zdGFuY2VvZiBDaHVua2VkVmlldylcbiAgICAgICAgICAgID8gW3RoaXMsIC4uLm90aGVyc11cbiAgICAgICAgICAgIDogWy4uLnZpZXcuY2h1bmtWZWN0b3JzLCAuLi5vdGhlcnNdO1xuICAgICAgICBjb25zdCBvZmZzZXRzID0gQ2h1bmtlZERhdGEuY29tcHV0ZU9mZnNldHModmVjcyk7XG4gICAgICAgIGNvbnN0IGNodW5rc0xlbmd0aCA9IG9mZnNldHNbb2Zmc2V0cy5sZW5ndGggLSAxXTtcbiAgICAgICAgY29uc3QgY2h1bmtlZERhdGEgPSBuZXcgQ2h1bmtlZERhdGEodGhpcy50eXBlLCBjaHVua3NMZW5ndGgsIHZlY3MsIDAsIC0xLCBvZmZzZXRzKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2xvbmUoY2h1bmtlZERhdGEsIG5ldyBDaHVua2VkVmlldyhjaHVua2VkRGF0YSkpIGFzIHRoaXM7XG4gICAgfVxuICAgIHB1YmxpYyBzbGljZShiZWdpbj86IG51bWJlciwgZW5kPzogbnVtYmVyKTogdGhpcyB7XG4gICAgICAgIGxldCB7IGxlbmd0aCB9ID0gdGhpcztcbiAgICAgICAgbGV0IHNpemUgPSAodGhpcy52aWV3IGFzIGFueSkuc2l6ZSB8fCAxO1xuICAgICAgICBsZXQgdG90YWwgPSBsZW5ndGgsIGZyb20gPSAoYmVnaW4gfHwgMCkgKiBzaXplO1xuICAgICAgICBsZXQgdG8gPSAodHlwZW9mIGVuZCA9PT0gJ251bWJlcicgPyBlbmQgOiB0b3RhbCkgKiBzaXplO1xuICAgICAgICBpZiAodG8gPCAwKSB7IHRvID0gdG90YWwgLSAodG8gKiAtMSkgJSB0b3RhbDsgfVxuICAgICAgICBpZiAoZnJvbSA8IDApIHsgZnJvbSA9IHRvdGFsIC0gKGZyb20gKiAtMSkgJSB0b3RhbDsgfVxuICAgICAgICBpZiAodG8gPCBmcm9tKSB7IFtmcm9tLCB0b10gPSBbdG8sIGZyb21dOyB9XG4gICAgICAgIHRvdGFsID0gIWlzRmluaXRlKHRvdGFsID0gKHRvIC0gZnJvbSkpIHx8IHRvdGFsIDwgMCA/IDAgOiB0b3RhbDtcbiAgICAgICAgY29uc3Qgc2xpY2VkRGF0YSA9IHRoaXMuZGF0YS5zbGljZShmcm9tLCBNYXRoLm1pbih0b3RhbCwgbGVuZ3RoKSk7XG4gICAgICAgIHJldHVybiB0aGlzLmNsb25lKHNsaWNlZERhdGEsIHRoaXMudmlldy5jbG9uZShzbGljZWREYXRhKSkgYXMgdGhpcztcbiAgICB9XG5cbiAgICBwdWJsaWMgYWNjZXB0VHlwZVZpc2l0b3IodmlzaXRvcjogVHlwZVZpc2l0b3IpOiBhbnkge1xuICAgICAgICByZXR1cm4gVHlwZVZpc2l0b3IudmlzaXRUeXBlSW5saW5lKHZpc2l0b3IsIHRoaXMudHlwZSk7XG4gICAgfVxuICAgIHB1YmxpYyBhY2NlcHRWZWN0b3JWaXNpdG9yKHZpc2l0b3I6IFZlY3RvclZpc2l0b3IpOiBhbnkge1xuICAgICAgICByZXR1cm4gVmVjdG9yVmlzaXRvci52aXNpdFR5cGVJbmxpbmUodmlzaXRvciwgdGhpcy50eXBlLCB0aGlzKTtcbiAgICB9XG59XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBGbGF0VmVjdG9yPFQgZXh0ZW5kcyBGbGF0VHlwZT4gZXh0ZW5kcyBWZWN0b3I8VD4ge1xuICAgIHB1YmxpYyBnZXQgdmFsdWVzKCkgeyByZXR1cm4gdGhpcy5kYXRhLnZhbHVlczsgfVxuICAgIHB1YmxpYyBsb3dzKCk6IEludFZlY3RvcjxJbnQzMj4geyByZXR1cm4gdGhpcy5hc0ludDMyKDAsIDIpOyB9XG4gICAgcHVibGljIGhpZ2hzKCk6IEludFZlY3RvcjxJbnQzMj4geyByZXR1cm4gdGhpcy5hc0ludDMyKDEsIDIpOyB9XG4gICAgcHVibGljIGFzSW50MzIob2Zmc2V0OiBudW1iZXIgPSAwLCBzdHJpZGU6IG51bWJlciA9IDIpOiBJbnRWZWN0b3I8SW50MzI+IHtcbiAgICAgICAgbGV0IGRhdGEgPSAodGhpcy5kYXRhIGFzIEZsYXREYXRhPGFueT4pLmNsb25lKG5ldyBJbnQzMigpKTtcbiAgICAgICAgaWYgKG9mZnNldCA+IDApIHtcbiAgICAgICAgICAgIGRhdGEgPSBkYXRhLnNsaWNlKG9mZnNldCwgdGhpcy5sZW5ndGggLSBvZmZzZXQpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGludDMycyA9IG5ldyBJbnRWZWN0b3IoZGF0YSwgbmV3IFByaW1pdGl2ZVZpZXcoZGF0YSwgc3RyaWRlKSk7XG4gICAgICAgIGludDMycy5sZW5ndGggPSB0aGlzLmxlbmd0aCAvIHN0cmlkZSB8IDA7XG4gICAgICAgIHJldHVybiBpbnQzMnM7XG4gICAgfVxufVxuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgTGlzdFZlY3RvckJhc2U8VCBleHRlbmRzIChMaXN0VHlwZSB8IEZsYXRMaXN0VHlwZSk+IGV4dGVuZHMgVmVjdG9yPFQ+IHtcbiAgICBwdWJsaWMgZ2V0IHZhbHVlcygpIHsgcmV0dXJuIHRoaXMuZGF0YS52YWx1ZXM7IH1cbiAgICBwdWJsaWMgZ2V0IHZhbHVlT2Zmc2V0cygpIHsgcmV0dXJuIHRoaXMuZGF0YS52YWx1ZU9mZnNldHM7IH1cbiAgICBwdWJsaWMgZ2V0VmFsdWVPZmZzZXQoaW5kZXg6IG51bWJlcikge1xuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZU9mZnNldHNbaW5kZXhdO1xuICAgIH1cbiAgICBwdWJsaWMgZ2V0VmFsdWVMZW5ndGgoaW5kZXg6IG51bWJlcikge1xuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZU9mZnNldHNbaW5kZXggKyAxXSAtIHRoaXMudmFsdWVPZmZzZXRzW2luZGV4XTtcbiAgICB9XG59XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBOZXN0ZWRWZWN0b3I8VCBleHRlbmRzIE5lc3RlZFR5cGU+IGV4dGVuZHMgVmVjdG9yPFQ+ICB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHB1YmxpYyByZWFkb25seSB2aWV3OiBOZXN0ZWRWaWV3PFQ+O1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBwcm90ZWN0ZWQgX2NoaWxkRGF0YTogRGF0YTxhbnk+W107XG4gICAgcHVibGljIGdldENoaWxkQXQ8UiBleHRlbmRzIERhdGFUeXBlID0gRGF0YVR5cGU+KGluZGV4OiBudW1iZXIpOiBWZWN0b3I8Uj4gfCBudWxsIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmlldy5nZXRDaGlsZEF0PFI+KGluZGV4KTtcbiAgICB9XG4gICAgcHVibGljIGdldCBjaGlsZERhdGEoKTogRGF0YTxhbnk+W10ge1xuICAgICAgICBsZXQgZGF0YTogRGF0YTxUPiB8IERhdGE8YW55PltdO1xuICAgICAgICBpZiAoKGRhdGEgPSB0aGlzLl9jaGlsZERhdGEpKSB7XG4gICAgICAgICAgICAvLyBSZXR1cm4gdGhlIGNhY2hlZCBjaGlsZERhdGEgcmVmZXJlbmNlIGZpcnN0XG4gICAgICAgICAgICByZXR1cm4gZGF0YSBhcyBEYXRhPGFueT5bXTtcbiAgICAgICAgfSBlbHNlIGlmICghKDxhbnk+IChkYXRhID0gdGhpcy5kYXRhKSBpbnN0YW5jZW9mIENodW5rZWREYXRhKSkge1xuICAgICAgICAgICAgLy8gSWYgZGF0YSBpc24ndCBjaHVua2VkLCBjYWNoZSBhbmQgcmV0dXJuIE5lc3RlZERhdGEncyBjaGlsZERhdGFcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGlsZERhdGEgPSBkYXRhLmNoaWxkRGF0YTtcbiAgICAgICAgfVxuICAgICAgICAvLyBPdGhlcndpc2UgaWYgdGhlIGRhdGEgaXMgY2h1bmtlZCwgY29uY2F0ZW5hdGUgdGhlIGNoaWxkVmVjdG9ycyBmcm9tIGVhY2ggY2h1bmtcbiAgICAgICAgLy8gdG8gY29uc3RydWN0IGEgc2luZ2xlIGNodW5rZWQgVmVjdG9yIGZvciBlYWNoIGNvbHVtbi4gVGhlbiByZXR1cm4gdGhlIENodW5rZWREYXRhXG4gICAgICAgIC8vIGluc3RhbmNlIGZyb20gZWFjaCB1bmlmaWVkIGNodW5rZWQgY29sdW1uIGFzIHRoZSBjaGlsZERhdGEgb2YgYSBjaHVua2VkIE5lc3RlZFZlY3RvclxuICAgICAgICBjb25zdCBjaHVua3MgPSAoKGRhdGEgYXMgYW55IGFzIENodW5rZWREYXRhPFQ+KS5jaHVua1ZlY3RvcnMgYXMgTmVzdGVkVmVjdG9yPFQ+W10pO1xuICAgICAgICByZXR1cm4gdGhpcy5fY2hpbGREYXRhID0gY2h1bmtzXG4gICAgICAgICAgICAucmVkdWNlPChWZWN0b3I8VD4gfCBudWxsKVtdW10+KChjb2xzLCBjaHVuaykgPT4gY2h1bmsuY2hpbGREYXRhXG4gICAgICAgICAgICAucmVkdWNlPChWZWN0b3I8VD4gfCBudWxsKVtdW10+KChjb2xzLCBfLCBpKSA9PiAoXG4gICAgICAgICAgICAgICAgKGNvbHNbaV0gfHwgKGNvbHNbaV0gPSBbXSkpLnB1c2goY2h1bmsuZ2V0Q2hpbGRBdChpKSlcbiAgICAgICAgICAgICkgJiYgY29scyB8fCBjb2xzLCBjb2xzKSwgW10gYXMgVmVjdG9yPFQ+W11bXSlcbiAgICAgICAgLm1hcCgodmVjcykgPT4gVmVjdG9yLmNvbmNhdDxUPiguLi52ZWNzKS5kYXRhKTtcbiAgICB9XG59XG5cbmltcG9ydCB7IExpc3QsIEJpbmFyeSwgVXRmOCwgQm9vbCwgfSBmcm9tICcuL3R5cGUnO1xuaW1wb3J0IHsgTnVsbCwgSW50LCBGbG9hdCwgRGVjaW1hbCwgRGF0ZV8sIFRpbWUsIFRpbWVzdGFtcCwgSW50ZXJ2YWwgfSBmcm9tICcuL3R5cGUnO1xuaW1wb3J0IHsgVWludDgsIFVpbnQxNiwgVWludDMyLCBVaW50NjQsIEludDgsIEludDE2LCBJbnQzMiwgSW50NjQsIEZsb2F0MTYsIEZsb2F0MzIsIEZsb2F0NjQgfSBmcm9tICcuL3R5cGUnO1xuaW1wb3J0IHsgU3RydWN0LCBVbmlvbiwgU3BhcnNlVW5pb24sIERlbnNlVW5pb24sIEZpeGVkU2l6ZUJpbmFyeSwgRml4ZWRTaXplTGlzdCwgTWFwXywgRGljdGlvbmFyeSB9IGZyb20gJy4vdHlwZSc7XG5cbmltcG9ydCB7IENodW5rZWRWaWV3IH0gZnJvbSAnLi92ZWN0b3IvY2h1bmtlZCc7XG5pbXBvcnQgeyBWYWxpZGl0eVZpZXcgfSBmcm9tICcuL3ZlY3Rvci92YWxpZGl0eSc7XG5pbXBvcnQgeyBEaWN0aW9uYXJ5VmlldyB9IGZyb20gJy4vdmVjdG9yL2RpY3Rpb25hcnknO1xuaW1wb3J0IHsgTGlzdFZpZXcsIEZpeGVkU2l6ZUxpc3RWaWV3LCBCaW5hcnlWaWV3LCBVdGY4VmlldyB9IGZyb20gJy4vdmVjdG9yL2xpc3QnO1xuaW1wb3J0IHsgVW5pb25WaWV3LCBEZW5zZVVuaW9uVmlldywgTmVzdGVkVmlldywgU3RydWN0VmlldywgTWFwVmlldyB9IGZyb20gJy4vdmVjdG9yL25lc3RlZCc7XG5pbXBvcnQgeyBGbGF0VmlldywgTnVsbFZpZXcsIEJvb2xWaWV3LCBQcmltaXRpdmVWaWV3LCBGaXhlZFNpemVWaWV3LCBGbG9hdDE2VmlldyB9IGZyb20gJy4vdmVjdG9yL2ZsYXQnO1xuaW1wb3J0IHsgRGF0ZURheVZpZXcsIERhdGVNaWxsaXNlY29uZFZpZXcsIEludGVydmFsWWVhck1vbnRoVmlldyB9IGZyb20gJy4vdmVjdG9yL2ZsYXQnO1xuaW1wb3J0IHsgVGltZXN0YW1wRGF5VmlldywgVGltZXN0YW1wU2Vjb25kVmlldywgVGltZXN0YW1wTWlsbGlzZWNvbmRWaWV3LCBUaW1lc3RhbXBNaWNyb3NlY29uZFZpZXcsIFRpbWVzdGFtcE5hbm9zZWNvbmRWaWV3IH0gZnJvbSAnLi92ZWN0b3IvZmxhdCc7XG5pbXBvcnQgeyBwYWNrQm9vbHMgfSBmcm9tICcuL3V0aWwvYml0JztcblxuZXhwb3J0IGNsYXNzIE51bGxWZWN0b3IgZXh0ZW5kcyBWZWN0b3I8TnVsbD4ge1xuICAgIGNvbnN0cnVjdG9yKGRhdGE6IERhdGE8TnVsbD4sIHZpZXc6IFZpZXc8TnVsbD4gPSBuZXcgTnVsbFZpZXcoZGF0YSkpIHtcbiAgICAgICAgc3VwZXIoZGF0YSwgdmlldyk7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgQm9vbFZlY3RvciBleHRlbmRzIFZlY3RvcjxCb29sPiB7XG4gICAgcHVibGljIHN0YXRpYyBmcm9tKGRhdGE6IEl0ZXJhYmxlQXJyYXlMaWtlPGJvb2xlYW4+KSB7XG4gICAgICAgIHJldHVybiBuZXcgQm9vbFZlY3RvcihuZXcgQm9vbERhdGEobmV3IEJvb2woKSwgZGF0YS5sZW5ndGgsIG51bGwsIHBhY2tCb29scyhkYXRhKSkgYXMgRGF0YTxCb29sPik7XG4gICAgfVxuICAgIHB1YmxpYyBnZXQgdmFsdWVzKCkgeyByZXR1cm4gdGhpcy5kYXRhLnZhbHVlczsgfVxuICAgIGNvbnN0cnVjdG9yKGRhdGE6IERhdGE8Qm9vbD4sIHZpZXc6IFZpZXc8Qm9vbD4gPSBuZXcgQm9vbFZpZXcoZGF0YSkpIHtcbiAgICAgICAgc3VwZXIoZGF0YSwgdmlldyk7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgSW50VmVjdG9yPFQgZXh0ZW5kcyBJbnQgPSBJbnQ8YW55Pj4gZXh0ZW5kcyBGbGF0VmVjdG9yPFQ+IHtcbiAgICBwdWJsaWMgc3RhdGljIGZyb20oZGF0YTogSW50OEFycmF5KTogSW50VmVjdG9yPEludDg+O1xuICAgIHB1YmxpYyBzdGF0aWMgZnJvbShkYXRhOiBJbnQxNkFycmF5KTogSW50VmVjdG9yPEludDE2PjtcbiAgICBwdWJsaWMgc3RhdGljIGZyb20oZGF0YTogSW50MzJBcnJheSk6IEludFZlY3RvcjxJbnQzMj47XG4gICAgcHVibGljIHN0YXRpYyBmcm9tKGRhdGE6IFVpbnQ4QXJyYXkpOiBJbnRWZWN0b3I8VWludDg+O1xuICAgIHB1YmxpYyBzdGF0aWMgZnJvbShkYXRhOiBVaW50MTZBcnJheSk6IEludFZlY3RvcjxVaW50MTY+O1xuICAgIHB1YmxpYyBzdGF0aWMgZnJvbShkYXRhOiBVaW50MzJBcnJheSk6IEludFZlY3RvcjxVaW50MzI+O1xuICAgIHB1YmxpYyBzdGF0aWMgZnJvbShkYXRhOiBJbnQzMkFycmF5LCBpczY0OiB0cnVlKTogSW50VmVjdG9yPEludDY0PjtcbiAgICBwdWJsaWMgc3RhdGljIGZyb20oZGF0YTogVWludDMyQXJyYXksIGlzNjQ6IHRydWUpOiBJbnRWZWN0b3I8VWludDY0PjtcbiAgICBwdWJsaWMgc3RhdGljIGZyb20oZGF0YTogYW55LCBpczY0PzogYm9vbGVhbikge1xuICAgICAgICBpZiAoaXM2NCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGRhdGEgaW5zdGFuY2VvZiBJbnQzMkFycmF5XG4gICAgICAgICAgICAgICAgPyBuZXcgSW50VmVjdG9yKG5ldyBGbGF0RGF0YShuZXcgSW50NjQoKSwgZGF0YS5sZW5ndGgsIG51bGwsIGRhdGEpKVxuICAgICAgICAgICAgICAgIDogbmV3IEludFZlY3RvcihuZXcgRmxhdERhdGEobmV3IFVpbnQ2NCgpLCBkYXRhLmxlbmd0aCwgbnVsbCwgZGF0YSkpO1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAoZGF0YS5jb25zdHJ1Y3Rvcikge1xuICAgICAgICAgICAgY2FzZSBJbnQ4QXJyYXk6IHJldHVybiBuZXcgSW50VmVjdG9yKG5ldyBGbGF0RGF0YShuZXcgSW50OCgpLCBkYXRhLmxlbmd0aCwgbnVsbCwgZGF0YSkpO1xuICAgICAgICAgICAgY2FzZSBJbnQxNkFycmF5OiByZXR1cm4gbmV3IEludFZlY3RvcihuZXcgRmxhdERhdGEobmV3IEludDE2KCksIGRhdGEubGVuZ3RoLCBudWxsLCBkYXRhKSk7XG4gICAgICAgICAgICBjYXNlIEludDMyQXJyYXk6IHJldHVybiBuZXcgSW50VmVjdG9yKG5ldyBGbGF0RGF0YShuZXcgSW50MzIoKSwgZGF0YS5sZW5ndGgsIG51bGwsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhc2UgVWludDhBcnJheTogcmV0dXJuIG5ldyBJbnRWZWN0b3IobmV3IEZsYXREYXRhKG5ldyBVaW50OCgpLCBkYXRhLmxlbmd0aCwgbnVsbCwgZGF0YSkpO1xuICAgICAgICAgICAgY2FzZSBVaW50MTZBcnJheTogcmV0dXJuIG5ldyBJbnRWZWN0b3IobmV3IEZsYXREYXRhKG5ldyBVaW50MTYoKSwgZGF0YS5sZW5ndGgsIG51bGwsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhc2UgVWludDMyQXJyYXk6IHJldHVybiBuZXcgSW50VmVjdG9yKG5ldyBGbGF0RGF0YShuZXcgVWludDMyKCksIGRhdGEubGVuZ3RoLCBudWxsLCBkYXRhKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5yZWNvZ25pemVkIEludCBkYXRhJyk7XG4gICAgfVxuICAgIHN0YXRpYyBkZWZhdWx0VmlldzxUIGV4dGVuZHMgSW50PihkYXRhOiBEYXRhPFQ+KSB7XG4gICAgICAgIHJldHVybiBkYXRhLnR5cGUuYml0V2lkdGggPD0gMzIgPyBuZXcgRmxhdFZpZXcoZGF0YSkgOiBuZXcgRml4ZWRTaXplVmlldyhkYXRhLCAoZGF0YS50eXBlLmJpdFdpZHRoIC8gMzIpIHwgMCk7XG4gICAgfVxuICAgIGNvbnN0cnVjdG9yKGRhdGE6IERhdGE8VD4sIHZpZXc6IFZpZXc8VD4gPSBJbnRWZWN0b3IuZGVmYXVsdFZpZXcoZGF0YSkpIHtcbiAgICAgICAgc3VwZXIoZGF0YSwgdmlldyk7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgRmxvYXRWZWN0b3I8VCBleHRlbmRzIEZsb2F0ID0gRmxvYXQ8YW55Pj4gZXh0ZW5kcyBGbGF0VmVjdG9yPFQ+IHtcbiAgICBwdWJsaWMgc3RhdGljIGZyb20oZGF0YTogVWludDE2QXJyYXkpOiBGbG9hdFZlY3RvcjxGbG9hdDE2PjtcbiAgICBwdWJsaWMgc3RhdGljIGZyb20oZGF0YTogRmxvYXQzMkFycmF5KTogRmxvYXRWZWN0b3I8RmxvYXQzMj47XG4gICAgcHVibGljIHN0YXRpYyBmcm9tKGRhdGE6IEZsb2F0NjRBcnJheSk6IEZsb2F0VmVjdG9yPEZsb2F0NjQ+O1xuICAgIHB1YmxpYyBzdGF0aWMgZnJvbShkYXRhOiBhbnkpIHtcbiAgICAgICAgc3dpdGNoIChkYXRhLmNvbnN0cnVjdG9yKSB7XG4gICAgICAgICAgICBjYXNlIFVpbnQxNkFycmF5OiByZXR1cm4gbmV3IEZsb2F0VmVjdG9yKG5ldyBGbGF0RGF0YShuZXcgRmxvYXQxNigpLCBkYXRhLmxlbmd0aCwgbnVsbCwgZGF0YSkpO1xuICAgICAgICAgICAgY2FzZSBGbG9hdDMyQXJyYXk6IHJldHVybiBuZXcgRmxvYXRWZWN0b3IobmV3IEZsYXREYXRhKG5ldyBGbG9hdDMyKCksIGRhdGEubGVuZ3RoLCBudWxsLCBkYXRhKSk7XG4gICAgICAgICAgICBjYXNlIEZsb2F0NjRBcnJheTogcmV0dXJuIG5ldyBGbG9hdFZlY3RvcihuZXcgRmxhdERhdGEobmV3IEZsb2F0NjQoKSwgZGF0YS5sZW5ndGgsIG51bGwsIGRhdGEpKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdVbnJlY29nbml6ZWQgRmxvYXQgZGF0YScpO1xuICAgIH1cbiAgICBzdGF0aWMgZGVmYXVsdFZpZXc8VCBleHRlbmRzIEZsb2F0PihkYXRhOiBEYXRhPFQ+KTogRmxhdFZpZXc8YW55PiB7XG4gICAgICAgIHJldHVybiBkYXRhLnR5cGUucHJlY2lzaW9uICE9PSBQcmVjaXNpb24uSEFMRiA/IG5ldyBGbGF0VmlldyhkYXRhKSA6IG5ldyBGbG9hdDE2VmlldyhkYXRhIGFzIERhdGE8RmxvYXQxNj4pO1xuICAgIH1cbiAgICBjb25zdHJ1Y3RvcihkYXRhOiBEYXRhPFQ+LCB2aWV3OiBWaWV3PFQ+ID0gRmxvYXRWZWN0b3IuZGVmYXVsdFZpZXcoZGF0YSkpIHtcbiAgICAgICAgc3VwZXIoZGF0YSwgdmlldyk7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgRGF0ZVZlY3RvciBleHRlbmRzIEZsYXRWZWN0b3I8RGF0ZV8+IHtcbiAgICBzdGF0aWMgZGVmYXVsdFZpZXc8VCBleHRlbmRzIERhdGVfPihkYXRhOiBEYXRhPFQ+KSB7XG4gICAgICAgIHJldHVybiBkYXRhLnR5cGUudW5pdCA9PT0gRGF0ZVVuaXQuREFZID8gbmV3IERhdGVEYXlWaWV3KGRhdGEpIDogbmV3IERhdGVNaWxsaXNlY29uZFZpZXcoZGF0YSwgMik7XG4gICAgfVxuICAgIGNvbnN0cnVjdG9yKGRhdGE6IERhdGE8RGF0ZV8+LCB2aWV3OiBWaWV3PERhdGVfPiA9IERhdGVWZWN0b3IuZGVmYXVsdFZpZXcoZGF0YSkpIHtcbiAgICAgICAgc3VwZXIoZGF0YSwgdmlldyk7XG4gICAgfVxuICAgIHB1YmxpYyBsb3dzKCk6IEludFZlY3RvcjxJbnQzMj4ge1xuICAgICAgICByZXR1cm4gdGhpcy50eXBlLnVuaXQgPT09IERhdGVVbml0LkRBWSA/IHRoaXMuYXNJbnQzMigwLCAxKSA6IHRoaXMuYXNJbnQzMigwLCAyKTtcbiAgICB9XG4gICAgcHVibGljIGhpZ2hzKCk6IEludFZlY3RvcjxJbnQzMj4ge1xuICAgICAgICByZXR1cm4gdGhpcy50eXBlLnVuaXQgPT09IERhdGVVbml0LkRBWSA/IHRoaXMuYXNJbnQzMigwLCAxKSA6IHRoaXMuYXNJbnQzMigxLCAyKTtcbiAgICB9XG4gICAgcHVibGljIGFzRXBvY2hNaWxsaXNlY29uZHMoKTogSW50VmVjdG9yPEludDMyPiB7XG4gICAgICAgIGxldCBkYXRhID0gKHRoaXMuZGF0YSBhcyBGbGF0RGF0YTxhbnk+KS5jbG9uZShuZXcgSW50MzIoKSk7XG4gICAgICAgIHN3aXRjaCAodGhpcy50eXBlLnVuaXQpIHtcbiAgICAgICAgICAgIGNhc2UgRGF0ZVVuaXQuREFZOiByZXR1cm4gbmV3IEludFZlY3RvcihkYXRhLCBuZXcgVGltZXN0YW1wRGF5VmlldyhkYXRhIGFzIGFueSwgMSkgYXMgYW55KTtcbiAgICAgICAgICAgIGNhc2UgRGF0ZVVuaXQuTUlMTElTRUNPTkQ6IHJldHVybiBuZXcgSW50VmVjdG9yKGRhdGEsIG5ldyBUaW1lc3RhbXBNaWxsaXNlY29uZFZpZXcoZGF0YSBhcyBhbnksIDIpIGFzIGFueSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgVW5yZWNvZ25pemVkIGRhdGUgdW5pdCBcIiR7RGF0ZVVuaXRbdGhpcy50eXBlLnVuaXRdfVwiYCk7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgRGVjaW1hbFZlY3RvciBleHRlbmRzIEZsYXRWZWN0b3I8RGVjaW1hbD4ge1xuICAgIGNvbnN0cnVjdG9yKGRhdGE6IERhdGE8RGVjaW1hbD4sIHZpZXc6IFZpZXc8RGVjaW1hbD4gPSBuZXcgRml4ZWRTaXplVmlldyhkYXRhLCA0KSkge1xuICAgICAgICBzdXBlcihkYXRhLCB2aWV3KTtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBUaW1lVmVjdG9yIGV4dGVuZHMgRmxhdFZlY3RvcjxUaW1lPiB7XG4gICAgc3RhdGljIGRlZmF1bHRWaWV3PFQgZXh0ZW5kcyBUaW1lPihkYXRhOiBEYXRhPFQ+KSB7XG4gICAgICAgIHJldHVybiBkYXRhLnR5cGUuYml0V2lkdGggPD0gMzIgPyBuZXcgRmxhdFZpZXcoZGF0YSkgOiBuZXcgRml4ZWRTaXplVmlldyhkYXRhLCAoZGF0YS50eXBlLmJpdFdpZHRoIC8gMzIpIHwgMCk7XG4gICAgfVxuICAgIGNvbnN0cnVjdG9yKGRhdGE6IERhdGE8VGltZT4sIHZpZXc6IFZpZXc8VGltZT4gPSBUaW1lVmVjdG9yLmRlZmF1bHRWaWV3KGRhdGEpKSB7XG4gICAgICAgIHN1cGVyKGRhdGEsIHZpZXcpO1xuICAgIH1cbiAgICBwdWJsaWMgbG93cygpOiBJbnRWZWN0b3I8SW50MzI+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHlwZS5iaXRXaWR0aCA8PSAzMiA/IHRoaXMuYXNJbnQzMigwLCAxKSA6IHRoaXMuYXNJbnQzMigwLCAyKTtcbiAgICB9XG4gICAgcHVibGljIGhpZ2hzKCk6IEludFZlY3RvcjxJbnQzMj4ge1xuICAgICAgICByZXR1cm4gdGhpcy50eXBlLmJpdFdpZHRoIDw9IDMyID8gdGhpcy5hc0ludDMyKDAsIDEpIDogdGhpcy5hc0ludDMyKDEsIDIpO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIFRpbWVzdGFtcFZlY3RvciBleHRlbmRzIEZsYXRWZWN0b3I8VGltZXN0YW1wPiB7XG4gICAgY29uc3RydWN0b3IoZGF0YTogRGF0YTxUaW1lc3RhbXA+LCB2aWV3OiBWaWV3PFRpbWVzdGFtcD4gPSBuZXcgRml4ZWRTaXplVmlldyhkYXRhLCAyKSkge1xuICAgICAgICBzdXBlcihkYXRhLCB2aWV3KTtcbiAgICB9XG4gICAgcHVibGljIGFzRXBvY2hNaWxsaXNlY29uZHMoKTogSW50VmVjdG9yPEludDMyPiB7XG4gICAgICAgIGxldCBkYXRhID0gKHRoaXMuZGF0YSBhcyBGbGF0RGF0YTxhbnk+KS5jbG9uZShuZXcgSW50MzIoKSk7XG4gICAgICAgIHN3aXRjaCAodGhpcy50eXBlLnVuaXQpIHtcbiAgICAgICAgICAgIGNhc2UgVGltZVVuaXQuU0VDT05EOiByZXR1cm4gbmV3IEludFZlY3RvcihkYXRhLCBuZXcgVGltZXN0YW1wU2Vjb25kVmlldyhkYXRhIGFzIGFueSwgMSkgYXMgYW55KTtcbiAgICAgICAgICAgIGNhc2UgVGltZVVuaXQuTUlMTElTRUNPTkQ6IHJldHVybiBuZXcgSW50VmVjdG9yKGRhdGEsIG5ldyBUaW1lc3RhbXBNaWxsaXNlY29uZFZpZXcoZGF0YSBhcyBhbnksIDIpIGFzIGFueSk7XG4gICAgICAgICAgICBjYXNlIFRpbWVVbml0Lk1JQ1JPU0VDT05EOiByZXR1cm4gbmV3IEludFZlY3RvcihkYXRhLCBuZXcgVGltZXN0YW1wTWljcm9zZWNvbmRWaWV3KGRhdGEgYXMgYW55LCAyKSBhcyBhbnkpO1xuICAgICAgICAgICAgY2FzZSBUaW1lVW5pdC5OQU5PU0VDT05EOiByZXR1cm4gbmV3IEludFZlY3RvcihkYXRhLCBuZXcgVGltZXN0YW1wTmFub3NlY29uZFZpZXcoZGF0YSBhcyBhbnksIDIpIGFzIGFueSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgVW5yZWNvZ25pemVkIHRpbWUgdW5pdCBcIiR7VGltZVVuaXRbdGhpcy50eXBlLnVuaXRdfVwiYCk7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgSW50ZXJ2YWxWZWN0b3IgZXh0ZW5kcyBGbGF0VmVjdG9yPEludGVydmFsPiB7XG4gICAgc3RhdGljIGRlZmF1bHRWaWV3PFQgZXh0ZW5kcyBJbnRlcnZhbD4oZGF0YTogRGF0YTxUPikge1xuICAgICAgICByZXR1cm4gZGF0YS50eXBlLnVuaXQgPT09IEludGVydmFsVW5pdC5ZRUFSX01PTlRIID8gbmV3IEludGVydmFsWWVhck1vbnRoVmlldyhkYXRhKSA6IG5ldyBGaXhlZFNpemVWaWV3KGRhdGEsIDIpO1xuICAgIH1cbiAgICBjb25zdHJ1Y3RvcihkYXRhOiBEYXRhPEludGVydmFsPiwgdmlldzogVmlldzxJbnRlcnZhbD4gPSBJbnRlcnZhbFZlY3Rvci5kZWZhdWx0VmlldyhkYXRhKSkge1xuICAgICAgICBzdXBlcihkYXRhLCB2aWV3KTtcbiAgICB9XG4gICAgcHVibGljIGxvd3MoKTogSW50VmVjdG9yPEludDMyPiB7XG4gICAgICAgIHJldHVybiB0aGlzLnR5cGUudW5pdCA9PT0gSW50ZXJ2YWxVbml0LllFQVJfTU9OVEggPyB0aGlzLmFzSW50MzIoMCwgMSkgOiB0aGlzLmFzSW50MzIoMCwgMik7XG4gICAgfVxuICAgIHB1YmxpYyBoaWdocygpOiBJbnRWZWN0b3I8SW50MzI+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHlwZS51bml0ID09PSBJbnRlcnZhbFVuaXQuWUVBUl9NT05USCA/IHRoaXMuYXNJbnQzMigwLCAxKSA6IHRoaXMuYXNJbnQzMigxLCAyKTtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBCaW5hcnlWZWN0b3IgZXh0ZW5kcyBMaXN0VmVjdG9yQmFzZTxCaW5hcnk+IHtcbiAgICBjb25zdHJ1Y3RvcihkYXRhOiBEYXRhPEJpbmFyeT4sIHZpZXc6IFZpZXc8QmluYXJ5PiA9IG5ldyBCaW5hcnlWaWV3KGRhdGEpKSB7XG4gICAgICAgIHN1cGVyKGRhdGEsIHZpZXcpO1xuICAgIH1cbiAgICBwdWJsaWMgYXNVdGY4KCkge1xuICAgICAgICByZXR1cm4gbmV3IFV0ZjhWZWN0b3IoKHRoaXMuZGF0YSBhcyBGbGF0TGlzdERhdGE8YW55PikuY2xvbmUobmV3IFV0ZjgoKSkpO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIEZpeGVkU2l6ZUJpbmFyeVZlY3RvciBleHRlbmRzIEZsYXRWZWN0b3I8Rml4ZWRTaXplQmluYXJ5PiB7XG4gICAgY29uc3RydWN0b3IoZGF0YTogRGF0YTxGaXhlZFNpemVCaW5hcnk+LCB2aWV3OiBWaWV3PEZpeGVkU2l6ZUJpbmFyeT4gPSBuZXcgRml4ZWRTaXplVmlldyhkYXRhLCBkYXRhLnR5cGUuYnl0ZVdpZHRoKSkge1xuICAgICAgICBzdXBlcihkYXRhLCB2aWV3KTtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBVdGY4VmVjdG9yIGV4dGVuZHMgTGlzdFZlY3RvckJhc2U8VXRmOD4ge1xuICAgIGNvbnN0cnVjdG9yKGRhdGE6IERhdGE8VXRmOD4sIHZpZXc6IFZpZXc8VXRmOD4gPSBuZXcgVXRmOFZpZXcoZGF0YSkpIHtcbiAgICAgICAgc3VwZXIoZGF0YSwgdmlldyk7XG4gICAgfVxuICAgIHB1YmxpYyBhc0JpbmFyeSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBCaW5hcnlWZWN0b3IoKHRoaXMuZGF0YSBhcyBGbGF0TGlzdERhdGE8YW55PikuY2xvbmUobmV3IEJpbmFyeSgpKSk7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgTGlzdFZlY3RvcjxUIGV4dGVuZHMgRGF0YVR5cGUgPSBEYXRhVHlwZT4gZXh0ZW5kcyBMaXN0VmVjdG9yQmFzZTxMaXN0PFQ+PiB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHB1YmxpYyByZWFkb25seSB2aWV3OiBMaXN0VmlldzxUPjtcbiAgICBjb25zdHJ1Y3RvcihkYXRhOiBEYXRhPExpc3Q8VD4+LCB2aWV3OiBMaXN0VmlldzxUPiA9IG5ldyBMaXN0VmlldzxUPihkYXRhIGFzIGFueSkpIHtcbiAgICAgICAgc3VwZXIoZGF0YSwgdmlldyk7XG4gICAgfVxuICAgIHB1YmxpYyBnZXRDaGlsZEF0KGluZGV4OiBudW1iZXIpOiBWZWN0b3I8VD4gfCBudWxsIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmlldy5nZXRDaGlsZEF0PFQ+KGluZGV4KTtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBGaXhlZFNpemVMaXN0VmVjdG9yPFQgZXh0ZW5kcyBEYXRhVHlwZSA9IERhdGFUeXBlPiBleHRlbmRzIFZlY3RvcjxGaXhlZFNpemVMaXN0PFQ+PiB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHB1YmxpYyByZWFkb25seSB2aWV3OiBGaXhlZFNpemVMaXN0VmlldzxUPjtcbiAgICBjb25zdHJ1Y3RvcihkYXRhOiBEYXRhPEZpeGVkU2l6ZUxpc3Q8VD4+LCB2aWV3OiBWaWV3PEZpeGVkU2l6ZUxpc3Q8VD4+ID0gbmV3IEZpeGVkU2l6ZUxpc3RWaWV3KGRhdGEpKSB7XG4gICAgICAgIHN1cGVyKGRhdGEsIHZpZXcpO1xuICAgIH1cbiAgICBwdWJsaWMgZ2V0Q2hpbGRBdChpbmRleDogbnVtYmVyKTogVmVjdG9yPFQ+IHwgbnVsbCB7XG4gICAgICAgIHJldHVybiB0aGlzLnZpZXcuZ2V0Q2hpbGRBdDxUPihpbmRleCk7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgTWFwVmVjdG9yIGV4dGVuZHMgTmVzdGVkVmVjdG9yPE1hcF8+IHtcbiAgICBjb25zdHJ1Y3RvcihkYXRhOiBEYXRhPE1hcF8+LCB2aWV3OiBWaWV3PE1hcF8+ID0gbmV3IE1hcFZpZXcoZGF0YSkpIHtcbiAgICAgICAgc3VwZXIoZGF0YSwgdmlldyk7XG4gICAgfVxuICAgIHB1YmxpYyBhc1N0cnVjdCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTdHJ1Y3RWZWN0b3IoKHRoaXMuZGF0YSBhcyBOZXN0ZWREYXRhPGFueT4pLmNsb25lKG5ldyBTdHJ1Y3QodGhpcy50eXBlLmNoaWxkcmVuKSkpO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIFN0cnVjdFZlY3RvciBleHRlbmRzIE5lc3RlZFZlY3RvcjxTdHJ1Y3Q+IHtcbiAgICBjb25zdHJ1Y3RvcihkYXRhOiBEYXRhPFN0cnVjdD4sIHZpZXc6IFZpZXc8U3RydWN0PiA9IG5ldyBTdHJ1Y3RWaWV3KGRhdGEpKSB7XG4gICAgICAgIHN1cGVyKGRhdGEsIHZpZXcpO1xuICAgIH1cbiAgICBwdWJsaWMgYXNNYXAoa2V5c1NvcnRlZDogYm9vbGVhbiA9IGZhbHNlKSB7XG4gICAgICAgIHJldHVybiBuZXcgTWFwVmVjdG9yKCh0aGlzLmRhdGEgYXMgTmVzdGVkRGF0YTxhbnk+KS5jbG9uZShuZXcgTWFwXyhrZXlzU29ydGVkLCB0aGlzLnR5cGUuY2hpbGRyZW4pKSk7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgVW5pb25WZWN0b3I8VCBleHRlbmRzIChTcGFyc2VVbmlvbiB8IERlbnNlVW5pb24pID0gYW55PiBleHRlbmRzIE5lc3RlZFZlY3RvcjxUPiB7XG4gICAgY29uc3RydWN0b3IoZGF0YTogRGF0YTxUPiwgdmlldzogVmlldzxUPiA9IDxhbnk+IChkYXRhLnR5cGUubW9kZSA9PT0gVW5pb25Nb2RlLlNwYXJzZSA/IG5ldyBVbmlvblZpZXc8U3BhcnNlVW5pb24+KGRhdGEgYXMgRGF0YTxTcGFyc2VVbmlvbj4pIDogbmV3IERlbnNlVW5pb25WaWV3KGRhdGEgYXMgRGF0YTxEZW5zZVVuaW9uPikpKSB7XG4gICAgICAgIHN1cGVyKGRhdGEsIHZpZXcpO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIERpY3Rpb25hcnlWZWN0b3I8VCBleHRlbmRzIERhdGFUeXBlID0gRGF0YVR5cGU+IGV4dGVuZHMgVmVjdG9yPERpY3Rpb25hcnk8VD4+IHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgcHVibGljIHJlYWRvbmx5IGluZGljZXM6IFZlY3RvcjxJbnQ+O1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBwdWJsaWMgcmVhZG9ubHkgZGljdGlvbmFyeTogVmVjdG9yPFQ+O1xuICAgIGNvbnN0cnVjdG9yKGRhdGE6IERhdGE8RGljdGlvbmFyeTxUPj4sIHZpZXc6IFZpZXc8RGljdGlvbmFyeTxUPj4gPSBuZXcgRGljdGlvbmFyeVZpZXc8VD4oZGF0YS5kaWN0aW9uYXJ5LCBuZXcgSW50VmVjdG9yKGRhdGEuaW5kaWNlcykpKSB7XG4gICAgICAgIHN1cGVyKGRhdGEgYXMgRGF0YTxhbnk+LCB2aWV3KTtcbiAgICAgICAgaWYgKHZpZXcgaW5zdGFuY2VvZiBWYWxpZGl0eVZpZXcpIHtcbiAgICAgICAgICAgIHZpZXcgPSAodmlldyBhcyBhbnkpLnZpZXc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBEaWN0aW9uYXJ5RGF0YSAmJiB2aWV3IGluc3RhbmNlb2YgRGljdGlvbmFyeVZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMuaW5kaWNlcyA9IHZpZXcuaW5kaWNlcztcbiAgICAgICAgICAgIHRoaXMuZGljdGlvbmFyeSA9IGRhdGEuZGljdGlvbmFyeTtcbiAgICAgICAgfSBlbHNlIGlmIChkYXRhIGluc3RhbmNlb2YgQ2h1bmtlZERhdGEgJiYgdmlldyBpbnN0YW5jZW9mIENodW5rZWRWaWV3KSB7XG4gICAgICAgICAgICBjb25zdCBjaHVua3MgPSB2aWV3LmNodW5rVmVjdG9ycyBhcyBEaWN0aW9uYXJ5VmVjdG9yPFQ+W107XG4gICAgICAgICAgICAvLyBBc3N1bWUgdGhlIGxhc3QgY2h1bmsncyBkaWN0aW9uYXJ5IGRhdGEgaXMgdGhlIG1vc3QgdXAtdG8tZGF0ZSxcbiAgICAgICAgICAgIC8vIGluY2x1ZGluZyBkYXRhIGZyb20gRGljdGlvbmFyeUJhdGNoZXMgdGhhdCB3ZXJlIG1hcmtlZCBhcyBkZWx0YXNcbiAgICAgICAgICAgIHRoaXMuZGljdGlvbmFyeSA9IGNodW5rc1tjaHVua3MubGVuZ3RoIC0gMV0uZGljdGlvbmFyeTtcbiAgICAgICAgICAgIHRoaXMuaW5kaWNlcyA9IGNodW5rcy5yZWR1Y2U8VmVjdG9yPEludD4gfCBudWxsPihcbiAgICAgICAgICAgICAgICAoaWR4czogVmVjdG9yPEludD4gfCBudWxsLCBkaWN0OiBEaWN0aW9uYXJ5VmVjdG9yPFQ+KSA9PlxuICAgICAgICAgICAgICAgICAgICAhaWR4cyA/IGRpY3QuaW5kaWNlcyEgOiBpZHhzLmNvbmNhdChkaWN0LmluZGljZXMhKSxcbiAgICAgICAgICAgICAgICBudWxsXG4gICAgICAgICAgICApITtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYFVucmVjb2duaXplZCBEaWN0aW9uYXJ5VmVjdG9yIHZpZXdgKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwdWJsaWMgZ2V0S2V5KGluZGV4OiBudW1iZXIpIHsgcmV0dXJuIHRoaXMuaW5kaWNlcy5nZXQoaW5kZXgpOyB9XG4gICAgcHVibGljIGdldFZhbHVlKGtleTogbnVtYmVyKSB7IHJldHVybiB0aGlzLmRpY3Rpb25hcnkuZ2V0KGtleSk7IH1cbiAgICBwdWJsaWMgcmV2ZXJzZUxvb2t1cCh2YWx1ZTogVCkgeyByZXR1cm4gdGhpcy5kaWN0aW9uYXJ5LmluZGV4T2YodmFsdWUpOyB9XG59XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVWZWN0b3IgPSAoKFZlY3RvckxvYWRlcjogbmV3IDxUIGV4dGVuZHMgRGF0YVR5cGU+KGRhdGE6IERhdGE8VD4pID0+IFR5cGVWaXNpdG9yKSA9PiAoXG4gICAgPFQgZXh0ZW5kcyBEYXRhVHlwZT4oZGF0YTogRGF0YTxUPikgPT4gVHlwZVZpc2l0b3IudmlzaXRUeXBlSW5saW5lKG5ldyBWZWN0b3JMb2FkZXIoZGF0YSksIGRhdGEudHlwZSkgYXMgVmVjdG9yPFQ+XG4pKShjbGFzcyBWZWN0b3JMb2FkZXI8VCBleHRlbmRzIERhdGFUeXBlPiBleHRlbmRzIFR5cGVWaXNpdG9yIHtcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGRhdGE6IERhdGE8VD4pIHsgc3VwZXIoKTsgfVxuICAgIHZpc2l0TnVsbCAgICAgICAgICAgKF90eXBlOiBOdWxsKSAgICAgICAgICAgIHsgcmV0dXJuIG5ldyBOdWxsVmVjdG9yKDxhbnk+IHRoaXMuZGF0YSk7ICAgICAgICAgICAgfVxuICAgIHZpc2l0SW50ICAgICAgICAgICAgKF90eXBlOiBJbnQpICAgICAgICAgICAgIHsgcmV0dXJuIG5ldyBJbnRWZWN0b3IoPGFueT4gdGhpcy5kYXRhKTsgICAgICAgICAgICAgfVxuICAgIHZpc2l0RmxvYXQgICAgICAgICAgKF90eXBlOiBGbG9hdCkgICAgICAgICAgIHsgcmV0dXJuIG5ldyBGbG9hdFZlY3Rvcig8YW55PiB0aGlzLmRhdGEpOyAgICAgICAgICAgfVxuICAgIHZpc2l0QmluYXJ5ICAgICAgICAgKF90eXBlOiBCaW5hcnkpICAgICAgICAgIHsgcmV0dXJuIG5ldyBCaW5hcnlWZWN0b3IoPGFueT4gdGhpcy5kYXRhKTsgICAgICAgICAgfVxuICAgIHZpc2l0VXRmOCAgICAgICAgICAgKF90eXBlOiBVdGY4KSAgICAgICAgICAgIHsgcmV0dXJuIG5ldyBVdGY4VmVjdG9yKDxhbnk+IHRoaXMuZGF0YSk7ICAgICAgICAgICAgfVxuICAgIHZpc2l0Qm9vbCAgICAgICAgICAgKF90eXBlOiBCb29sKSAgICAgICAgICAgIHsgcmV0dXJuIG5ldyBCb29sVmVjdG9yKDxhbnk+IHRoaXMuZGF0YSk7ICAgICAgICAgICAgfVxuICAgIHZpc2l0RGVjaW1hbCAgICAgICAgKF90eXBlOiBEZWNpbWFsKSAgICAgICAgIHsgcmV0dXJuIG5ldyBEZWNpbWFsVmVjdG9yKDxhbnk+IHRoaXMuZGF0YSk7ICAgICAgICAgfVxuICAgIHZpc2l0RGF0ZSAgICAgICAgICAgKF90eXBlOiBEYXRlXykgICAgICAgICAgIHsgcmV0dXJuIG5ldyBEYXRlVmVjdG9yKDxhbnk+IHRoaXMuZGF0YSk7ICAgICAgICAgICAgfVxuICAgIHZpc2l0VGltZSAgICAgICAgICAgKF90eXBlOiBUaW1lKSAgICAgICAgICAgIHsgcmV0dXJuIG5ldyBUaW1lVmVjdG9yKDxhbnk+IHRoaXMuZGF0YSk7ICAgICAgICAgICAgfVxuICAgIHZpc2l0VGltZXN0YW1wICAgICAgKF90eXBlOiBUaW1lc3RhbXApICAgICAgIHsgcmV0dXJuIG5ldyBUaW1lc3RhbXBWZWN0b3IoPGFueT4gdGhpcy5kYXRhKTsgICAgICAgfVxuICAgIHZpc2l0SW50ZXJ2YWwgICAgICAgKF90eXBlOiBJbnRlcnZhbCkgICAgICAgIHsgcmV0dXJuIG5ldyBJbnRlcnZhbFZlY3Rvcig8YW55PiB0aGlzLmRhdGEpOyAgICAgICAgfVxuICAgIHZpc2l0TGlzdCAgICAgICAgICAgKF90eXBlOiBMaXN0KSAgICAgICAgICAgIHsgcmV0dXJuIG5ldyBMaXN0VmVjdG9yKDxhbnk+IHRoaXMuZGF0YSk7ICAgICAgICAgICAgfVxuICAgIHZpc2l0U3RydWN0ICAgICAgICAgKF90eXBlOiBTdHJ1Y3QpICAgICAgICAgIHsgcmV0dXJuIG5ldyBTdHJ1Y3RWZWN0b3IoPGFueT4gdGhpcy5kYXRhKTsgICAgICAgICAgfVxuICAgIHZpc2l0VW5pb24gICAgICAgICAgKF90eXBlOiBVbmlvbikgICAgICAgICAgIHsgcmV0dXJuIG5ldyBVbmlvblZlY3Rvcig8YW55PiB0aGlzLmRhdGEpOyAgICAgICAgICAgfVxuICAgIHZpc2l0Rml4ZWRTaXplQmluYXJ5KF90eXBlOiBGaXhlZFNpemVCaW5hcnkpIHsgcmV0dXJuIG5ldyBGaXhlZFNpemVCaW5hcnlWZWN0b3IoPGFueT4gdGhpcy5kYXRhKTsgfVxuICAgIHZpc2l0Rml4ZWRTaXplTGlzdCAgKF90eXBlOiBGaXhlZFNpemVMaXN0KSAgIHsgcmV0dXJuIG5ldyBGaXhlZFNpemVMaXN0VmVjdG9yKDxhbnk+IHRoaXMuZGF0YSk7ICAgfVxuICAgIHZpc2l0TWFwICAgICAgICAgICAgKF90eXBlOiBNYXBfKSAgICAgICAgICAgIHsgcmV0dXJuIG5ldyBNYXBWZWN0b3IoPGFueT4gdGhpcy5kYXRhKTsgICAgICAgICAgICAgfVxuICAgIHZpc2l0RGljdGlvbmFyeSAgICAgKF90eXBlOiBEaWN0aW9uYXJ5KSAgICAgIHsgcmV0dXJuIG5ldyBEaWN0aW9uYXJ5VmVjdG9yKDxhbnk+IHRoaXMuZGF0YSk7ICAgICAgfVxufSk7XG4iXX0=
