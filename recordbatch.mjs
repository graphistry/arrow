// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.  You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.
import { Data } from './data';
import { Vector } from './vector';
import { Schema } from './schema';
import { Struct } from './type';
import { StructVector } from './vector/struct';
export class RecordBatch extends Vector {
    constructor(...args) {
        super();
        this._schema = args[0];
        let data;
        let children;
        if (typeof args[1] === 'number') {
            const fields = this.schema.fields;
            const [, numRows, childData] = args;
            data = Data.Struct(new Struct(fields), 0, numRows, 0, null, childData);
        }
        else {
            [, data, children] = args;
        }
        this.impl = new StructVector(data, children);
    }
    /** @nocollapse */
    static from(vectors, names = []) {
        return new RecordBatch(Schema.from(vectors, names), vectors.reduce((len, vec) => Math.max(len, vec.length), 0), vectors);
    }
    clone(data, children = this.impl.children) {
        return new RecordBatch(this.schema, data, children);
    }
    get schema() { return this._schema; }
    get type() { return this.impl.type; }
    get data() { return this.impl.data; }
    get length() { return this.impl.length; }
    get stride() { return this.impl.stride; }
    get numCols() { return this.schema.fields.length; }
    get rowProxy() { return this.impl.rowProxy; }
    get nullCount() { return this.impl.nullCount; }
    get numChildren() { return this.impl.numChildren; }
    get TType() { return this.impl.TType; }
    get TArray() { return this.impl.TArray; }
    get TValue() { return this.impl.TValue; }
    get ArrayType() { return this.impl.ArrayType; }
    get(index) {
        return this.impl.get(index);
    }
    set(index, value) {
        this.impl.set(index, value);
    }
    isValid(index) { return this.impl.isValid(index); }
    indexOf(value, fromIndex) { return this.impl.indexOf(value, fromIndex); }
    toArray() { return this.impl.toArray(); }
    [Symbol.iterator]() { return this.impl[Symbol.iterator](); }
    slice(begin, end) {
        const { length, childData } = this.impl.slice(begin, end).data;
        return new RecordBatch(this.schema, length, childData);
    }
    concat(...others) {
        return this.impl.concat(...others.map((x) => x instanceof RecordBatch ? x.impl : x));
    }
    getChildAt(index) { return this.impl.getChildAt(index); }
    select(...columnNames) {
        const fields = this.schema.fields;
        const schema = this.schema.select(...columnNames);
        const childNames = columnNames.reduce((xs, x) => (xs[x] = true) && xs, {});
        const childData = this.data.childData.filter((_, i) => childNames[fields[i].name]);
        const structData = Data.Struct(new Struct(schema.fields), 0, this.length, 0, null, childData);
        return new RecordBatch(schema, structData);
    }
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,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TSxDQUFDLENBQUMsQ0FBQztJQUNoRCxJQUFXLE9BQU8sS0FBSyxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFDMUQsSUFBVyxRQUFRLEtBQUssT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7SUFDcEQsSUFBVyxTQUFTLEtBQUssT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7SUFDdEQsSUFBVyxXQUFXLEtBQUssT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7SUFFMUQsSUFBVyxLQUFLLEtBQUssT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDOUMsSUFBVyxNQUFNLEtBQUssT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFDaEQsSUFBVyxNQUFNLEtBQUssT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFDaEQsSUFBVyxTQUFTLEtBQUssT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7SUFFL0MsR0FBRyxDQUFDLEtBQWE7UUFDcEIsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNoQyxDQUFDO0lBQ00sR0FBRyxDQUFDLEtBQWEsRUFBRSxLQUFpQztRQUN2RCxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDaEMsQ0FBQztJQUNNLE9BQU8sQ0FBQyxLQUFhLElBQUksT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDM0QsT0FBTyxDQUFDLEtBQWlDLEVBQUUsU0FBa0IsSUFBSSxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFFOUcsT0FBTyxLQUFLLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDekMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLEtBQUssT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUU1RCxLQUFLLENBQUMsS0FBYyxFQUFFLEdBQVk7UUFDckMsTUFBTSxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUUsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDO1FBQy9ELE9BQU8sSUFBSSxXQUFXLENBQUksSUFBSSxDQUFDLE1BQU0sRUFBRSxNQUFNLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFDOUQsQ0FBQztJQUVNLE1BQU0sQ0FBQyxHQUFHLE1BQTJCO1FBQ3hDLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLFlBQVksV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQXdCLENBQUMsQ0FBQztJQUNoSCxDQUFDO0lBRU0sVUFBVSxDQUEyQixLQUFhLElBQUksT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBSSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFFOUYsTUFBTSxDQUEwQixHQUFHLFdBQWdCO1FBQ3RELE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDO1FBQ2xDLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsV0FBVyxDQUFDLENBQUM7UUFDbEQsTUFBTSxVQUFVLEdBQUcsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLEVBQUUsRUFBUSxFQUFFLENBQUMsQ0FBQztRQUNqRixNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDbkYsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxTQUFTLENBQUMsQ0FBQztRQUM5RixPQUFPLElBQUksV0FBVyxDQUFxQixNQUFNLEVBQUUsVUFBVSxDQUFDLENBQUM7SUFDbkUsQ0FBQztDQUNKIiwiZmlsZSI6InJlY29yZGJhdGNoLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZVxuLy8gb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXG4vLyBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuLy8gcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZVxuLy8gdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxuLy8gXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4vLyB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4vL1xuLy8gICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbi8vXG4vLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4vLyBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxuLy8gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbi8vIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZVxuLy8gc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xuLy8gdW5kZXIgdGhlIExpY2Vuc2UuXG5cbmltcG9ydCB7IERhdGEgfSBmcm9tICcuL2RhdGEnO1xuaW1wb3J0IHsgVmVjdG9yIH0gZnJvbSAnLi92ZWN0b3InO1xuaW1wb3J0IHsgU2NoZW1hLCBGaWVsZCB9IGZyb20gJy4vc2NoZW1hJztcbmltcG9ydCB7IERhdGFUeXBlLCBTdHJ1Y3QgfSBmcm9tICcuL3R5cGUnO1xuaW1wb3J0IHsgU3RydWN0VmVjdG9yIH0gZnJvbSAnLi92ZWN0b3Ivc3RydWN0JztcbmltcG9ydCB7IFZlY3RvciBhcyBWVHlwZSB9IGZyb20gJy4vaW50ZXJmYWNlcyc7XG5cbmV4cG9ydCBjbGFzcyBSZWNvcmRCYXRjaDxUIGV4dGVuZHMgeyBba2V5OiBzdHJpbmddOiBEYXRhVHlwZSB9ID0gYW55PiBleHRlbmRzIFZlY3RvcjxTdHJ1Y3Q8VD4+IHtcblxuICAgIC8qKiBAbm9jb2xsYXBzZSAqL1xuICAgIHB1YmxpYyBzdGF0aWMgZnJvbTxUIGV4dGVuZHMgeyBba2V5OiBzdHJpbmddOiBEYXRhVHlwZSB9ID0gYW55Pih2ZWN0b3JzOiBWVHlwZTxUW2tleW9mIFRdPltdLCBuYW1lczogKGtleW9mIFQpW10gPSBbXSkge1xuICAgICAgICByZXR1cm4gbmV3IFJlY29yZEJhdGNoKFxuICAgICAgICAgICAgU2NoZW1hLmZyb20odmVjdG9ycywgbmFtZXMpLFxuICAgICAgICAgICAgdmVjdG9ycy5yZWR1Y2UoKGxlbiwgdmVjKSA9PiBNYXRoLm1heChsZW4sIHZlYy5sZW5ndGgpLCAwKSxcbiAgICAgICAgICAgIHZlY3RvcnNcbiAgICAgICAgKTtcbiAgICB9XG4gIFxuICAgIHByb3RlY3RlZCBfc2NoZW1hOiBTY2hlbWE7XG4gICAgcHJpdmF0ZSBpbXBsOiBTdHJ1Y3RWZWN0b3I8VD47XG5cbiAgICBjb25zdHJ1Y3RvcihzY2hlbWE6IFNjaGVtYTxUPiwgbnVtUm93czogbnVtYmVyLCBjaGlsZERhdGE6IChEYXRhIHwgVmVjdG9yKVtdKTtcbiAgICBjb25zdHJ1Y3RvcihzY2hlbWE6IFNjaGVtYTxUPiwgZGF0YTogRGF0YTxTdHJ1Y3Q8VD4+LCBjaGlsZHJlbj86IFZlY3RvcltdKTtcbiAgICBjb25zdHJ1Y3RvciguLi5hcmdzOiBhbnlbXSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLl9zY2hlbWEgPSBhcmdzWzBdO1xuICAgICAgICBsZXQgZGF0YTogRGF0YTxTdHJ1Y3Q8VD4+O1xuICAgICAgICBsZXQgY2hpbGRyZW46IFZlY3RvcltdIHwgdW5kZWZpbmVkO1xuICAgICAgICBpZiAodHlwZW9mIGFyZ3NbMV0gPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZHMgPSB0aGlzLnNjaGVtYS5maWVsZHMgYXMgRmllbGQ8VFtrZXlvZiBUXT5bXTtcbiAgICAgICAgICAgIGNvbnN0IFssIG51bVJvd3MsIGNoaWxkRGF0YV0gPSBhcmdzIGFzIFtTY2hlbWE8VD4sIG51bWJlciwgRGF0YVtdXTtcbiAgICAgICAgICAgIGRhdGEgPSBEYXRhLlN0cnVjdChuZXcgU3RydWN0PFQ+KGZpZWxkcyksIDAsIG51bVJvd3MsIDAsIG51bGwsIGNoaWxkRGF0YSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBbLCBkYXRhLCBjaGlsZHJlbl0gPSAoYXJncyBhcyBbU2NoZW1hPFQ+LCBEYXRhPFN0cnVjdDxUPj4sIFZlY3RvcltdP10pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW1wbCA9IG5ldyBTdHJ1Y3RWZWN0b3IoZGF0YSwgY2hpbGRyZW4pO1xuICAgIH1cblxuICAgIHB1YmxpYyBjbG9uZTxSIGV4dGVuZHMgeyBba2V5OiBzdHJpbmddOiBEYXRhVHlwZSB9ID0gYW55PihkYXRhOiBEYXRhPFN0cnVjdDxSPj4sIGNoaWxkcmVuID0gKHRoaXMuaW1wbCBhcyBhbnkpLmNoaWxkcmVuKSB7XG4gICAgICAgIHJldHVybiBuZXcgUmVjb3JkQmF0Y2g8Uj4odGhpcy5zY2hlbWEsIGRhdGEsIGNoaWxkcmVuKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0IHNjaGVtYSgpIHsgcmV0dXJuIHRoaXMuX3NjaGVtYTsgfVxuICAgIHB1YmxpYyBnZXQgdHlwZSgpIHsgcmV0dXJuIHRoaXMuaW1wbC50eXBlOyB9XG4gICAgcHVibGljIGdldCBkYXRhKCkgeyByZXR1cm4gdGhpcy5pbXBsLmRhdGE7IH1cbiAgICBwdWJsaWMgZ2V0IGxlbmd0aCgpIHsgcmV0dXJuIHRoaXMuaW1wbC5sZW5ndGg7IH1cbiAgICBwdWJsaWMgZ2V0IHN0cmlkZSgpIHsgcmV0dXJuIHRoaXMuaW1wbC5zdHJpZGU7IH1cbiAgICBwdWJsaWMgZ2V0IG51bUNvbHMoKSB7IHJldHVybiB0aGlzLnNjaGVtYS5maWVsZHMubGVuZ3RoOyB9XG4gICAgcHVibGljIGdldCByb3dQcm94eSgpIHsgcmV0dXJuIHRoaXMuaW1wbC5yb3dQcm94eTsgfVxuICAgIHB1YmxpYyBnZXQgbnVsbENvdW50KCkgeyByZXR1cm4gdGhpcy5pbXBsLm51bGxDb3VudDsgfVxuICAgIHB1YmxpYyBnZXQgbnVtQ2hpbGRyZW4oKSB7IHJldHVybiB0aGlzLmltcGwubnVtQ2hpbGRyZW47IH1cblxuICAgIHB1YmxpYyBnZXQgVFR5cGUoKSB7IHJldHVybiB0aGlzLmltcGwuVFR5cGU7IH1cbiAgICBwdWJsaWMgZ2V0IFRBcnJheSgpIHsgcmV0dXJuIHRoaXMuaW1wbC5UQXJyYXk7IH1cbiAgICBwdWJsaWMgZ2V0IFRWYWx1ZSgpIHsgcmV0dXJuIHRoaXMuaW1wbC5UVmFsdWU7IH1cbiAgICBwdWJsaWMgZ2V0IEFycmF5VHlwZSgpIHsgcmV0dXJuIHRoaXMuaW1wbC5BcnJheVR5cGU7IH1cblxuICAgIHB1YmxpYyBnZXQoaW5kZXg6IG51bWJlcik6IFN0cnVjdDxUPlsnVFZhbHVlJ10gfCBudWxsIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW1wbC5nZXQoaW5kZXgpO1xuICAgIH1cbiAgICBwdWJsaWMgc2V0KGluZGV4OiBudW1iZXIsIHZhbHVlOiBTdHJ1Y3Q8VD5bJ1RWYWx1ZSddIHwgbnVsbCkge1xuICAgICAgICB0aGlzLmltcGwuc2V0KGluZGV4LCB2YWx1ZSk7XG4gICAgfVxuICAgIHB1YmxpYyBpc1ZhbGlkKGluZGV4OiBudW1iZXIpIHsgcmV0dXJuIHRoaXMuaW1wbC5pc1ZhbGlkKGluZGV4KTsgfVxuICAgIHB1YmxpYyBpbmRleE9mKHZhbHVlOiBTdHJ1Y3Q8VD5bJ1RWYWx1ZSddIHwgbnVsbCwgZnJvbUluZGV4PzogbnVtYmVyKSB7IHJldHVybiB0aGlzLmltcGwuaW5kZXhPZih2YWx1ZSwgZnJvbUluZGV4KTsgfVxuXG4gICAgcHVibGljIHRvQXJyYXkoKSB7IHJldHVybiB0aGlzLmltcGwudG9BcnJheSgpOyB9XG4gICAgcHVibGljIFtTeW1ib2wuaXRlcmF0b3JdKCkgeyByZXR1cm4gdGhpcy5pbXBsW1N5bWJvbC5pdGVyYXRvcl0oKTsgfVxuXG4gICAgcHVibGljIHNsaWNlKGJlZ2luPzogbnVtYmVyLCBlbmQ/OiBudW1iZXIpOiBSZWNvcmRCYXRjaDxUPiB7XG4gICAgICAgIGNvbnN0IHsgbGVuZ3RoLCBjaGlsZERhdGEgfSA9IHRoaXMuaW1wbC5zbGljZShiZWdpbiwgZW5kKS5kYXRhO1xuICAgICAgICByZXR1cm4gbmV3IFJlY29yZEJhdGNoPFQ+KHRoaXMuc2NoZW1hLCBsZW5ndGgsIGNoaWxkRGF0YSk7XG4gICAgfVxuXG4gICAgcHVibGljIGNvbmNhdCguLi5vdGhlcnM6IFZlY3RvcjxTdHJ1Y3Q8VD4+W10pOiBWZWN0b3I8U3RydWN0PFQ+PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmltcGwuY29uY2F0KC4uLm90aGVycy5tYXAoKHgpID0+IHggaW5zdGFuY2VvZiBSZWNvcmRCYXRjaCA/IHguaW1wbCA6IHgpIGFzIFZlY3RvcjxTdHJ1Y3Q8VD4+W10pO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRDaGlsZEF0PFIgZXh0ZW5kcyBEYXRhVHlwZSA9IGFueT4oaW5kZXg6IG51bWJlcikgeyByZXR1cm4gdGhpcy5pbXBsLmdldENoaWxkQXQ8Uj4oaW5kZXgpOyB9XG5cbiAgICBwdWJsaWMgc2VsZWN0PEsgZXh0ZW5kcyBrZXlvZiBUID0gYW55PiguLi5jb2x1bW5OYW1lczogS1tdKSB7XG4gICAgICAgIGNvbnN0IGZpZWxkcyA9IHRoaXMuc2NoZW1hLmZpZWxkcztcbiAgICAgICAgY29uc3Qgc2NoZW1hID0gdGhpcy5zY2hlbWEuc2VsZWN0KC4uLmNvbHVtbk5hbWVzKTtcbiAgICAgICAgY29uc3QgY2hpbGROYW1lcyA9IGNvbHVtbk5hbWVzLnJlZHVjZSgoeHMsIHgpID0+ICh4c1t4XSA9IHRydWUpICYmIHhzLCA8YW55PiB7fSk7XG4gICAgICAgIGNvbnN0IGNoaWxkRGF0YSA9IHRoaXMuZGF0YS5jaGlsZERhdGEuZmlsdGVyKChfLCBpKSA9PiBjaGlsZE5hbWVzW2ZpZWxkc1tpXS5uYW1lXSk7XG4gICAgICAgIGNvbnN0IHN0cnVjdERhdGEgPSBEYXRhLlN0cnVjdChuZXcgU3RydWN0KHNjaGVtYS5maWVsZHMpLCAwLCB0aGlzLmxlbmd0aCwgMCwgbnVsbCwgY2hpbGREYXRhKTtcbiAgICAgICAgcmV0dXJuIG5ldyBSZWNvcmRCYXRjaDx7IFtQIGluIEtdOiBUW1BdIH0+KHNjaGVtYSwgc3RydWN0RGF0YSk7XG4gICAgfVxufVxuIl19
