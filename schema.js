"use strict";
// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.  You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.
Object.defineProperty(exports, "__esModule", { value: true });
const type_1 = require("./type");
const array_1 = require("./util/array");
const typecomparator_1 = require("./visitor/typecomparator");
class Schema {
    constructor(fields = [], metadata, dictionaries, dictionaryFields) {
        this.fields = (fields || []);
        this.metadata = metadata || new Map();
        if (!dictionaries || !dictionaryFields) {
            ({ dictionaries, dictionaryFields } = generateDictionaryMap(fields, dictionaries || new Map(), dictionaryFields || new Map()));
        }
        this.dictionaries = dictionaries;
        this.dictionaryFields = dictionaryFields;
    }
    /** @nocollapse */
    static from(chunks, names = []) {
        return new Schema(chunks.map((v, i) => new Field('' + (names[i] || i), v.type)));
    }
    get [Symbol.toStringTag]() { return 'Schema'; }
    toString() {
        return `Schema<{ ${this.fields.map((f, i) => `${i}: ${f}`).join(', ')} }>`;
    }
    compareTo(other) {
        return typecomparator_1.instance.compareSchemas(this, other);
    }
    select(...columnNames) {
        const names = columnNames.reduce((xs, x) => (xs[x] = true) && xs, Object.create(null));
        return new Schema(this.fields.filter((f) => names[f.name]), this.metadata);
    }
    selectAt(...columnIndices) {
        return new Schema(columnIndices.map((i) => this.fields[i]), this.metadata);
    }
    assign(...args) {
        const other = args[0] instanceof Schema ? args[0]
            : new Schema(array_1.selectAndFlatten(Field, args));
        const curFields = [...this.fields];
        const curDictionaries = [...this.dictionaries];
        const curDictionaryFields = this.dictionaryFields;
        const metadata = mergeMaps(this.metadata, other.metadata);
        const newFields = other.fields.filter((f2) => {
            const i = curFields.findIndex((f) => f.compareTo(f2));
            return ~i ? (curFields[i] = curFields[i].clone({
                metadata: mergeMaps(curFields[i].metadata, f2.metadata)
            })) && false : true;
        });
        const { dictionaries, dictionaryFields } = generateDictionaryMap(newFields, new Map(), new Map());
        const newDictionaries = [...dictionaries].filter(([y]) => !curDictionaries.every(([x]) => x === y));
        const newDictionaryFields = [...dictionaryFields].map(([id, newDictFields]) => {
            return [id, [...(curDictionaryFields.get(id) || []), ...newDictFields.map((f) => {
                        const i = newFields.findIndex((f2) => f2.compareTo(f));
                        const { dictionary, indices, isOrdered, dictionaryVector } = f.type;
                        const type = new type_1.Dictionary(dictionary, indices, id, isOrdered, dictionaryVector);
                        return newFields[i] = f.clone({ type });
                    })]];
        });
        return new Schema([...curFields, ...newFields], metadata, new Map([...curDictionaries, ...newDictionaries]), new Map([...curDictionaryFields, ...newDictionaryFields]));
    }
}
exports.Schema = Schema;
class Field {
    constructor(name, type, nullable = false, metadata) {
        this.name = name;
        this.type = type;
        this.nullable = nullable;
        this.metadata = metadata || new Map();
    }
    get typeId() { return this.type.typeId; }
    get [Symbol.toStringTag]() { return 'Field'; }
    toString() { return `${this.name}: ${this.type}`; }
    compareTo(other) {
        return typecomparator_1.instance.compareField(this, other);
    }
    clone(props) {
        props || (props = {});
        return new Field(props.name === undefined ? this.name : props.name, props.type === undefined ? this.type : props.type, props.nullable === undefined ? this.nullable : props.nullable, props.metadata === undefined ? this.metadata : props.metadata);
    }
}
exports.Field = Field;
/** @ignore */
function mergeMaps(m1, m2) {
    return new Map([...(m1 || new Map()), ...(m2 || new Map())]);
}
/** @ignore */
function generateDictionaryMap(fields, dictionaries, dictionaryFields) {
    for (let i = -1, n = fields.length; ++i < n;) {
        const field = fields[i];
        const type = field.type;
        if (type_1.DataType.isDictionary(type)) {
            if (!dictionaryFields.get(type.id)) {
                dictionaryFields.set(type.id, []);
            }
            if (!dictionaries.has(type.id)) {
                dictionaries.set(type.id, type.dictionary);
                dictionaryFields.get(type.id).push(field);
            }
            else if (dictionaries.get(type.id) !== type.dictionary) {
                throw new Error(`Cannot create Schema containing two different dictionaries with the same Id`);
            }
        }
        if (type.children) {
            generateDictionaryMap(type.children, dictionaries, dictionaryFields);
        }
    }
    return { dictionaries, dictionaryFields };
}
// Add these here so they're picked up by the externs creator
// in the build, and closure-compiler doesn't minify them away
Schema.prototype.fields = null;
Schema.prototype.metadata = null;
Schema.prototype.dictionaries = null;
Schema.prototype.dictionaryFields = null;
Field.prototype.type = null;
Field.prototype.name = null;
Field.prototype.nullable = null;
Field.prototype.metadata = null;

//# sourceMappingURL=data:application/json;charset=utf8;base64,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aUIsQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO0FBQ3BDLEtBQUssQ0FBQyxTQUFpQixDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7QUFDcEMsS0FBSyxDQUFDLFNBQWlCLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQztBQUN4QyxLQUFLLENBQUMsU0FBaUIsQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDIiwiZmlsZSI6InNjaGVtYS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmVcbi8vIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZVxuLy8gZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb25cbi8vIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGVcbi8vIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGVcbi8vIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZVxuLy8gd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuLy9cbi8vICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4vL1xuLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLFxuLy8gc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW5cbi8vIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXG4vLyBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGVcbi8vIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnNcbi8vIHVuZGVyIHRoZSBMaWNlbnNlLlxuXG5pbXBvcnQgeyBEYXRhIH0gZnJvbSAnLi9kYXRhJztcbmltcG9ydCB7IFZlY3RvciB9IGZyb20gJy4vdmVjdG9yJztcbmltcG9ydCB7IERhdGFUeXBlLCBEaWN0aW9uYXJ5IH0gZnJvbSAnLi90eXBlJztcbmltcG9ydCB7IHNlbGVjdEFuZEZsYXR0ZW4gfSBmcm9tICcuL3V0aWwvYXJyYXknO1xuaW1wb3J0IHsgaW5zdGFuY2UgYXMgY29tcGFyZXIgfSBmcm9tICcuL3Zpc2l0b3IvdHlwZWNvbXBhcmF0b3InO1xuXG5leHBvcnQgY2xhc3MgU2NoZW1hPFQgZXh0ZW5kcyB7IFtrZXk6IHN0cmluZ106IERhdGFUeXBlIH0gPSBhbnk+IHtcblxuICAgIC8qKiBAbm9jb2xsYXBzZSAqL1xuICAgIHB1YmxpYyBzdGF0aWMgZnJvbTxUIGV4dGVuZHMgeyBba2V5OiBzdHJpbmddOiBEYXRhVHlwZSB9ID0gYW55PihjaHVua3M6IChEYXRhPFRba2V5b2YgVF0+IHwgVmVjdG9yPFRba2V5b2YgVF0+KVtdLCBuYW1lczogKGtleW9mIFQpW10gPSBbXSkge1xuICAgICAgICByZXR1cm4gbmV3IFNjaGVtYTxUPihjaHVua3MubWFwKCh2LCBpKSA9PiBuZXcgRmllbGQoJycgKyAobmFtZXNbaV0gfHwgaSksIHYudHlwZSkpKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgcmVhZG9ubHkgZmllbGRzOiBGaWVsZDxUW2tleW9mIFRdPltdO1xuICAgIHB1YmxpYyByZWFkb25seSBtZXRhZGF0YTogTWFwPHN0cmluZywgc3RyaW5nPjtcbiAgICBwdWJsaWMgcmVhZG9ubHkgZGljdGlvbmFyaWVzOiBNYXA8bnVtYmVyLCBEYXRhVHlwZT47XG4gICAgcHVibGljIHJlYWRvbmx5IGRpY3Rpb25hcnlGaWVsZHM6IE1hcDxudW1iZXIsIEZpZWxkPERpY3Rpb25hcnk+W10+O1xuXG4gICAgY29uc3RydWN0b3IoZmllbGRzOiBGaWVsZFtdID0gW10sXG4gICAgICAgICAgICAgICAgbWV0YWRhdGE/OiBNYXA8c3RyaW5nLCBzdHJpbmc+IHwgbnVsbCxcbiAgICAgICAgICAgICAgICBkaWN0aW9uYXJpZXM/OiBNYXA8bnVtYmVyLCBEYXRhVHlwZT4gfCBudWxsLFxuICAgICAgICAgICAgICAgIGRpY3Rpb25hcnlGaWVsZHM/OiBNYXA8bnVtYmVyLCBGaWVsZDxEaWN0aW9uYXJ5PltdPiB8IG51bGwpIHtcbiAgICAgICAgdGhpcy5maWVsZHMgPSAoZmllbGRzIHx8IFtdKSBhcyBGaWVsZDxUW2tleW9mIFRdPltdO1xuICAgICAgICB0aGlzLm1ldGFkYXRhID0gbWV0YWRhdGEgfHwgbmV3IE1hcCgpO1xuICAgICAgICBpZiAoIWRpY3Rpb25hcmllcyB8fCAhZGljdGlvbmFyeUZpZWxkcykge1xuICAgICAgICAgICAgKHsgZGljdGlvbmFyaWVzLCBkaWN0aW9uYXJ5RmllbGRzIH0gPSBnZW5lcmF0ZURpY3Rpb25hcnlNYXAoXG4gICAgICAgICAgICAgICAgZmllbGRzLCBkaWN0aW9uYXJpZXMgfHwgbmV3IE1hcCgpLCBkaWN0aW9uYXJ5RmllbGRzIHx8IG5ldyBNYXAoKVxuICAgICAgICAgICAgKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kaWN0aW9uYXJpZXMgPSBkaWN0aW9uYXJpZXM7XG4gICAgICAgIHRoaXMuZGljdGlvbmFyeUZpZWxkcyA9IGRpY3Rpb25hcnlGaWVsZHM7XG4gICAgfVxuICAgIHB1YmxpYyBnZXQgW1N5bWJvbC50b1N0cmluZ1RhZ10oKSB7IHJldHVybiAnU2NoZW1hJzsgfVxuICAgIHB1YmxpYyB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIGBTY2hlbWE8eyAke3RoaXMuZmllbGRzLm1hcCgoZiwgaSkgPT4gYCR7aX06ICR7Zn1gKS5qb2luKCcsICcpfSB9PmA7XG4gICAgfVxuXG4gICAgcHVibGljIGNvbXBhcmVUbyhvdGhlcj86IFNjaGVtYSB8IG51bGwpOiBvdGhlciBpcyBTY2hlbWE8VD4ge1xuICAgICAgICByZXR1cm4gY29tcGFyZXIuY29tcGFyZVNjaGVtYXModGhpcywgb3RoZXIpO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZWxlY3Q8SyBleHRlbmRzIGtleW9mIFQgPSBhbnk+KC4uLmNvbHVtbk5hbWVzOiBLW10pIHtcbiAgICAgICAgY29uc3QgbmFtZXMgPSBjb2x1bW5OYW1lcy5yZWR1Y2UoKHhzLCB4KSA9PiAoeHNbeF0gPSB0cnVlKSAmJiB4cywgT2JqZWN0LmNyZWF0ZShudWxsKSk7XG4gICAgICAgIHJldHVybiBuZXcgU2NoZW1hPHsgW1AgaW4gS106IFRbUF0gfT4odGhpcy5maWVsZHMuZmlsdGVyKChmKSA9PiBuYW1lc1tmLm5hbWVdKSwgdGhpcy5tZXRhZGF0YSk7XG4gICAgfVxuICAgIHB1YmxpYyBzZWxlY3RBdDxLIGV4dGVuZHMgVFtrZXlvZiBUXSA9IGFueT4oLi4uY29sdW1uSW5kaWNlczogbnVtYmVyW10pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTY2hlbWE8eyBba2V5OiBzdHJpbmddOiBLIH0+KGNvbHVtbkluZGljZXMubWFwKChpKSA9PiB0aGlzLmZpZWxkc1tpXSksIHRoaXMubWV0YWRhdGEpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3NpZ248UiBleHRlbmRzIHsgW2tleTogc3RyaW5nXTogRGF0YVR5cGUgfSA9IGFueT4oc2NoZW1hOiBTY2hlbWE8Uj4pOiBTY2hlbWE8VCAmIFI+O1xuICAgIHB1YmxpYyBhc3NpZ248UiBleHRlbmRzIHsgW2tleTogc3RyaW5nXTogRGF0YVR5cGUgfSA9IGFueT4oLi4uZmllbGRzOiAoRmllbGQ8UltrZXlvZiBSXT4gfCBGaWVsZDxSW2tleW9mIFJdPltdKVtdKTogU2NoZW1hPFQgJiBSPjtcbiAgICBwdWJsaWMgYXNzaWduPFIgZXh0ZW5kcyB7IFtrZXk6IHN0cmluZ106IERhdGFUeXBlIH0gPSBhbnk+KC4uLmFyZ3M6IChTY2hlbWE8Uj4gfCBGaWVsZDxSW2tleW9mIFJdPiB8IEZpZWxkPFJba2V5b2YgUl0+W10pW10pIHtcblxuICAgICAgICBjb25zdCBvdGhlciA9IGFyZ3NbMF0gaW5zdGFuY2VvZiBTY2hlbWEgPyBhcmdzWzBdIGFzIFNjaGVtYTxSPlxuICAgICAgICAgICAgOiBuZXcgU2NoZW1hPFI+KHNlbGVjdEFuZEZsYXR0ZW48RmllbGQ8UltrZXlvZiBSXT4+KEZpZWxkLCBhcmdzKSk7XG5cbiAgICAgICAgY29uc3QgY3VyRmllbGRzID0gWy4uLnRoaXMuZmllbGRzXSBhcyBGaWVsZFtdO1xuICAgICAgICBjb25zdCBjdXJEaWN0aW9uYXJpZXMgPSBbLi4udGhpcy5kaWN0aW9uYXJpZXNdO1xuICAgICAgICBjb25zdCBjdXJEaWN0aW9uYXJ5RmllbGRzID0gdGhpcy5kaWN0aW9uYXJ5RmllbGRzO1xuICAgICAgICBjb25zdCBtZXRhZGF0YSA9IG1lcmdlTWFwcyh0aGlzLm1ldGFkYXRhLCBvdGhlci5tZXRhZGF0YSk7XG4gICAgICAgIGNvbnN0IG5ld0ZpZWxkcyA9IG90aGVyLmZpZWxkcy5maWx0ZXIoKGYyKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gY3VyRmllbGRzLmZpbmRJbmRleCgoZikgPT4gZi5jb21wYXJlVG8oZjIpKTtcbiAgICAgICAgICAgIHJldHVybiB+aSA/IChjdXJGaWVsZHNbaV0gPSBjdXJGaWVsZHNbaV0uY2xvbmUoe1xuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiBtZXJnZU1hcHMoY3VyRmllbGRzW2ldLm1ldGFkYXRhLCBmMi5tZXRhZGF0YSlcbiAgICAgICAgICAgIH0pKSAmJiBmYWxzZSA6IHRydWU7XG4gICAgICAgIH0pIGFzIEZpZWxkW107XG5cbiAgICAgICAgY29uc3QgeyBkaWN0aW9uYXJpZXMsIGRpY3Rpb25hcnlGaWVsZHMgfSA9IGdlbmVyYXRlRGljdGlvbmFyeU1hcChuZXdGaWVsZHMsIG5ldyBNYXAoKSwgbmV3IE1hcCgpKTtcbiAgICAgICAgY29uc3QgbmV3RGljdGlvbmFyaWVzID0gWy4uLmRpY3Rpb25hcmllc10uZmlsdGVyKChbeV0pID0+ICFjdXJEaWN0aW9uYXJpZXMuZXZlcnkoKFt4XSkgPT4geCA9PT0geSkpO1xuICAgICAgICBjb25zdCBuZXdEaWN0aW9uYXJ5RmllbGRzID0gWy4uLmRpY3Rpb25hcnlGaWVsZHNdLm1hcCgoW2lkLCBuZXdEaWN0RmllbGRzXSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIFtpZCwgWy4uLihjdXJEaWN0aW9uYXJ5RmllbGRzLmdldChpZCkgfHwgW10pLCAuLi5uZXdEaWN0RmllbGRzLm1hcCgoZikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuZXdGaWVsZHMuZmluZEluZGV4KChmMikgPT4gZjIuY29tcGFyZVRvKGYpKTtcbiAgICAgICAgICAgICAgICBjb25zdCB7IGRpY3Rpb25hcnksIGluZGljZXMsIGlzT3JkZXJlZCwgZGljdGlvbmFyeVZlY3RvciB9ID0gZi50eXBlO1xuICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBuZXcgRGljdGlvbmFyeShkaWN0aW9uYXJ5LCBpbmRpY2VzLCBpZCwgaXNPcmRlcmVkLCBkaWN0aW9uYXJ5VmVjdG9yKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3RmllbGRzW2ldID0gZi5jbG9uZSh7IHR5cGUgfSk7XG4gICAgICAgICAgICB9KV1dIGFzIFtudW1iZXIsIEZpZWxkPERpY3Rpb25hcnk+W11dO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gbmV3IFNjaGVtYTxUICYgUj4oXG4gICAgICAgICAgICBbLi4uY3VyRmllbGRzLCAuLi5uZXdGaWVsZHNdLCBtZXRhZGF0YSxcbiAgICAgICAgICAgIG5ldyBNYXAoWy4uLmN1ckRpY3Rpb25hcmllcywgLi4ubmV3RGljdGlvbmFyaWVzXSksXG4gICAgICAgICAgICBuZXcgTWFwKFsuLi5jdXJEaWN0aW9uYXJ5RmllbGRzLCAuLi5uZXdEaWN0aW9uYXJ5RmllbGRzXSlcbiAgICAgICAgKTtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBGaWVsZDxUIGV4dGVuZHMgRGF0YVR5cGUgPSBEYXRhVHlwZT4ge1xuXG4gICAgcHVibGljIHJlYWRvbmx5IHR5cGU6IFQ7XG4gICAgcHVibGljIHJlYWRvbmx5IG5hbWU6IHN0cmluZztcbiAgICBwdWJsaWMgcmVhZG9ubHkgbnVsbGFibGU6IGJvb2xlYW47XG4gICAgcHVibGljIHJlYWRvbmx5IG1ldGFkYXRhOiBNYXA8c3RyaW5nLCBzdHJpbmc+O1xuXG4gICAgY29uc3RydWN0b3IobmFtZTogc3RyaW5nLCB0eXBlOiBULCBudWxsYWJsZSA9IGZhbHNlLCBtZXRhZGF0YT86IE1hcDxzdHJpbmcsIHN0cmluZz4gfCBudWxsKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMudHlwZSA9IHR5cGU7XG4gICAgICAgIHRoaXMubnVsbGFibGUgPSBudWxsYWJsZTtcbiAgICAgICAgdGhpcy5tZXRhZGF0YSA9IG1ldGFkYXRhIHx8IG5ldyBNYXAoKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0IHR5cGVJZCgpIHsgcmV0dXJuIHRoaXMudHlwZS50eXBlSWQ7IH1cbiAgICBwdWJsaWMgZ2V0IFtTeW1ib2wudG9TdHJpbmdUYWddKCkgeyByZXR1cm4gJ0ZpZWxkJzsgfVxuICAgIHB1YmxpYyB0b1N0cmluZygpIHsgcmV0dXJuIGAke3RoaXMubmFtZX06ICR7dGhpcy50eXBlfWA7IH1cbiAgICBwdWJsaWMgY29tcGFyZVRvKG90aGVyPzogRmllbGQgfCBudWxsKTogb3RoZXIgaXMgRmllbGQ8VD4ge1xuICAgICAgICByZXR1cm4gY29tcGFyZXIuY29tcGFyZUZpZWxkKHRoaXMsIG90aGVyKTtcbiAgICB9XG4gICAgcHVibGljIGNsb25lPFIgZXh0ZW5kcyBEYXRhVHlwZSA9IFQ+KHByb3BzPzogeyBuYW1lPzogc3RyaW5nLCB0eXBlPzogUiwgbnVsbGFibGU/OiBib29sZWFuLCBtZXRhZGF0YT86IE1hcDxzdHJpbmcsIHN0cmluZz4gfCBudWxsIH0pOiBGaWVsZDxSPiB7XG4gICAgICAgIHByb3BzIHx8IChwcm9wcyA9IHt9KTtcbiAgICAgICAgcmV0dXJuIG5ldyBGaWVsZDxSPihcbiAgICAgICAgICAgIHByb3BzLm5hbWUgPT09IHVuZGVmaW5lZCA/IHRoaXMubmFtZSA6IHByb3BzLm5hbWUsXG4gICAgICAgICAgICBwcm9wcy50eXBlID09PSB1bmRlZmluZWQgPyB0aGlzLnR5cGUgOiBwcm9wcy50eXBlIGFzIGFueSxcbiAgICAgICAgICAgIHByb3BzLm51bGxhYmxlID09PSB1bmRlZmluZWQgPyB0aGlzLm51bGxhYmxlIDogcHJvcHMubnVsbGFibGUsXG4gICAgICAgICAgICBwcm9wcy5tZXRhZGF0YSA9PT0gdW5kZWZpbmVkID8gdGhpcy5tZXRhZGF0YSA6IHByb3BzLm1ldGFkYXRhKTtcbiAgICB9XG59XG5cbi8qKiBAaWdub3JlICovXG5mdW5jdGlvbiBtZXJnZU1hcHM8VEtleSwgVFZhbD4obTE/OiBNYXA8VEtleSwgVFZhbD4gfCBudWxsLCBtMj86IE1hcDxUS2V5LCBUVmFsPiB8IG51bGwpOiBNYXA8VEtleSwgVFZhbD4ge1xuICAgIHJldHVybiBuZXcgTWFwKFsuLi4obTEgfHwgbmV3IE1hcCgpKSwgLi4uKG0yIHx8IG5ldyBNYXAoKSldKTtcbn1cblxuLyoqIEBpZ25vcmUgKi9cbmZ1bmN0aW9uIGdlbmVyYXRlRGljdGlvbmFyeU1hcChmaWVsZHM6IEZpZWxkW10sIGRpY3Rpb25hcmllczogTWFwPG51bWJlciwgRGF0YVR5cGU+LCBkaWN0aW9uYXJ5RmllbGRzOiBNYXA8bnVtYmVyLCBGaWVsZDxEaWN0aW9uYXJ5PltdPikge1xuXG4gICAgZm9yIChsZXQgaSA9IC0xLCBuID0gZmllbGRzLmxlbmd0aDsgKytpIDwgbjspIHtcbiAgICAgICAgY29uc3QgZmllbGQgPSBmaWVsZHNbaV07XG4gICAgICAgIGNvbnN0IHR5cGUgPSBmaWVsZC50eXBlO1xuICAgICAgICBpZiAoRGF0YVR5cGUuaXNEaWN0aW9uYXJ5KHR5cGUpKSB7XG4gICAgICAgICAgICBpZiAoIWRpY3Rpb25hcnlGaWVsZHMuZ2V0KHR5cGUuaWQpKSB7XG4gICAgICAgICAgICAgICAgZGljdGlvbmFyeUZpZWxkcy5zZXQodHlwZS5pZCwgW10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFkaWN0aW9uYXJpZXMuaGFzKHR5cGUuaWQpKSB7XG4gICAgICAgICAgICAgICAgZGljdGlvbmFyaWVzLnNldCh0eXBlLmlkLCB0eXBlLmRpY3Rpb25hcnkpO1xuICAgICAgICAgICAgICAgIGRpY3Rpb25hcnlGaWVsZHMuZ2V0KHR5cGUuaWQpIS5wdXNoKGZpZWxkIGFzIGFueSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRpY3Rpb25hcmllcy5nZXQodHlwZS5pZCkgIT09IHR5cGUuZGljdGlvbmFyeSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGNyZWF0ZSBTY2hlbWEgY29udGFpbmluZyB0d28gZGlmZmVyZW50IGRpY3Rpb25hcmllcyB3aXRoIHRoZSBzYW1lIElkYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGUuY2hpbGRyZW4pIHtcbiAgICAgICAgICAgIGdlbmVyYXRlRGljdGlvbmFyeU1hcCh0eXBlLmNoaWxkcmVuLCBkaWN0aW9uYXJpZXMsIGRpY3Rpb25hcnlGaWVsZHMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgZGljdGlvbmFyaWVzLCBkaWN0aW9uYXJ5RmllbGRzIH07XG59XG5cbi8vIEFkZCB0aGVzZSBoZXJlIHNvIHRoZXkncmUgcGlja2VkIHVwIGJ5IHRoZSBleHRlcm5zIGNyZWF0b3Jcbi8vIGluIHRoZSBidWlsZCwgYW5kIGNsb3N1cmUtY29tcGlsZXIgZG9lc24ndCBtaW5pZnkgdGhlbSBhd2F5XG4oU2NoZW1hLnByb3RvdHlwZSBhcyBhbnkpLmZpZWxkcyA9IG51bGw7XG4oU2NoZW1hLnByb3RvdHlwZSBhcyBhbnkpLm1ldGFkYXRhID0gbnVsbDtcbihTY2hlbWEucHJvdG90eXBlIGFzIGFueSkuZGljdGlvbmFyaWVzID0gbnVsbDtcbihTY2hlbWEucHJvdG90eXBlIGFzIGFueSkuZGljdGlvbmFyeUZpZWxkcyA9IG51bGw7XG5cbihGaWVsZC5wcm90b3R5cGUgYXMgYW55KS50eXBlID0gbnVsbDtcbihGaWVsZC5wcm90b3R5cGUgYXMgYW55KS5uYW1lID0gbnVsbDtcbihGaWVsZC5wcm90b3R5cGUgYXMgYW55KS5udWxsYWJsZSA9IG51bGw7XG4oRmllbGQucHJvdG90eXBlIGFzIGFueSkubWV0YWRhdGEgPSBudWxsO1xuIl19
