// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.  You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.
import * as tslib_1 from "tslib";
import { flatbuffers } from 'flatbuffers';
import { TypeDataLoader } from './vector';
import { checkForMagicArrowString, PADDING, magicAndPadding, isValidArrowFile } from '../magic';
import { Message, Footer, FileBlock, RecordBatchMetadata, DictionaryBatch, BufferMetadata, FieldMetadata, } from '../metadata';
import { Schema, Field, Dictionary, Null, Binary, Bool, Utf8, Decimal, Date_, Time, Timestamp, Interval, List, Struct, Union, FixedSizeBinary, FixedSizeList, Map_, } from '../../type';
import { Int8, Uint8, Int16, Uint16, Int32, Uint32, Int64, Uint64, Float16, Float64, Float32, } from '../../type';
var ByteBuffer = flatbuffers.ByteBuffer;
export function* readBuffers(sources) {
    let schema = null;
    let dictionaries = new Map();
    let readMessages = null;
    if (ArrayBuffer.isView(sources) || typeof sources === 'string') {
        sources = [sources];
    }
    for (const source of sources) {
        const bb = toByteBuffer(source);
        if ((!schema && ({ schema, readMessages } = readSchema(bb)) || true) && schema && readMessages) {
            for (const message of readMessages(bb)) {
                yield {
                    schema, message,
                    loader: new BinaryDataLoader(bb, arrayIterator(message.nodes || []), arrayIterator(message.buffers || []), dictionaries)
                };
            }
        }
    }
}
export function readBuffersAsync(sources) {
    return tslib_1.__asyncGenerator(this, arguments, function* readBuffersAsync_1() {
        var e_1, _a;
        let schema = null;
        let dictionaries = new Map();
        let readMessages = null;
        try {
            for (var sources_1 = tslib_1.__asyncValues(sources), sources_1_1; sources_1_1 = yield tslib_1.__await(sources_1.next()), !sources_1_1.done;) {
                const source = sources_1_1.value;
                const bb = toByteBuffer(source);
                if ((!schema && ({ schema, readMessages } = readSchema(bb)) || true) && schema && readMessages) {
                    for (const message of readMessages(bb)) {
                        yield yield tslib_1.__await({
                            schema, message,
                            loader: new BinaryDataLoader(bb, arrayIterator(message.nodes || []), arrayIterator(message.buffers || []), dictionaries)
                        });
                    }
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (sources_1_1 && !sources_1_1.done && (_a = sources_1.return)) yield tslib_1.__await(_a.call(sources_1));
            }
            finally { if (e_1) throw e_1.error; }
        }
    });
}
export class BinaryDataLoader extends TypeDataLoader {
    constructor(bb, nodes, buffers, dictionaries) {
        super(nodes, buffers, dictionaries);
        this.bytes = bb.bytes();
        this.messageOffset = bb.position();
    }
    readOffsets(type, buffer) { return this.readData(type, buffer); }
    readTypeIds(type, buffer) { return this.readData(type, buffer); }
    readData(_type, { length, offset } = this.getBufferMetadata()) {
        return new Uint8Array(this.bytes.buffer, this.bytes.byteOffset + this.messageOffset + offset, length);
    }
}
function* arrayIterator(arr) { yield* arr; }
function toByteBuffer(bytes) {
    let arr = bytes || new Uint8Array(0);
    if (typeof bytes === 'string') {
        arr = new Uint8Array(bytes.length);
        for (let i = -1, n = bytes.length; ++i < n;) {
            arr[i] = bytes.charCodeAt(i);
        }
        return new ByteBuffer(arr);
    }
    return new ByteBuffer(arr);
}
function readSchema(bb) {
    let schema, readMessages, footer;
    if (footer = readFileSchema(bb)) {
        schema = footer.schema;
        readMessages = readFileMessages(footer);
    }
    else if (schema = readStreamSchema(bb)) {
        readMessages = readStreamMessages;
    }
    else {
        throw new Error('Invalid Arrow buffer');
    }
    return { schema, readMessages };
}
function readStreamSchema(bb) {
    if (!checkForMagicArrowString(bb.bytes(), 0)) {
        for (const message of readMessages(bb)) {
            if (Message.isSchema(message)) {
                return message;
            }
        }
    }
    return null;
}
function* readStreamMessages(bb) {
    for (const message of readMessages(bb)) {
        if (Message.isRecordBatch(message)) {
            yield message;
        }
        else if (Message.isDictionaryBatch(message)) {
            yield message;
        }
        else {
            yield message;
        }
        // position the buffer after the body to read the next message
        bb.setPosition(bb.position() + message.bodyLength);
    }
}
function readFileSchema(bb) {
    if (!isValidArrowFile(bb)) {
        return null;
    }
    let fileLength = bb.capacity();
    let lengthOffset = fileLength - magicAndPadding;
    let footerLength = bb.readInt32(lengthOffset);
    bb.setPosition(lengthOffset - footerLength);
    return footerFromByteBuffer(bb);
}
function readFileMessages(footer) {
    return function* (bb) {
        let message;
        for (let i = -1, batches = footer.dictionaryBatches, n = batches.length; ++i < n;) {
            bb.setPosition(batches[i].offset);
            if (message = readMessage(bb, bb.readInt32(bb.position()))) {
                yield message;
            }
        }
        for (let i = -1, batches = footer.recordBatches, n = batches.length; ++i < n;) {
            bb.setPosition(batches[i].offset);
            if (message = readMessage(bb, bb.readInt32(bb.position()))) {
                yield message;
            }
        }
    };
}
function* readMessages(bb) {
    let length, message;
    while (bb.position() < bb.capacity() &&
        (length = bb.readInt32(bb.position())) > 0) {
        if (message = readMessage(bb, length)) {
            yield message;
        }
    }
}
function readMessage(bb, length) {
    bb.setPosition(bb.position() + PADDING);
    const message = messageFromByteBuffer(bb);
    bb.setPosition(bb.position() + length);
    return message;
}
import * as File_ from '../../fb/File';
import * as Schema_ from '../../fb/Schema';
import * as Message_ from '../../fb/Message';
var Type = Schema_.org.apache.arrow.flatbuf.Type;
var Precision = Schema_.org.apache.arrow.flatbuf.Precision;
var MessageHeader = Message_.org.apache.arrow.flatbuf.MessageHeader;
var MetadataVersion = Schema_.org.apache.arrow.flatbuf.MetadataVersion;
var _Footer = File_.org.apache.arrow.flatbuf.Footer;
var _Message = Message_.org.apache.arrow.flatbuf.Message;
var _Schema = Schema_.org.apache.arrow.flatbuf.Schema;
var _RecordBatch = Message_.org.apache.arrow.flatbuf.RecordBatch;
var _DictionaryBatch = Message_.org.apache.arrow.flatbuf.DictionaryBatch;
var _Null = Schema_.org.apache.arrow.flatbuf.Null;
var _Int = Schema_.org.apache.arrow.flatbuf.Int;
var _FloatingPoint = Schema_.org.apache.arrow.flatbuf.FloatingPoint;
var _Binary = Schema_.org.apache.arrow.flatbuf.Binary;
var _Bool = Schema_.org.apache.arrow.flatbuf.Bool;
var _Utf8 = Schema_.org.apache.arrow.flatbuf.Utf8;
var _Decimal = Schema_.org.apache.arrow.flatbuf.Decimal;
var _Date = Schema_.org.apache.arrow.flatbuf.Date;
var _Time = Schema_.org.apache.arrow.flatbuf.Time;
var _Timestamp = Schema_.org.apache.arrow.flatbuf.Timestamp;
var _Interval = Schema_.org.apache.arrow.flatbuf.Interval;
var _List = Schema_.org.apache.arrow.flatbuf.List;
var _Struct = Schema_.org.apache.arrow.flatbuf.Struct_;
var _Union = Schema_.org.apache.arrow.flatbuf.Union;
var _FixedSizeBinary = Schema_.org.apache.arrow.flatbuf.FixedSizeBinary;
var _FixedSizeList = Schema_.org.apache.arrow.flatbuf.FixedSizeList;
var _Map = Schema_.org.apache.arrow.flatbuf.Map;
function footerFromByteBuffer(bb) {
    const dictionaryFields = new Map();
    const f = _Footer.getRootAsFooter(bb), s = f.schema();
    return new Footer(dictionaryBatchesFromFooter(f), recordBatchesFromFooter(f), new Schema(fieldsFromSchema(s, dictionaryFields), customMetadata(s), f.version(), dictionaryFields));
}
function messageFromByteBuffer(bb) {
    const m = _Message.getRootAsMessage(bb), type = m.headerType(), version = m.version();
    switch (type) {
        case MessageHeader.Schema: return schemaFromMessage(version, m.header(new _Schema()), new Map());
        case MessageHeader.RecordBatch: return recordBatchFromMessage(version, m, m.header(new _RecordBatch()));
        case MessageHeader.DictionaryBatch: return dictionaryBatchFromMessage(version, m, m.header(new _DictionaryBatch()));
    }
    return null;
    // throw new Error(`Unrecognized Message type '${type}'`);
}
function schemaFromMessage(version, s, dictionaryFields) {
    return new Schema(fieldsFromSchema(s, dictionaryFields), customMetadata(s), version, dictionaryFields);
}
function recordBatchFromMessage(version, m, b) {
    return new RecordBatchMetadata(version, b.length(), fieldNodesFromRecordBatch(b), buffersFromRecordBatch(b, version), m.bodyLength());
}
function dictionaryBatchFromMessage(version, m, d) {
    return new DictionaryBatch(version, recordBatchFromMessage(version, m, d.data()), d.id(), d.isDelta());
}
function dictionaryBatchesFromFooter(f) {
    const blocks = [];
    for (let b, i = -1, n = f && f.dictionariesLength(); ++i < n;) {
        if (b = f.dictionaries(i)) {
            blocks.push(new FileBlock(b.metaDataLength(), b.bodyLength(), b.offset()));
        }
    }
    return blocks;
}
function recordBatchesFromFooter(f) {
    const blocks = [];
    for (let b, i = -1, n = f && f.recordBatchesLength(); ++i < n;) {
        if (b = f.recordBatches(i)) {
            blocks.push(new FileBlock(b.metaDataLength(), b.bodyLength(), b.offset()));
        }
    }
    return blocks;
}
function fieldsFromSchema(s, dictionaryFields) {
    const fields = [];
    for (let i = -1, c, n = s && s.fieldsLength(); ++i < n;) {
        if (c = field(s.fields(i), dictionaryFields)) {
            fields.push(c);
        }
    }
    return fields;
}
function fieldsFromField(f, dictionaryFields) {
    const fields = [];
    for (let i = -1, c, n = f && f.childrenLength(); ++i < n;) {
        if (c = field(f.children(i), dictionaryFields)) {
            fields.push(c);
        }
    }
    return fields;
}
function fieldNodesFromRecordBatch(b) {
    const fieldNodes = [];
    for (let i = -1, n = b.nodesLength(); ++i < n;) {
        fieldNodes.push(fieldNodeFromRecordBatch(b.nodes(i)));
    }
    return fieldNodes;
}
function buffersFromRecordBatch(b, version) {
    const buffers = [];
    for (let i = -1, n = b.buffersLength(); ++i < n;) {
        let buffer = b.buffers(i);
        // If this Arrow buffer was written before version 4,
        // advance the buffer's bb_pos 8 bytes to skip past
        // the now-removed page id field.
        if (version < MetadataVersion.V4) {
            buffer.bb_pos += (8 * (i + 1));
        }
        buffers.push(bufferFromRecordBatch(buffer));
    }
    return buffers;
}
function field(f, dictionaryFields) {
    let name = f.name();
    let field;
    let nullable = f.nullable();
    let metadata = customMetadata(f);
    let dataType;
    let keysMeta, id;
    let dictMeta;
    if (!dictionaryFields || !(dictMeta = f.dictionary())) {
        if (dataType = typeFromField(f, fieldsFromField(f, dictionaryFields))) {
            field = new Field(name, dataType, nullable, metadata);
        }
    }
    else if (dataType = dictionaryFields.has(id = dictMeta.id().low)
        ? dictionaryFields.get(id).type.dictionary
        : typeFromField(f, fieldsFromField(f, null))) {
        dataType = new Dictionary(dataType, 
        // a dictionary index defaults to signed 32 bit int if unspecified
        (keysMeta = dictMeta.indexType()) ? intFromField(keysMeta) : new Int32(), id, dictMeta.isOrdered());
        field = new Field(name, dataType, nullable, metadata);
        dictionaryFields.has(id) || dictionaryFields.set(id, field);
    }
    return field || null;
}
function customMetadata(parent) {
    const data = new Map();
    if (parent) {
        for (let entry, key, i = -1, n = parent.customMetadataLength() | 0; ++i < n;) {
            if ((entry = parent.customMetadata(i)) && (key = entry.key()) != null) {
                data.set(key, entry.value());
            }
        }
    }
    return data;
}
function fieldNodeFromRecordBatch(f) {
    return new FieldMetadata(f.length(), f.nullCount());
}
function bufferFromRecordBatch(b) {
    return new BufferMetadata(b.offset(), b.length());
}
function typeFromField(f, children) {
    switch (f.typeType()) {
        case Type.NONE: return null;
        case Type.Null: return nullFromField(f.type(new _Null()));
        case Type.Int: return intFromField(f.type(new _Int()));
        case Type.FloatingPoint: return floatFromField(f.type(new _FloatingPoint()));
        case Type.Binary: return binaryFromField(f.type(new _Binary()));
        case Type.Utf8: return utf8FromField(f.type(new _Utf8()));
        case Type.Bool: return boolFromField(f.type(new _Bool()));
        case Type.Decimal: return decimalFromField(f.type(new _Decimal()));
        case Type.Date: return dateFromField(f.type(new _Date()));
        case Type.Time: return timeFromField(f.type(new _Time()));
        case Type.Timestamp: return timestampFromField(f.type(new _Timestamp()));
        case Type.Interval: return intervalFromField(f.type(new _Interval()));
        case Type.List: return listFromField(f.type(new _List()), children || []);
        case Type.Struct_: return structFromField(f.type(new _Struct()), children || []);
        case Type.Union: return unionFromField(f.type(new _Union()), children || []);
        case Type.FixedSizeBinary: return fixedSizeBinaryFromField(f.type(new _FixedSizeBinary()));
        case Type.FixedSizeList: return fixedSizeListFromField(f.type(new _FixedSizeList()), children || []);
        case Type.Map: return mapFromField(f.type(new _Map()), children || []);
    }
    throw new Error(`Unrecognized type ${f.typeType()}`);
}
function nullFromField(_type) { return new Null(); }
function intFromField(_type) {
    switch (_type.bitWidth()) {
        case 8: return _type.isSigned() ? new Int8() : new Uint8();
        case 16: return _type.isSigned() ? new Int16() : new Uint16();
        case 32: return _type.isSigned() ? new Int32() : new Uint32();
        case 64: return _type.isSigned() ? new Int64() : new Uint64();
    }
    return null;
}
function floatFromField(_type) {
    switch (_type.precision()) {
        case Precision.HALF: return new Float16();
        case Precision.SINGLE: return new Float32();
        case Precision.DOUBLE: return new Float64();
    }
    return null;
}
function binaryFromField(_type) { return new Binary(); }
function utf8FromField(_type) { return new Utf8(); }
function boolFromField(_type) { return new Bool(); }
function decimalFromField(_type) { return new Decimal(_type.scale(), _type.precision()); }
function dateFromField(_type) { return new Date_(_type.unit()); }
function timeFromField(_type) { return new Time(_type.unit(), _type.bitWidth()); }
function timestampFromField(_type) { return new Timestamp(_type.unit(), _type.timezone()); }
function intervalFromField(_type) { return new Interval(_type.unit()); }
function listFromField(_type, children) { return new List(children); }
function structFromField(_type, children) { return new Struct(children); }
function unionFromField(_type, children) { return new Union(_type.mode(), (_type.typeIdsArray() || []), children); }
function fixedSizeBinaryFromField(_type) { return new FixedSizeBinary(_type.byteWidth()); }
function fixedSizeListFromField(_type, children) { return new FixedSizeList(_type.listSize(), children); }
function mapFromField(_type, children) { return new Map_(_type.keysSorted(), children); }

//# sourceMappingURL=data:application/json;charset=utf8;base64,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RyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUN6RCxJQUFPLEtBQUssR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQztBQUNyRCxJQUFPLEtBQUssR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQztBQUNyRCxJQUFPLFFBQVEsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQztBQUMzRCxJQUFPLEtBQUssR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQztBQUNyRCxJQUFPLEtBQUssR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQztBQUNyRCxJQUFPLFVBQVUsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUMvRCxJQUFPLFNBQVMsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQztBQUM3RCxJQUFPLEtBQUssR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQztBQUNyRCxJQUFPLE9BQU8sR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQztBQUMxRCxJQUFPLE1BQU0sR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQztBQUN2RCxJQUFPLGdCQUFnQixHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMs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QUM7QUFDakssc0JBQWtDLEtBQVcsRUFBRSxRQUFpQixJQUFjLE9BQU8sSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBRSxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQW9DLENBQUMiLCJmaWxlIjoiaXBjL3JlYWRlci9iaW5hcnkuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4vLyBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbi8vIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4vLyByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4vLyB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4vLyBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Vcbi8vIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbi8vXG4vLyAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuLy9cbi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbi8vIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4vLyBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuLy8gS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4vLyBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4vLyB1bmRlciB0aGUgTGljZW5zZS5cblxuaW1wb3J0IHsgVmVjdG9yIH0gZnJvbSAnLi4vLi4vdmVjdG9yJztcbmltcG9ydCB7IGZsYXRidWZmZXJzIH0gZnJvbSAnZmxhdGJ1ZmZlcnMnO1xuaW1wb3J0IHsgVHlwZURhdGFMb2FkZXIgfSBmcm9tICcuL3ZlY3Rvcic7XG5pbXBvcnQgeyBjaGVja0Zvck1hZ2ljQXJyb3dTdHJpbmcsIFBBRERJTkcsIG1hZ2ljQW5kUGFkZGluZywgaXNWYWxpZEFycm93RmlsZSB9IGZyb20gJy4uL21hZ2ljJztcbmltcG9ydCB7IE1lc3NhZ2UsIEZvb3RlciwgRmlsZUJsb2NrLCBSZWNvcmRCYXRjaE1ldGFkYXRhLCBEaWN0aW9uYXJ5QmF0Y2gsIEJ1ZmZlck1ldGFkYXRhLCBGaWVsZE1ldGFkYXRhLCB9IGZyb20gJy4uL21ldGFkYXRhJztcbmltcG9ydCB7XG4gICAgU2NoZW1hLCBGaWVsZCxcbiAgICBEYXRhVHlwZSwgRGljdGlvbmFyeSxcbiAgICBOdWxsLCBUaW1lQml0V2lkdGgsXG4gICAgQmluYXJ5LCBCb29sLCBVdGY4LCBEZWNpbWFsLFxuICAgIERhdGVfLCBUaW1lLCBUaW1lc3RhbXAsIEludGVydmFsLFxuICAgIExpc3QsIFN0cnVjdCwgVW5pb24sIEZpeGVkU2l6ZUJpbmFyeSwgRml4ZWRTaXplTGlzdCwgTWFwXyxcbn0gZnJvbSAnLi4vLi4vdHlwZSc7XG5cbmltcG9ydCB7XG4gICAgSW50OCwgIFVpbnQ4LFxuICAgIEludDE2LCBVaW50MTYsXG4gICAgSW50MzIsIFVpbnQzMixcbiAgICBJbnQ2NCwgVWludDY0LFxuICAgIEZsb2F0MTYsIEZsb2F0NjQsIEZsb2F0MzIsXG59IGZyb20gJy4uLy4uL3R5cGUnO1xuXG5pbXBvcnQgQnl0ZUJ1ZmZlciA9IGZsYXRidWZmZXJzLkJ5dGVCdWZmZXI7XG5cbnR5cGUgTWVzc2FnZVJlYWRlciA9IChiYjogQnl0ZUJ1ZmZlcikgPT4gSXRlcmFibGVJdGVyYXRvcjxNZXNzYWdlPjtcblxuZXhwb3J0IGZ1bmN0aW9uKiByZWFkQnVmZmVyczxUIGV4dGVuZHMgVWludDhBcnJheSB8IEJ1ZmZlciB8IHN0cmluZz4oc291cmNlczogSXRlcmFibGU8VD4gfCBVaW50OEFycmF5IHwgQnVmZmVyIHwgc3RyaW5nKSB7XG4gICAgbGV0IHNjaGVtYTogU2NoZW1hIHwgbnVsbCA9IG51bGw7XG4gICAgbGV0IGRpY3Rpb25hcmllcyA9IG5ldyBNYXA8bnVtYmVyLCBWZWN0b3I+KCk7XG4gICAgbGV0IHJlYWRNZXNzYWdlczogTWVzc2FnZVJlYWRlciB8IG51bGwgPSBudWxsO1xuICAgIGlmIChBcnJheUJ1ZmZlci5pc1ZpZXcoc291cmNlcykgfHwgdHlwZW9mIHNvdXJjZXMgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHNvdXJjZXMgPSBbc291cmNlcyBhcyBUXTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBzb3VyY2Ugb2Ygc291cmNlcykge1xuICAgICAgICBjb25zdCBiYiA9IHRvQnl0ZUJ1ZmZlcihzb3VyY2UpO1xuICAgICAgICBpZiAoKCFzY2hlbWEgJiYgKHsgc2NoZW1hLCByZWFkTWVzc2FnZXMgfSA9IHJlYWRTY2hlbWEoYmIpKSB8fCB0cnVlKSAmJiBzY2hlbWEgJiYgcmVhZE1lc3NhZ2VzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG1lc3NhZ2Ugb2YgcmVhZE1lc3NhZ2VzKGJiKSkge1xuICAgICAgICAgICAgICAgIHlpZWxkIHtcbiAgICAgICAgICAgICAgICAgICAgc2NoZW1hLCBtZXNzYWdlLFxuICAgICAgICAgICAgICAgICAgICBsb2FkZXI6IG5ldyBCaW5hcnlEYXRhTG9hZGVyKFxuICAgICAgICAgICAgICAgICAgICAgICAgYmIsXG4gICAgICAgICAgICAgICAgICAgICAgICBhcnJheUl0ZXJhdG9yKChtZXNzYWdlIGFzIGFueSkubm9kZXMgfHwgW10pLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXJyYXlJdGVyYXRvcigobWVzc2FnZSBhcyBhbnkpLmJ1ZmZlcnMgfHwgW10pLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGljdGlvbmFyaWVzXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24qIHJlYWRCdWZmZXJzQXN5bmM8VCBleHRlbmRzIFVpbnQ4QXJyYXkgfCBCdWZmZXIgfCBzdHJpbmc+KHNvdXJjZXM6IEFzeW5jSXRlcmFibGU8VD4pIHtcbiAgICBsZXQgc2NoZW1hOiBTY2hlbWEgfCBudWxsID0gbnVsbDtcbiAgICBsZXQgZGljdGlvbmFyaWVzID0gbmV3IE1hcDxudW1iZXIsIFZlY3Rvcj4oKTtcbiAgICBsZXQgcmVhZE1lc3NhZ2VzOiBNZXNzYWdlUmVhZGVyIHwgbnVsbCA9IG51bGw7XG4gICAgZm9yIGF3YWl0IChjb25zdCBzb3VyY2Ugb2Ygc291cmNlcykge1xuICAgICAgICBjb25zdCBiYiA9IHRvQnl0ZUJ1ZmZlcihzb3VyY2UpO1xuICAgICAgICBpZiAoKCFzY2hlbWEgJiYgKHsgc2NoZW1hLCByZWFkTWVzc2FnZXMgfSA9IHJlYWRTY2hlbWEoYmIpKSB8fCB0cnVlKSAmJiBzY2hlbWEgJiYgcmVhZE1lc3NhZ2VzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG1lc3NhZ2Ugb2YgcmVhZE1lc3NhZ2VzKGJiKSkge1xuICAgICAgICAgICAgICAgIHlpZWxkIHtcbiAgICAgICAgICAgICAgICAgICAgc2NoZW1hLCBtZXNzYWdlLFxuICAgICAgICAgICAgICAgICAgICBsb2FkZXI6IG5ldyBCaW5hcnlEYXRhTG9hZGVyKFxuICAgICAgICAgICAgICAgICAgICAgICAgYmIsXG4gICAgICAgICAgICAgICAgICAgICAgICBhcnJheUl0ZXJhdG9yKChtZXNzYWdlIGFzIGFueSkubm9kZXMgfHwgW10pLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXJyYXlJdGVyYXRvcigobWVzc2FnZSBhcyBhbnkpLmJ1ZmZlcnMgfHwgW10pLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGljdGlvbmFyaWVzXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgQmluYXJ5RGF0YUxvYWRlciBleHRlbmRzIFR5cGVEYXRhTG9hZGVyIHtcbiAgICBwcml2YXRlIGJ5dGVzOiBVaW50OEFycmF5O1xuICAgIHByaXZhdGUgbWVzc2FnZU9mZnNldDogbnVtYmVyO1xuICAgIGNvbnN0cnVjdG9yKGJiOiBCeXRlQnVmZmVyLCBub2RlczogSXRlcmF0b3I8RmllbGRNZXRhZGF0YT4sIGJ1ZmZlcnM6IEl0ZXJhdG9yPEJ1ZmZlck1ldGFkYXRhPiwgZGljdGlvbmFyaWVzOiBNYXA8bnVtYmVyLCBWZWN0b3I+KSB7XG4gICAgICAgIHN1cGVyKG5vZGVzLCBidWZmZXJzLCBkaWN0aW9uYXJpZXMpO1xuICAgICAgICB0aGlzLmJ5dGVzID0gYmIuYnl0ZXMoKTtcbiAgICAgICAgdGhpcy5tZXNzYWdlT2Zmc2V0ID0gYmIucG9zaXRpb24oKTtcbiAgICB9XG4gICAgcHJvdGVjdGVkIHJlYWRPZmZzZXRzPFQgZXh0ZW5kcyBEYXRhVHlwZT4odHlwZTogVCwgYnVmZmVyPzogQnVmZmVyTWV0YWRhdGEpIHsgcmV0dXJuIHRoaXMucmVhZERhdGEodHlwZSwgYnVmZmVyKTsgfVxuICAgIHByb3RlY3RlZCByZWFkVHlwZUlkczxUIGV4dGVuZHMgRGF0YVR5cGU+KHR5cGU6IFQsIGJ1ZmZlcj86IEJ1ZmZlck1ldGFkYXRhKSB7IHJldHVybiB0aGlzLnJlYWREYXRhKHR5cGUsIGJ1ZmZlcik7IH1cbiAgICBwcm90ZWN0ZWQgcmVhZERhdGE8VCBleHRlbmRzIERhdGFUeXBlPihfdHlwZTogVCwgeyBsZW5ndGgsIG9mZnNldCB9OiBCdWZmZXJNZXRhZGF0YSA9IHRoaXMuZ2V0QnVmZmVyTWV0YWRhdGEoKSkge1xuICAgICAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkodGhpcy5ieXRlcy5idWZmZXIsIHRoaXMuYnl0ZXMuYnl0ZU9mZnNldCArIHRoaXMubWVzc2FnZU9mZnNldCArIG9mZnNldCwgbGVuZ3RoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uKiBhcnJheUl0ZXJhdG9yKGFycjogQXJyYXk8YW55PikgeyB5aWVsZCogYXJyOyB9XG5cbmZ1bmN0aW9uIHRvQnl0ZUJ1ZmZlcihieXRlcz86IFVpbnQ4QXJyYXkgfCBCdWZmZXIgfCBzdHJpbmcpIHtcbiAgICBsZXQgYXJyOiBVaW50OEFycmF5ID0gYnl0ZXMgYXMgYW55IHx8IG5ldyBVaW50OEFycmF5KDApO1xuICAgIGlmICh0eXBlb2YgYnl0ZXMgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGFyciA9IG5ldyBVaW50OEFycmF5KGJ5dGVzLmxlbmd0aCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAtMSwgbiA9IGJ5dGVzLmxlbmd0aDsgKytpIDwgbjspIHtcbiAgICAgICAgICAgIGFycltpXSA9IGJ5dGVzLmNoYXJDb2RlQXQoaSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBCeXRlQnVmZmVyKGFycik7XG4gICAgfVxuICAgIHJldHVybiBuZXcgQnl0ZUJ1ZmZlcihhcnIpO1xufVxuXG5mdW5jdGlvbiByZWFkU2NoZW1hKGJiOiBCeXRlQnVmZmVyKSB7XG4gICAgbGV0IHNjaGVtYTogU2NoZW1hLCByZWFkTWVzc2FnZXMsIGZvb3RlcjogRm9vdGVyIHwgbnVsbDtcbiAgICBpZiAoZm9vdGVyID0gcmVhZEZpbGVTY2hlbWEoYmIpKSB7XG4gICAgICAgIHNjaGVtYSA9IGZvb3Rlci5zY2hlbWE7XG4gICAgICAgIHJlYWRNZXNzYWdlcyA9IHJlYWRGaWxlTWVzc2FnZXMoZm9vdGVyKTtcbiAgICB9IGVsc2UgaWYgKHNjaGVtYSA9IHJlYWRTdHJlYW1TY2hlbWEoYmIpISkge1xuICAgICAgICByZWFkTWVzc2FnZXMgPSByZWFkU3RyZWFtTWVzc2FnZXM7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIEFycm93IGJ1ZmZlcicpO1xuICAgIH1cbiAgICByZXR1cm4geyBzY2hlbWEsIHJlYWRNZXNzYWdlcyB9O1xufVxuXG5mdW5jdGlvbiByZWFkU3RyZWFtU2NoZW1hKGJiOiBCeXRlQnVmZmVyKSB7XG4gICAgaWYgKCFjaGVja0Zvck1hZ2ljQXJyb3dTdHJpbmcoYmIuYnl0ZXMoKSwgMCkpIHtcbiAgICAgICAgZm9yIChjb25zdCBtZXNzYWdlIG9mIHJlYWRNZXNzYWdlcyhiYikpIHtcbiAgICAgICAgICAgIGlmIChNZXNzYWdlLmlzU2NoZW1hKG1lc3NhZ2UpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UgYXMgU2NoZW1hO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufVxuXG5mdW5jdGlvbiogcmVhZFN0cmVhbU1lc3NhZ2VzKGJiOiBCeXRlQnVmZmVyKSB7XG4gICAgZm9yIChjb25zdCBtZXNzYWdlIG9mIHJlYWRNZXNzYWdlcyhiYikpIHtcbiAgICAgICAgaWYgKE1lc3NhZ2UuaXNSZWNvcmRCYXRjaChtZXNzYWdlKSkge1xuICAgICAgICAgICAgeWllbGQgbWVzc2FnZTtcbiAgICAgICAgfSBlbHNlIGlmIChNZXNzYWdlLmlzRGljdGlvbmFyeUJhdGNoKG1lc3NhZ2UpKSB7XG4gICAgICAgICAgICB5aWVsZCBtZXNzYWdlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgeWllbGQgbWVzc2FnZTtcbiAgICAgICAgfVxuICAgICAgICAvLyBwb3NpdGlvbiB0aGUgYnVmZmVyIGFmdGVyIHRoZSBib2R5IHRvIHJlYWQgdGhlIG5leHQgbWVzc2FnZVxuICAgICAgICBiYi5zZXRQb3NpdGlvbihiYi5wb3NpdGlvbigpICsgbWVzc2FnZS5ib2R5TGVuZ3RoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJlYWRGaWxlU2NoZW1hKGJiOiBCeXRlQnVmZmVyKSB7XG4gICAgaWYgKCFpc1ZhbGlkQXJyb3dGaWxlKGJiKSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgbGV0IGZpbGVMZW5ndGggPSBiYi5jYXBhY2l0eSgpO1xuICAgIGxldCBsZW5ndGhPZmZzZXQgPSBmaWxlTGVuZ3RoIC0gbWFnaWNBbmRQYWRkaW5nO1xuICAgIGxldCBmb290ZXJMZW5ndGggPSBiYi5yZWFkSW50MzIobGVuZ3RoT2Zmc2V0KTtcbiAgICBiYi5zZXRQb3NpdGlvbihsZW5ndGhPZmZzZXQgLSBmb290ZXJMZW5ndGgpO1xuICAgIHJldHVybiBmb290ZXJGcm9tQnl0ZUJ1ZmZlcihiYik7XG59XG5cbmZ1bmN0aW9uIHJlYWRGaWxlTWVzc2FnZXMoZm9vdGVyOiBGb290ZXIpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24qIChiYjogQnl0ZUJ1ZmZlcikge1xuICAgICAgICBsZXQgbWVzc2FnZTogUmVjb3JkQmF0Y2hNZXRhZGF0YSB8IERpY3Rpb25hcnlCYXRjaDtcbiAgICAgICAgZm9yIChsZXQgaSA9IC0xLCBiYXRjaGVzID0gZm9vdGVyLmRpY3Rpb25hcnlCYXRjaGVzLCBuID0gYmF0Y2hlcy5sZW5ndGg7ICsraSA8IG47KSB7XG4gICAgICAgICAgICBiYi5zZXRQb3NpdGlvbihiYXRjaGVzW2ldLm9mZnNldCk7XG4gICAgICAgICAgICBpZiAobWVzc2FnZSA9IHJlYWRNZXNzYWdlKGJiLCBiYi5yZWFkSW50MzIoYmIucG9zaXRpb24oKSkpIGFzIERpY3Rpb25hcnlCYXRjaCkge1xuICAgICAgICAgICAgICAgIHlpZWxkIG1lc3NhZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgaSA9IC0xLCBiYXRjaGVzID0gZm9vdGVyLnJlY29yZEJhdGNoZXMsIG4gPSBiYXRjaGVzLmxlbmd0aDsgKytpIDwgbjspIHtcbiAgICAgICAgICAgIGJiLnNldFBvc2l0aW9uKGJhdGNoZXNbaV0ub2Zmc2V0KTtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlID0gcmVhZE1lc3NhZ2UoYmIsIGJiLnJlYWRJbnQzMihiYi5wb3NpdGlvbigpKSkgYXMgUmVjb3JkQmF0Y2hNZXRhZGF0YSkge1xuICAgICAgICAgICAgICAgIHlpZWxkIG1lc3NhZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG5mdW5jdGlvbiogcmVhZE1lc3NhZ2VzKGJiOiBCeXRlQnVmZmVyKSB7XG4gICAgbGV0IGxlbmd0aDogbnVtYmVyLCBtZXNzYWdlOiBTY2hlbWEgfCBSZWNvcmRCYXRjaE1ldGFkYXRhIHwgRGljdGlvbmFyeUJhdGNoO1xuICAgIHdoaWxlIChiYi5wb3NpdGlvbigpIDwgYmIuY2FwYWNpdHkoKSAmJlxuICAgICAgICAgIChsZW5ndGggPSBiYi5yZWFkSW50MzIoYmIucG9zaXRpb24oKSkpID4gMCkge1xuICAgICAgICBpZiAobWVzc2FnZSA9IHJlYWRNZXNzYWdlKGJiLCBsZW5ndGgpISkge1xuICAgICAgICAgICAgeWllbGQgbWVzc2FnZTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gcmVhZE1lc3NhZ2UoYmI6IEJ5dGVCdWZmZXIsIGxlbmd0aDogbnVtYmVyKSB7XG4gICAgYmIuc2V0UG9zaXRpb24oYmIucG9zaXRpb24oKSArIFBBRERJTkcpO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBtZXNzYWdlRnJvbUJ5dGVCdWZmZXIoYmIpO1xuICAgIGJiLnNldFBvc2l0aW9uKGJiLnBvc2l0aW9uKCkgKyBsZW5ndGgpO1xuICAgIHJldHVybiBtZXNzYWdlO1xufVxuXG5pbXBvcnQgKiBhcyBGaWxlXyBmcm9tICcuLi8uLi9mYi9GaWxlJztcbmltcG9ydCAqIGFzIFNjaGVtYV8gZnJvbSAnLi4vLi4vZmIvU2NoZW1hJztcbmltcG9ydCAqIGFzIE1lc3NhZ2VfIGZyb20gJy4uLy4uL2ZiL01lc3NhZ2UnO1xuXG5pbXBvcnQgVHlwZSA9IFNjaGVtYV8ub3JnLmFwYWNoZS5hcnJvdy5mbGF0YnVmLlR5cGU7XG5pbXBvcnQgUHJlY2lzaW9uID0gU2NoZW1hXy5vcmcuYXBhY2hlLmFycm93LmZsYXRidWYuUHJlY2lzaW9uO1xuaW1wb3J0IE1lc3NhZ2VIZWFkZXIgPSBNZXNzYWdlXy5vcmcuYXBhY2hlLmFycm93LmZsYXRidWYuTWVzc2FnZUhlYWRlcjtcbmltcG9ydCBNZXRhZGF0YVZlcnNpb24gPSBTY2hlbWFfLm9yZy5hcGFjaGUuYXJyb3cuZmxhdGJ1Zi5NZXRhZGF0YVZlcnNpb247XG5pbXBvcnQgX0Zvb3RlciA9IEZpbGVfLm9yZy5hcGFjaGUuYXJyb3cuZmxhdGJ1Zi5Gb290ZXI7XG5pbXBvcnQgX0Jsb2NrID0gRmlsZV8ub3JnLmFwYWNoZS5hcnJvdy5mbGF0YnVmLkJsb2NrO1xuaW1wb3J0IF9NZXNzYWdlID0gTWVzc2FnZV8ub3JnLmFwYWNoZS5hcnJvdy5mbGF0YnVmLk1lc3NhZ2U7XG5pbXBvcnQgX1NjaGVtYSA9IFNjaGVtYV8ub3JnLmFwYWNoZS5hcnJvdy5mbGF0YnVmLlNjaGVtYTtcbmltcG9ydCBfRmllbGQgPSBTY2hlbWFfLm9yZy5hcGFjaGUuYXJyb3cuZmxhdGJ1Zi5GaWVsZDtcbmltcG9ydCBfUmVjb3JkQmF0Y2ggPSBNZXNzYWdlXy5vcmcuYXBhY2hlLmFycm93LmZsYXRidWYuUmVjb3JkQmF0Y2g7XG5pbXBvcnQgX0RpY3Rpb25hcnlCYXRjaCA9IE1lc3NhZ2VfLm9yZy5hcGFjaGUuYXJyb3cuZmxhdGJ1Zi5EaWN0aW9uYXJ5QmF0Y2g7XG5pbXBvcnQgX0ZpZWxkTm9kZSA9IE1lc3NhZ2VfLm9yZy5hcGFjaGUuYXJyb3cuZmxhdGJ1Zi5GaWVsZE5vZGU7XG5pbXBvcnQgX0J1ZmZlciA9IFNjaGVtYV8ub3JnLmFwYWNoZS5hcnJvdy5mbGF0YnVmLkJ1ZmZlcjtcbmltcG9ydCBfRGljdGlvbmFyeUVuY29kaW5nID0gU2NoZW1hXy5vcmcuYXBhY2hlLmFycm93LmZsYXRidWYuRGljdGlvbmFyeUVuY29kaW5nO1xuaW1wb3J0IF9OdWxsID0gU2NoZW1hXy5vcmcuYXBhY2hlLmFycm93LmZsYXRidWYuTnVsbDtcbmltcG9ydCBfSW50ID0gU2NoZW1hXy5vcmcuYXBhY2hlLmFycm93LmZsYXRidWYuSW50O1xuaW1wb3J0IF9GbG9hdGluZ1BvaW50ID0gU2NoZW1hXy5vcmcuYXBhY2hlLmFycm93LmZsYXRidWYuRmxvYXRpbmdQb2ludDtcbmltcG9ydCBfQmluYXJ5ID0gU2NoZW1hXy5vcmcuYXBhY2hlLmFycm93LmZsYXRidWYuQmluYXJ5O1xuaW1wb3J0IF9Cb29sID0gU2NoZW1hXy5vcmcuYXBhY2hlLmFycm93LmZsYXRidWYuQm9vbDtcbmltcG9ydCBfVXRmOCA9IFNjaGVtYV8ub3JnLmFwYWNoZS5hcnJvdy5mbGF0YnVmLlV0Zjg7XG5pbXBvcnQgX0RlY2ltYWwgPSBTY2hlbWFfLm9yZy5hcGFjaGUuYXJyb3cuZmxhdGJ1Zi5EZWNpbWFsO1xuaW1wb3J0IF9EYXRlID0gU2NoZW1hXy5vcmcuYXBhY2hlLmFycm93LmZsYXRidWYuRGF0ZTtcbmltcG9ydCBfVGltZSA9IFNjaGVtYV8ub3JnLmFwYWNoZS5hcnJvdy5mbGF0YnVmLlRpbWU7XG5pbXBvcnQgX1RpbWVzdGFtcCA9IFNjaGVtYV8ub3JnLmFwYWNoZS5hcnJvdy5mbGF0YnVmLlRpbWVzdGFtcDtcbmltcG9ydCBfSW50ZXJ2YWwgPSBTY2hlbWFfLm9yZy5hcGFjaGUuYXJyb3cuZmxhdGJ1Zi5JbnRlcnZhbDtcbmltcG9ydCBfTGlzdCA9IFNjaGVtYV8ub3JnLmFwYWNoZS5hcnJvdy5mbGF0YnVmLkxpc3Q7XG5pbXBvcnQgX1N0cnVjdCA9IFNjaGVtYV8ub3JnLmFwYWNoZS5hcnJvdy5mbGF0YnVmLlN0cnVjdF87XG5pbXBvcnQgX1VuaW9uID0gU2NoZW1hXy5vcmcuYXBhY2hlLmFycm93LmZsYXRidWYuVW5pb247XG5pbXBvcnQgX0ZpeGVkU2l6ZUJpbmFyeSA9IFNjaGVtYV8ub3JnLmFwYWNoZS5hcnJvdy5mbGF0YnVmLkZpeGVkU2l6ZUJpbmFyeTtcbmltcG9ydCBfRml4ZWRTaXplTGlzdCA9IFNjaGVtYV8ub3JnLmFwYWNoZS5hcnJvdy5mbGF0YnVmLkZpeGVkU2l6ZUxpc3Q7XG5pbXBvcnQgX01hcCA9IFNjaGVtYV8ub3JnLmFwYWNoZS5hcnJvdy5mbGF0YnVmLk1hcDtcblxuZnVuY3Rpb24gZm9vdGVyRnJvbUJ5dGVCdWZmZXIoYmI6IEJ5dGVCdWZmZXIpIHtcbiAgICBjb25zdCBkaWN0aW9uYXJ5RmllbGRzID0gbmV3IE1hcDxudW1iZXIsIEZpZWxkPERpY3Rpb25hcnk+PigpO1xuICAgIGNvbnN0IGYgPSBfRm9vdGVyLmdldFJvb3RBc0Zvb3RlcihiYiksIHMgPSBmLnNjaGVtYSgpITtcbiAgICByZXR1cm4gbmV3IEZvb3RlcihcbiAgICAgICAgZGljdGlvbmFyeUJhdGNoZXNGcm9tRm9vdGVyKGYpLCByZWNvcmRCYXRjaGVzRnJvbUZvb3RlcihmKSxcbiAgICAgICAgbmV3IFNjaGVtYShmaWVsZHNGcm9tU2NoZW1hKHMsIGRpY3Rpb25hcnlGaWVsZHMpLCBjdXN0b21NZXRhZGF0YShzKSwgZi52ZXJzaW9uKCksIGRpY3Rpb25hcnlGaWVsZHMpXG4gICAgKTtcbn1cblxuZnVuY3Rpb24gbWVzc2FnZUZyb21CeXRlQnVmZmVyKGJiOiBCeXRlQnVmZmVyKSB7XG4gICAgY29uc3QgbSA9IF9NZXNzYWdlLmdldFJvb3RBc01lc3NhZ2UoYmIpISwgdHlwZSA9IG0uaGVhZGVyVHlwZSgpLCB2ZXJzaW9uID0gbS52ZXJzaW9uKCk7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgIGNhc2UgTWVzc2FnZUhlYWRlci5TY2hlbWE6IHJldHVybiBzY2hlbWFGcm9tTWVzc2FnZSh2ZXJzaW9uLCBtLmhlYWRlcihuZXcgX1NjaGVtYSgpKSEsIG5ldyBNYXAoKSk7XG4gICAgICAgIGNhc2UgTWVzc2FnZUhlYWRlci5SZWNvcmRCYXRjaDogcmV0dXJuIHJlY29yZEJhdGNoRnJvbU1lc3NhZ2UodmVyc2lvbiwgbSwgbS5oZWFkZXIobmV3IF9SZWNvcmRCYXRjaCgpKSEpO1xuICAgICAgICBjYXNlIE1lc3NhZ2VIZWFkZXIuRGljdGlvbmFyeUJhdGNoOiByZXR1cm4gZGljdGlvbmFyeUJhdGNoRnJvbU1lc3NhZ2UodmVyc2lvbiwgbSwgbS5oZWFkZXIobmV3IF9EaWN0aW9uYXJ5QmF0Y2goKSkhKTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gICAgLy8gdGhyb3cgbmV3IEVycm9yKGBVbnJlY29nbml6ZWQgTWVzc2FnZSB0eXBlICcke3R5cGV9J2ApO1xufVxuXG5mdW5jdGlvbiBzY2hlbWFGcm9tTWVzc2FnZSh2ZXJzaW9uOiBNZXRhZGF0YVZlcnNpb24sIHM6IF9TY2hlbWEsIGRpY3Rpb25hcnlGaWVsZHM6IE1hcDxudW1iZXIsIEZpZWxkPERpY3Rpb25hcnk+Pikge1xuICAgIHJldHVybiBuZXcgU2NoZW1hKGZpZWxkc0Zyb21TY2hlbWEocywgZGljdGlvbmFyeUZpZWxkcyksIGN1c3RvbU1ldGFkYXRhKHMpLCB2ZXJzaW9uLCBkaWN0aW9uYXJ5RmllbGRzKTtcbn1cblxuZnVuY3Rpb24gcmVjb3JkQmF0Y2hGcm9tTWVzc2FnZSh2ZXJzaW9uOiBNZXRhZGF0YVZlcnNpb24sIG06IF9NZXNzYWdlLCBiOiBfUmVjb3JkQmF0Y2gpIHtcbiAgICByZXR1cm4gbmV3IFJlY29yZEJhdGNoTWV0YWRhdGEodmVyc2lvbiwgYi5sZW5ndGgoKSwgZmllbGROb2Rlc0Zyb21SZWNvcmRCYXRjaChiKSwgYnVmZmVyc0Zyb21SZWNvcmRCYXRjaChiLCB2ZXJzaW9uKSwgbS5ib2R5TGVuZ3RoKCkpO1xufVxuXG5mdW5jdGlvbiBkaWN0aW9uYXJ5QmF0Y2hGcm9tTWVzc2FnZSh2ZXJzaW9uOiBNZXRhZGF0YVZlcnNpb24sIG06IF9NZXNzYWdlLCBkOiBfRGljdGlvbmFyeUJhdGNoKSB7XG4gICAgcmV0dXJuIG5ldyBEaWN0aW9uYXJ5QmF0Y2godmVyc2lvbiwgcmVjb3JkQmF0Y2hGcm9tTWVzc2FnZSh2ZXJzaW9uLCBtLCBkLmRhdGEoKSEpLCBkLmlkKCksIGQuaXNEZWx0YSgpKTtcbn1cblxuZnVuY3Rpb24gZGljdGlvbmFyeUJhdGNoZXNGcm9tRm9vdGVyKGY6IF9Gb290ZXIpIHtcbiAgICBjb25zdCBibG9ja3MgPSBbXSBhcyBGaWxlQmxvY2tbXTtcbiAgICBmb3IgKGxldCBiOiBfQmxvY2ssIGkgPSAtMSwgbiA9IGYgJiYgZi5kaWN0aW9uYXJpZXNMZW5ndGgoKTsgKytpIDwgbjspIHtcbiAgICAgICAgaWYgKGIgPSBmLmRpY3Rpb25hcmllcyhpKSEpIHtcbiAgICAgICAgICAgIGJsb2Nrcy5wdXNoKG5ldyBGaWxlQmxvY2soYi5tZXRhRGF0YUxlbmd0aCgpLCBiLmJvZHlMZW5ndGgoKSwgYi5vZmZzZXQoKSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBibG9ja3M7XG59XG5cbmZ1bmN0aW9uIHJlY29yZEJhdGNoZXNGcm9tRm9vdGVyKGY6IF9Gb290ZXIpIHtcbiAgICBjb25zdCBibG9ja3MgPSBbXSBhcyBGaWxlQmxvY2tbXTtcbiAgICBmb3IgKGxldCBiOiBfQmxvY2ssIGkgPSAtMSwgbiA9IGYgJiYgZi5yZWNvcmRCYXRjaGVzTGVuZ3RoKCk7ICsraSA8IG47KSB7XG4gICAgICAgIGlmIChiID0gZi5yZWNvcmRCYXRjaGVzKGkpISkge1xuICAgICAgICAgICAgYmxvY2tzLnB1c2gobmV3IEZpbGVCbG9jayhiLm1ldGFEYXRhTGVuZ3RoKCksIGIuYm9keUxlbmd0aCgpLCBiLm9mZnNldCgpKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGJsb2Nrcztcbn1cblxuZnVuY3Rpb24gZmllbGRzRnJvbVNjaGVtYShzOiBfU2NoZW1hLCBkaWN0aW9uYXJ5RmllbGRzOiBNYXA8bnVtYmVyLCBGaWVsZDxEaWN0aW9uYXJ5Pj4gfCBudWxsKSB7XG4gICAgY29uc3QgZmllbGRzID0gW10gYXMgRmllbGRbXTtcbiAgICBmb3IgKGxldCBpID0gLTEsIGM6IEZpZWxkIHwgbnVsbCwgbiA9IHMgJiYgcy5maWVsZHNMZW5ndGgoKTsgKytpIDwgbjspIHtcbiAgICAgICAgaWYgKGMgPSBmaWVsZChzLmZpZWxkcyhpKSEsIGRpY3Rpb25hcnlGaWVsZHMpKSB7XG4gICAgICAgICAgICBmaWVsZHMucHVzaChjKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmllbGRzO1xufVxuXG5mdW5jdGlvbiBmaWVsZHNGcm9tRmllbGQoZjogX0ZpZWxkLCBkaWN0aW9uYXJ5RmllbGRzOiBNYXA8bnVtYmVyLCBGaWVsZDxEaWN0aW9uYXJ5Pj4gfCBudWxsKSB7XG4gICAgY29uc3QgZmllbGRzID0gW10gYXMgRmllbGRbXTtcbiAgICBmb3IgKGxldCBpID0gLTEsIGM6IEZpZWxkIHwgbnVsbCwgbiA9IGYgJiYgZi5jaGlsZHJlbkxlbmd0aCgpOyArK2kgPCBuOykge1xuICAgICAgICBpZiAoYyA9IGZpZWxkKGYuY2hpbGRyZW4oaSkhLCBkaWN0aW9uYXJ5RmllbGRzKSkge1xuICAgICAgICAgICAgZmllbGRzLnB1c2goYyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZpZWxkcztcbn1cblxuZnVuY3Rpb24gZmllbGROb2Rlc0Zyb21SZWNvcmRCYXRjaChiOiBfUmVjb3JkQmF0Y2gpIHtcbiAgICBjb25zdCBmaWVsZE5vZGVzID0gW10gYXMgRmllbGRNZXRhZGF0YVtdO1xuICAgIGZvciAobGV0IGkgPSAtMSwgbiA9IGIubm9kZXNMZW5ndGgoKTsgKytpIDwgbjspIHtcbiAgICAgICAgZmllbGROb2Rlcy5wdXNoKGZpZWxkTm9kZUZyb21SZWNvcmRCYXRjaChiLm5vZGVzKGkpISkpO1xuICAgIH1cbiAgICByZXR1cm4gZmllbGROb2Rlcztcbn1cblxuZnVuY3Rpb24gYnVmZmVyc0Zyb21SZWNvcmRCYXRjaChiOiBfUmVjb3JkQmF0Y2gsIHZlcnNpb246IE1ldGFkYXRhVmVyc2lvbikge1xuICAgIGNvbnN0IGJ1ZmZlcnMgPSBbXSBhcyBCdWZmZXJNZXRhZGF0YVtdO1xuICAgIGZvciAobGV0IGkgPSAtMSwgbiA9IGIuYnVmZmVyc0xlbmd0aCgpOyArK2kgPCBuOykge1xuICAgICAgICBsZXQgYnVmZmVyID0gYi5idWZmZXJzKGkpITtcbiAgICAgICAgLy8gSWYgdGhpcyBBcnJvdyBidWZmZXIgd2FzIHdyaXR0ZW4gYmVmb3JlIHZlcnNpb24gNCxcbiAgICAgICAgLy8gYWR2YW5jZSB0aGUgYnVmZmVyJ3MgYmJfcG9zIDggYnl0ZXMgdG8gc2tpcCBwYXN0XG4gICAgICAgIC8vIHRoZSBub3ctcmVtb3ZlZCBwYWdlIGlkIGZpZWxkLlxuICAgICAgICBpZiAodmVyc2lvbiA8IE1ldGFkYXRhVmVyc2lvbi5WNCkge1xuICAgICAgICAgICAgYnVmZmVyLmJiX3BvcyArPSAoOCAqIChpICsgMSkpO1xuICAgICAgICB9XG4gICAgICAgIGJ1ZmZlcnMucHVzaChidWZmZXJGcm9tUmVjb3JkQmF0Y2goYnVmZmVyKSk7XG4gICAgfVxuICAgIHJldHVybiBidWZmZXJzO1xufVxuXG5mdW5jdGlvbiBmaWVsZChmOiBfRmllbGQsIGRpY3Rpb25hcnlGaWVsZHM6IE1hcDxudW1iZXIsIEZpZWxkPERpY3Rpb25hcnk+PiB8IG51bGwpIHtcbiAgICBsZXQgbmFtZSA9IGYubmFtZSgpITtcbiAgICBsZXQgZmllbGQ6IEZpZWxkIHwgdm9pZDtcbiAgICBsZXQgbnVsbGFibGUgPSBmLm51bGxhYmxlKCk7XG4gICAgbGV0IG1ldGFkYXRhID0gY3VzdG9tTWV0YWRhdGEoZik7XG4gICAgbGV0IGRhdGFUeXBlOiBEYXRhVHlwZTxhbnk+IHwgbnVsbDtcbiAgICBsZXQga2V5c01ldGE6IF9JbnQgfCBudWxsLCBpZDogbnVtYmVyO1xuICAgIGxldCBkaWN0TWV0YTogX0RpY3Rpb25hcnlFbmNvZGluZyB8IG51bGw7XG4gICAgaWYgKCFkaWN0aW9uYXJ5RmllbGRzIHx8ICEoZGljdE1ldGEgPSBmLmRpY3Rpb25hcnkoKSkpIHtcbiAgICAgICAgaWYgKGRhdGFUeXBlID0gdHlwZUZyb21GaWVsZChmLCBmaWVsZHNGcm9tRmllbGQoZiwgZGljdGlvbmFyeUZpZWxkcykpKSB7XG4gICAgICAgICAgICBmaWVsZCA9IG5ldyBGaWVsZChuYW1lLCBkYXRhVHlwZSwgbnVsbGFibGUsIG1ldGFkYXRhKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAoZGF0YVR5cGUgPSBkaWN0aW9uYXJ5RmllbGRzLmhhcyhpZCA9IGRpY3RNZXRhLmlkKCkubG93KVxuICAgICAgICAgICAgICAgICAgICAgICAgPyBkaWN0aW9uYXJ5RmllbGRzLmdldChpZCkhLnR5cGUuZGljdGlvbmFyeVxuICAgICAgICAgICAgICAgICAgICAgICAgOiB0eXBlRnJvbUZpZWxkKGYsIGZpZWxkc0Zyb21GaWVsZChmLCBudWxsKSkpIHtcbiAgICAgICAgZGF0YVR5cGUgPSBuZXcgRGljdGlvbmFyeShkYXRhVHlwZSxcbiAgICAgICAgICAgIC8vIGEgZGljdGlvbmFyeSBpbmRleCBkZWZhdWx0cyB0byBzaWduZWQgMzIgYml0IGludCBpZiB1bnNwZWNpZmllZFxuICAgICAgICAgICAgKGtleXNNZXRhID0gZGljdE1ldGEuaW5kZXhUeXBlKCkpID8gaW50RnJvbUZpZWxkKGtleXNNZXRhKSEgOiBuZXcgSW50MzIoKSxcbiAgICAgICAgICAgIGlkLCBkaWN0TWV0YS5pc09yZGVyZWQoKVxuICAgICAgICApO1xuICAgICAgICBmaWVsZCA9IG5ldyBGaWVsZChuYW1lLCBkYXRhVHlwZSwgbnVsbGFibGUsIG1ldGFkYXRhKTtcbiAgICAgICAgZGljdGlvbmFyeUZpZWxkcy5oYXMoaWQpIHx8IGRpY3Rpb25hcnlGaWVsZHMuc2V0KGlkLCBmaWVsZCBhcyBGaWVsZDxEaWN0aW9uYXJ5Pik7XG4gICAgfVxuICAgIHJldHVybiBmaWVsZCB8fCBudWxsO1xufVxuXG5mdW5jdGlvbiBjdXN0b21NZXRhZGF0YShwYXJlbnQ/OiBfU2NoZW1hIHwgX0ZpZWxkIHwgbnVsbCkge1xuICAgIGNvbnN0IGRhdGEgPSBuZXcgTWFwPHN0cmluZywgc3RyaW5nPigpO1xuICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgZm9yIChsZXQgZW50cnksIGtleSwgaSA9IC0xLCBuID0gcGFyZW50LmN1c3RvbU1ldGFkYXRhTGVuZ3RoKCkgfCAwOyArK2kgPCBuOykge1xuICAgICAgICAgICAgaWYgKChlbnRyeSA9IHBhcmVudC5jdXN0b21NZXRhZGF0YShpKSkgJiYgKGtleSA9IGVudHJ5LmtleSgpKSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgZGF0YS5zZXQoa2V5LCBlbnRyeS52YWx1ZSgpISk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGRhdGE7XG59XG5cbmZ1bmN0aW9uIGZpZWxkTm9kZUZyb21SZWNvcmRCYXRjaChmOiBfRmllbGROb2RlKSB7XG4gICAgcmV0dXJuIG5ldyBGaWVsZE1ldGFkYXRhKGYubGVuZ3RoKCksIGYubnVsbENvdW50KCkpO1xufVxuXG5mdW5jdGlvbiBidWZmZXJGcm9tUmVjb3JkQmF0Y2goYjogX0J1ZmZlcikge1xuICAgIHJldHVybiBuZXcgQnVmZmVyTWV0YWRhdGEoYi5vZmZzZXQoKSwgYi5sZW5ndGgoKSk7XG59XG5cbmZ1bmN0aW9uIHR5cGVGcm9tRmllbGQoZjogX0ZpZWxkLCBjaGlsZHJlbj86IEZpZWxkW10pOiBEYXRhVHlwZTxhbnk+IHwgbnVsbCB7XG4gICAgc3dpdGNoIChmLnR5cGVUeXBlKCkpIHtcbiAgICAgICAgY2FzZSBUeXBlLk5PTkU6IHJldHVybiBudWxsO1xuICAgICAgICBjYXNlIFR5cGUuTnVsbDogcmV0dXJuIG51bGxGcm9tRmllbGQoZi50eXBlKG5ldyBfTnVsbCgpKSEpO1xuICAgICAgICBjYXNlIFR5cGUuSW50OiByZXR1cm4gaW50RnJvbUZpZWxkKGYudHlwZShuZXcgX0ludCgpKSEpO1xuICAgICAgICBjYXNlIFR5cGUuRmxvYXRpbmdQb2ludDogcmV0dXJuIGZsb2F0RnJvbUZpZWxkKGYudHlwZShuZXcgX0Zsb2F0aW5nUG9pbnQoKSkhKTtcbiAgICAgICAgY2FzZSBUeXBlLkJpbmFyeTogcmV0dXJuIGJpbmFyeUZyb21GaWVsZChmLnR5cGUobmV3IF9CaW5hcnkoKSkhKTtcbiAgICAgICAgY2FzZSBUeXBlLlV0Zjg6IHJldHVybiB1dGY4RnJvbUZpZWxkKGYudHlwZShuZXcgX1V0ZjgoKSkhKTtcbiAgICAgICAgY2FzZSBUeXBlLkJvb2w6IHJldHVybiBib29sRnJvbUZpZWxkKGYudHlwZShuZXcgX0Jvb2woKSkhKTtcbiAgICAgICAgY2FzZSBUeXBlLkRlY2ltYWw6IHJldHVybiBkZWNpbWFsRnJvbUZpZWxkKGYudHlwZShuZXcgX0RlY2ltYWwoKSkhKTtcbiAgICAgICAgY2FzZSBUeXBlLkRhdGU6IHJldHVybiBkYXRlRnJvbUZpZWxkKGYudHlwZShuZXcgX0RhdGUoKSkhKTtcbiAgICAgICAgY2FzZSBUeXBlLlRpbWU6IHJldHVybiB0aW1lRnJvbUZpZWxkKGYudHlwZShuZXcgX1RpbWUoKSkhKTtcbiAgICAgICAgY2FzZSBUeXBlLlRpbWVzdGFtcDogcmV0dXJuIHRpbWVzdGFtcEZyb21GaWVsZChmLnR5cGUobmV3IF9UaW1lc3RhbXAoKSkhKTtcbiAgICAgICAgY2FzZSBUeXBlLkludGVydmFsOiByZXR1cm4gaW50ZXJ2YWxGcm9tRmllbGQoZi50eXBlKG5ldyBfSW50ZXJ2YWwoKSkhKTtcbiAgICAgICAgY2FzZSBUeXBlLkxpc3Q6IHJldHVybiBsaXN0RnJvbUZpZWxkKGYudHlwZShuZXcgX0xpc3QoKSkhLCBjaGlsZHJlbiB8fCBbXSk7XG4gICAgICAgIGNhc2UgVHlwZS5TdHJ1Y3RfOiByZXR1cm4gc3RydWN0RnJvbUZpZWxkKGYudHlwZShuZXcgX1N0cnVjdCgpKSEsIGNoaWxkcmVuIHx8IFtdKTtcbiAgICAgICAgY2FzZSBUeXBlLlVuaW9uOiByZXR1cm4gdW5pb25Gcm9tRmllbGQoZi50eXBlKG5ldyBfVW5pb24oKSkhLCBjaGlsZHJlbiB8fCBbXSk7XG4gICAgICAgIGNhc2UgVHlwZS5GaXhlZFNpemVCaW5hcnk6IHJldHVybiBmaXhlZFNpemVCaW5hcnlGcm9tRmllbGQoZi50eXBlKG5ldyBfRml4ZWRTaXplQmluYXJ5KCkpISk7XG4gICAgICAgIGNhc2UgVHlwZS5GaXhlZFNpemVMaXN0OiByZXR1cm4gZml4ZWRTaXplTGlzdEZyb21GaWVsZChmLnR5cGUobmV3IF9GaXhlZFNpemVMaXN0KCkpISwgY2hpbGRyZW4gfHwgW10pO1xuICAgICAgICBjYXNlIFR5cGUuTWFwOiByZXR1cm4gbWFwRnJvbUZpZWxkKGYudHlwZShuZXcgX01hcCgpKSEsIGNoaWxkcmVuIHx8IFtdKTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKGBVbnJlY29nbml6ZWQgdHlwZSAke2YudHlwZVR5cGUoKX1gKTtcbn1cblxuZnVuY3Rpb24gbnVsbEZyb21GaWVsZCAgICAgICAgICAgKF90eXBlOiBfTnVsbCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgcmV0dXJuIG5ldyBOdWxsKCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbmZ1bmN0aW9uIGludEZyb21GaWVsZCAgICAgICAgICAgIChfdHlwZTogX0ludCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHN3aXRjaCAoX3R5cGUuYml0V2lkdGgoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIDg6IHJldHVybiBfdHlwZS5pc1NpZ25lZCgpID8gbmV3ICBJbnQ4KCkgOiBuZXcgIFVpbnQ4KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxNjogcmV0dXJuIF90eXBlLmlzU2lnbmVkKCkgPyBuZXcgSW50MTYoKSA6IG5ldyBVaW50MTYoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDMyOiByZXR1cm4gX3R5cGUuaXNTaWduZWQoKSA/IG5ldyBJbnQzMigpIDogbmV3IFVpbnQzMigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjQ6IHJldHVybiBfdHlwZS5pc1NpZ25lZCgpID8gbmV3IEludDY0KCkgOiBuZXcgVWludDY0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuZnVuY3Rpb24gZmxvYXRGcm9tRmllbGQgICAgICAgICAgKF90eXBlOiBfRmxvYXRpbmdQb2ludCkgICAgICAgICAgICAgICAgICAgIHsgc3dpdGNoIChfdHlwZS5wcmVjaXNpb24oKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgUHJlY2lzaW9uLkhBTEY6IHJldHVybiBuZXcgRmxvYXQxNigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgUHJlY2lzaW9uLlNJTkdMRTogcmV0dXJuIG5ldyBGbG9hdDMyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBQcmVjaXNpb24uRE9VQkxFOiByZXR1cm4gbmV3IEZsb2F0NjQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5mdW5jdGlvbiBiaW5hcnlGcm9tRmllbGQgICAgICAgICAoX3R5cGU6IF9CaW5hcnkpICAgICAgICAgICAgICAgICAgICAgICAgICAgeyByZXR1cm4gbmV3IEJpbmFyeSgpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuZnVuY3Rpb24gdXRmOEZyb21GaWVsZCAgICAgICAgICAgKF90eXBlOiBfVXRmOCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgcmV0dXJuIG5ldyBVdGY4KCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbmZ1bmN0aW9uIGJvb2xGcm9tRmllbGQgICAgICAgICAgIChfdHlwZTogX0Jvb2wpICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHJldHVybiBuZXcgQm9vbCgpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5mdW5jdGlvbiBkZWNpbWFsRnJvbUZpZWxkICAgICAgICAoX3R5cGU6IF9EZWNpbWFsKSAgICAgICAgICAgICAgICAgICAgICAgICAgeyByZXR1cm4gbmV3IERlY2ltYWwoX3R5cGUuc2NhbGUoKSwgX3R5cGUucHJlY2lzaW9uKCkpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuZnVuY3Rpb24gZGF0ZUZyb21GaWVsZCAgICAgICAgICAgKF90eXBlOiBfRGF0ZSkgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgcmV0dXJuIG5ldyBEYXRlXyhfdHlwZS51bml0KCkpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbmZ1bmN0aW9uIHRpbWVGcm9tRmllbGQgICAgICAgICAgIChfdHlwZTogX1RpbWUpICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHJldHVybiBuZXcgVGltZShfdHlwZS51bml0KCksIF90eXBlLmJpdFdpZHRoKCkgYXMgVGltZUJpdFdpZHRoKTsgICAgICAgICAgICAgICAgICB9XG5mdW5jdGlvbiB0aW1lc3RhbXBGcm9tRmllbGQgICAgICAoX3R5cGU6IF9UaW1lc3RhbXApICAgICAgICAgICAgICAgICAgICAgICAgeyByZXR1cm4gbmV3IFRpbWVzdGFtcChfdHlwZS51bml0KCksIF90eXBlLnRpbWV6b25lKCkpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuZnVuY3Rpb24gaW50ZXJ2YWxGcm9tRmllbGQgICAgICAgKF90eXBlOiBfSW50ZXJ2YWwpICAgICAgICAgICAgICAgICAgICAgICAgIHsgcmV0dXJuIG5ldyBJbnRlcnZhbChfdHlwZS51bml0KCkpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbmZ1bmN0aW9uIGxpc3RGcm9tRmllbGQgICAgICAgICAgIChfdHlwZTogX0xpc3QsIGNoaWxkcmVuOiBGaWVsZFtdKSAgICAgICAgICB7IHJldHVybiBuZXcgTGlzdChjaGlsZHJlbik7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5mdW5jdGlvbiBzdHJ1Y3RGcm9tRmllbGQgICAgICAgICAoX3R5cGU6IF9TdHJ1Y3QsIGNoaWxkcmVuOiBGaWVsZFtdKSAgICAgICAgeyByZXR1cm4gbmV3IFN0cnVjdChjaGlsZHJlbik7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuZnVuY3Rpb24gdW5pb25Gcm9tRmllbGQgICAgICAgICAgKF90eXBlOiBfVW5pb24sIGNoaWxkcmVuOiBGaWVsZFtdKSAgICAgICAgIHsgcmV0dXJuIG5ldyBVbmlvbihfdHlwZS5tb2RlKCksIChfdHlwZS50eXBlSWRzQXJyYXkoKSB8fCBbXSkgYXMgVHlwZVtdLCBjaGlsZHJlbik7IH1cbmZ1bmN0aW9uIGZpeGVkU2l6ZUJpbmFyeUZyb21GaWVsZChfdHlwZTogX0ZpeGVkU2l6ZUJpbmFyeSkgICAgICAgICAgICAgICAgICB7IHJldHVybiBuZXcgRml4ZWRTaXplQmluYXJ5KF90eXBlLmJ5dGVXaWR0aCgpKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5mdW5jdGlvbiBmaXhlZFNpemVMaXN0RnJvbUZpZWxkICAoX3R5cGU6IF9GaXhlZFNpemVMaXN0LCBjaGlsZHJlbjogRmllbGRbXSkgeyByZXR1cm4gbmV3IEZpeGVkU2l6ZUxpc3QoX3R5cGUubGlzdFNpemUoKSwgY2hpbGRyZW4pOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuZnVuY3Rpb24gbWFwRnJvbUZpZWxkICAgICAgICAgICAgKF90eXBlOiBfTWFwLCBjaGlsZHJlbjogRmllbGRbXSkgICAgICAgICAgIHsgcmV0dXJuIG5ldyBNYXBfKF90eXBlLmtleXNTb3J0ZWQoKSwgY2hpbGRyZW4pOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiJdfQ==
