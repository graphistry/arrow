import * as tslib_1 from "tslib";
export class PipeIterator {
    constructor(iterator, encoding) {
        this.iterator = iterator;
        this.encoding = encoding;
    }
    [Symbol.iterator]() { return this.iterator; }
    next(value) { return this.iterator.next(value); }
    throw(error) {
        if (typeof this.iterator.throw === 'function') {
            return this.iterator.throw(error);
        }
        return { done: true, value: null };
    }
    return(value) {
        if (typeof this.iterator.return === 'function') {
            return this.iterator.return(value);
        }
        return { done: true, value: null };
    }
    pipe(stream) {
        let { encoding } = this;
        let res;
        let write = (err) => {
            stream['removeListener']('error', write);
            stream['removeListener']('drain', write);
            if (err) {
                return this.throw(err);
            }
            if (stream['writable']) {
                do {
                    if ((res = this.next()).done) {
                        break;
                    }
                } while (emit(stream, encoding, res.value));
            }
            return wait(stream, res && res.done, write);
        };
        write();
        return stream;
    }
}
export class AsyncPipeIterator {
    constructor(iterator, encoding) {
        this.iterator = iterator;
        this.encoding = encoding;
    }
    [Symbol.asyncIterator]() { return this.iterator; }
    next(value) { return this.iterator.next(value); }
    throw(error) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            if (typeof this.iterator.throw === 'function') {
                return this.iterator.throw(error);
            }
            return { done: true, value: null };
        });
    }
    return(value) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            if (typeof this.iterator.return === 'function') {
                return this.iterator.return(value);
            }
            return { done: true, value: null };
        });
    }
    pipe(stream) {
        let { encoding } = this;
        let res;
        let write = (err) => tslib_1.__awaiter(this, void 0, void 0, function* () {
            stream['removeListener']('error', write);
            stream['removeListener']('drain', write);
            if (err) {
                return this.throw(err);
            }
            if (stream['writable']) {
                do {
                    if ((res = yield this.next()).done) {
                        break;
                    }
                } while (emit(stream, encoding, res.value));
            }
            return wait(stream, res && res.done, write);
        });
        write();
        return stream;
    }
}
const toBufferOrUint8Array = (() => {
    // If in node, convert Uint8Arrays to Buffer instances. This is necessary
    // because some node APIs ('http' etc.) don't work unless you give them Buffers.
    // This eval also defeats closure-compiler, which doesn't recognize the Buffer constructor.
    const BufferCtor = eval('typeof Buffer !== "undefined" ? Buffer : null');
    return !BufferCtor ? (arr) => arr :
        (arr) => BufferCtor.from(arr.buffer, arr.byteOffset, arr.byteLength);
})();
function emit(stream, encoding, value) {
    return stream['write']((encoding === 'utf8' ? value + '\n' : toBufferOrUint8Array(value)), encoding);
}
function wait(stream, done, write) {
    const p = eval('process'); // defeat closure compiler
    if (!done) {
        stream['once']('error', write);
        stream['once']('drain', write);
    }
    else if (!(!p || stream === p.stdout) && !stream['isTTY']) {
        stream['end']();
    }
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,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Q0FBQyxJQUFJLENBQUUsTUFBYyxDQUFDLE9BQU8sQ0FBQyxFQUFFO1FBQ2xFLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO0tBQ25CO0FBQ0wsQ0FBQyIsImZpbGUiOiJ1dGlsL25vZGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbmV4cG9ydCBjbGFzcyBQaXBlSXRlcmF0b3I8VD4gaW1wbGVtZW50cyBJdGVyYWJsZUl0ZXJhdG9yPFQ+IHtcbiAgICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgaXRlcmF0b3I6IEl0ZXJhYmxlSXRlcmF0b3I8VD4sIHByb3RlY3RlZCBlbmNvZGluZz86IGFueSkge31cbiAgICBbU3ltYm9sLml0ZXJhdG9yXSgpIHsgcmV0dXJuIHRoaXMuaXRlcmF0b3I7IH1cbiAgICBuZXh0KHZhbHVlPzogYW55KSB7IHJldHVybiB0aGlzLml0ZXJhdG9yLm5leHQodmFsdWUpOyB9XG4gICAgdGhyb3coZXJyb3I/OiBhbnkpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLml0ZXJhdG9yLnRocm93ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pdGVyYXRvci50aHJvdyhlcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgZG9uZTogdHJ1ZSwgdmFsdWU6IG51bGwgYXMgYW55IH07XG4gICAgfVxuICAgIHJldHVybih2YWx1ZT86IGFueSkge1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMuaXRlcmF0b3IucmV0dXJuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pdGVyYXRvci5yZXR1cm4odmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IGRvbmU6IHRydWUsIHZhbHVlOiBudWxsIGFzIGFueSB9O1xuICAgIH1cbiAgICBwaXBlKHN0cmVhbTogTm9kZUpTLldyaXRhYmxlU3RyZWFtKSB7XG4gICAgICAgIGxldCB7IGVuY29kaW5nIH0gPSB0aGlzO1xuICAgICAgICBsZXQgcmVzOiBJdGVyYXRvclJlc3VsdDxUPjtcbiAgICAgICAgbGV0IHdyaXRlID0gKGVycj86IGFueSkgPT4ge1xuICAgICAgICAgICAgc3RyZWFtWydyZW1vdmVMaXN0ZW5lciddKCdlcnJvcicsIHdyaXRlKTtcbiAgICAgICAgICAgIHN0cmVhbVsncmVtb3ZlTGlzdGVuZXInXSgnZHJhaW4nLCB3cml0ZSk7XG4gICAgICAgICAgICBpZiAoZXJyKSB7IHJldHVybiB0aGlzLnRocm93KGVycik7IH1cbiAgICAgICAgICAgIGlmIChzdHJlYW1bJ3dyaXRhYmxlJ10pIHtcbiAgICAgICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgocmVzID0gdGhpcy5uZXh0KCkpLmRvbmUpIHsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICB9IHdoaWxlIChlbWl0KHN0cmVhbSwgZW5jb2RpbmcsIHJlcy52YWx1ZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHdhaXQoc3RyZWFtLCByZXMgJiYgcmVzLmRvbmUsIHdyaXRlKTtcbiAgICAgICAgfTtcbiAgICAgICAgd3JpdGUoKTtcbiAgICAgICAgcmV0dXJuIHN0cmVhbTtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBBc3luY1BpcGVJdGVyYXRvcjxUPiBpbXBsZW1lbnRzIEFzeW5jSXRlcmFibGVJdGVyYXRvcjxUPiB7XG4gICAgY29uc3RydWN0b3IocHJvdGVjdGVkIGl0ZXJhdG9yOiBBc3luY0l0ZXJhYmxlSXRlcmF0b3I8VD4sIHByb3RlY3RlZCBlbmNvZGluZz86IGFueSkge31cbiAgICBbU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCkgeyByZXR1cm4gdGhpcy5pdGVyYXRvcjsgfVxuICAgIG5leHQodmFsdWU/OiBhbnkpIHsgcmV0dXJuIHRoaXMuaXRlcmF0b3IubmV4dCh2YWx1ZSk7IH1cbiAgICBhc3luYyB0aHJvdyhlcnJvcj86IGFueSkge1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMuaXRlcmF0b3IudGhyb3cgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLml0ZXJhdG9yLnRocm93KGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBkb25lOiB0cnVlLCB2YWx1ZTogbnVsbCBhcyBhbnkgfTtcbiAgICB9XG4gICAgYXN5bmMgcmV0dXJuKHZhbHVlPzogYW55KSB7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5pdGVyYXRvci5yZXR1cm4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLml0ZXJhdG9yLnJldHVybih2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgZG9uZTogdHJ1ZSwgdmFsdWU6IG51bGwgYXMgYW55IH07XG4gICAgfVxuICAgIHBpcGUoc3RyZWFtOiBOb2RlSlMuV3JpdGFibGVTdHJlYW0pIHtcbiAgICAgICAgbGV0IHsgZW5jb2RpbmcgfSA9IHRoaXM7XG4gICAgICAgIGxldCByZXM6IEl0ZXJhdG9yUmVzdWx0PFQ+O1xuICAgICAgICBsZXQgd3JpdGUgPSBhc3luYyAoZXJyPzogYW55KSA9PiB7XG4gICAgICAgICAgICBzdHJlYW1bJ3JlbW92ZUxpc3RlbmVyJ10oJ2Vycm9yJywgd3JpdGUpO1xuICAgICAgICAgICAgc3RyZWFtWydyZW1vdmVMaXN0ZW5lciddKCdkcmFpbicsIHdyaXRlKTtcbiAgICAgICAgICAgIGlmIChlcnIpIHsgcmV0dXJuIHRoaXMudGhyb3coZXJyKTsgfVxuICAgICAgICAgICAgaWYgKHN0cmVhbVsnd3JpdGFibGUnXSkge1xuICAgICAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChyZXMgPSBhd2FpdCB0aGlzLm5leHQoKSkuZG9uZSkgeyBicmVhazsgfVxuICAgICAgICAgICAgICAgIH0gd2hpbGUgKGVtaXQoc3RyZWFtLCBlbmNvZGluZywgcmVzLnZhbHVlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gd2FpdChzdHJlYW0sIHJlcyAmJiByZXMuZG9uZSwgd3JpdGUpO1xuICAgICAgICB9O1xuICAgICAgICB3cml0ZSgpO1xuICAgICAgICByZXR1cm4gc3RyZWFtO1xuICAgIH1cbn1cblxuY29uc3QgdG9CdWZmZXJPclVpbnQ4QXJyYXkgPSAoKCkgPT4ge1xuICAgIC8vIElmIGluIG5vZGUsIGNvbnZlcnQgVWludDhBcnJheXMgdG8gQnVmZmVyIGluc3RhbmNlcy4gVGhpcyBpcyBuZWNlc3NhcnlcbiAgICAvLyBiZWNhdXNlIHNvbWUgbm9kZSBBUElzICgnaHR0cCcgZXRjLikgZG9uJ3Qgd29yayB1bmxlc3MgeW91IGdpdmUgdGhlbSBCdWZmZXJzLlxuICAgIC8vIFRoaXMgZXZhbCBhbHNvIGRlZmVhdHMgY2xvc3VyZS1jb21waWxlciwgd2hpY2ggZG9lc24ndCByZWNvZ25pemUgdGhlIEJ1ZmZlciBjb25zdHJ1Y3Rvci5cbiAgICBjb25zdCBCdWZmZXJDdG9yID0gZXZhbCgndHlwZW9mIEJ1ZmZlciAhPT0gXCJ1bmRlZmluZWRcIiA/IEJ1ZmZlciA6IG51bGwnKTtcbiAgICByZXR1cm4gIUJ1ZmZlckN0b3IgPyAoYXJyOiBVaW50OEFycmF5KSA9PiBhcnIgOlxuICAgICAgICAoYXJyOiBVaW50OEFycmF5KSA9PiBCdWZmZXJDdG9yLmZyb20oYXJyLmJ1ZmZlciwgYXJyLmJ5dGVPZmZzZXQsIGFyci5ieXRlTGVuZ3RoKTtcbn0pKCk7XG5cbmZ1bmN0aW9uIGVtaXQoc3RyZWFtOiBOb2RlSlMuV3JpdGFibGVTdHJlYW0sIGVuY29kaW5nOiBzdHJpbmcsIHZhbHVlOiBhbnkpIHtcbiAgICByZXR1cm4gc3RyZWFtWyd3cml0ZSddKChlbmNvZGluZyA9PT0gJ3V0ZjgnID8gdmFsdWUgKyAnXFxuJyA6IHRvQnVmZmVyT3JVaW50OEFycmF5KHZhbHVlKSkgYXMgYW55LCBlbmNvZGluZyk7XG59XG5cbmZ1bmN0aW9uIHdhaXQoc3RyZWFtOiBOb2RlSlMuV3JpdGFibGVTdHJlYW0sIGRvbmU6IGJvb2xlYW4sIHdyaXRlOiAoeD86IGFueSkgPT4gdm9pZCkge1xuICAgIGNvbnN0IHAgPSBldmFsKCdwcm9jZXNzJyk7IC8vIGRlZmVhdCBjbG9zdXJlIGNvbXBpbGVyXG4gICAgaWYgKCFkb25lKSB7XG4gICAgICAgIHN0cmVhbVsnb25jZSddKCdlcnJvcicsIHdyaXRlKTtcbiAgICAgICAgc3RyZWFtWydvbmNlJ10oJ2RyYWluJywgd3JpdGUpO1xuICAgIH0gZWxzZSBpZiAoISghcCB8fCBzdHJlYW0gPT09IHAuc3Rkb3V0KSAmJiAhKHN0cmVhbSBhcyBhbnkpWydpc1RUWSddKSB7XG4gICAgICAgIHN0cmVhbVsnZW5kJ10oKTtcbiAgICB9XG59XG4iXX0=
