import * as tslib_1 from "tslib";
export class PipeIterator {
    constructor(iterator, encoding) {
        this.iterator = iterator;
        this.encoding = encoding;
    }
    [Symbol.iterator]() { return this.iterator; }
    next(value) { return this.iterator.next(value); }
    throw(error) {
        if (typeof this.iterator.throw === 'function') {
            return this.iterator.throw(error);
        }
        return { done: true, value: null };
    }
    return(value) {
        if (typeof this.iterator.return === 'function') {
            return this.iterator.return(value);
        }
        return { done: true, value: null };
    }
    pipe(stream) {
        let { encoding } = this;
        let res;
        let write = (err) => {
            stream['removeListener']('error', write);
            stream['removeListener']('drain', write);
            if (err)
                return this.throw(err);
            if (stream['writable']) {
                do {
                    if ((res = this.next()).done)
                        break;
                } while (emit(stream, encoding, res.value));
            }
            return wait(stream, res && res.done, write);
        };
        write();
        return stream;
    }
}
export class AsyncPipeIterator {
    constructor(iterator, encoding) {
        this.iterator = iterator;
        this.encoding = encoding;
    }
    [Symbol.asyncIterator]() { return this.iterator; }
    next(value) { return this.iterator.next(value); }
    throw(error) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            if (typeof this.iterator.throw === 'function') {
                return this.iterator.throw(error);
            }
            return { done: true, value: null };
        });
    }
    return(value) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            if (typeof this.iterator.return === 'function') {
                return this.iterator.return(value);
            }
            return { done: true, value: null };
        });
    }
    pipe(stream) {
        let { encoding } = this;
        let res;
        let write = (err) => tslib_1.__awaiter(this, void 0, void 0, function* () {
            stream['removeListener']('error', write);
            stream['removeListener']('drain', write);
            if (err)
                return this.throw(err);
            if (stream['writable']) {
                do {
                    if ((res = yield this.next()).done)
                        break;
                } while (emit(stream, encoding, res.value));
            }
            return wait(stream, res && res.done, write);
        });
        write();
        return stream;
    }
}
const toBufferOrUint8Array = (() => {
    // If in node, convert Uint8Arrays to Buffer instances. This is necessary
    // because some node APIs ('http' etc.) don't work unless you give them Buffers.
    // This eval also defeats closure-compiler, which doesn't recognize the Buffer constructor.
    const BufferCtor = eval('typeof Buffer !== "undefined" ? Buffer : null');
    return !BufferCtor ? (arr) => arr :
        (arr) => BufferCtor.from(arr.buffer, arr.byteOffset, arr.byteLength);
})();
function emit(stream, encoding, value) {
    return stream['write']((encoding === 'utf8' ? value + '\n' : toBufferOrUint8Array(value)), encoding);
}
function wait(stream, done, write) {
    const p = eval('process'); // defeat closure compiler
    if (!done) {
        stream['once']('error', write);
        stream['once']('drain', write);
    }
    else if (!(!p || stream === p.stdout) && !stream['isTTY']) {
        stream['end']();
    }
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,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Q2xFLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO0tBQ25CO0FBQ0wsQ0FBQyIsImZpbGUiOiJ1dGlsL25vZGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbmV4cG9ydCBjbGFzcyBQaXBlSXRlcmF0b3I8VD4gaW1wbGVtZW50cyBJdGVyYWJsZUl0ZXJhdG9yPFQ+IHtcbiAgICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgaXRlcmF0b3I6IEl0ZXJhYmxlSXRlcmF0b3I8VD4sIHByb3RlY3RlZCBlbmNvZGluZz86IGFueSkge31cbiAgICBbU3ltYm9sLml0ZXJhdG9yXSgpIHsgcmV0dXJuIHRoaXMuaXRlcmF0b3I7IH1cbiAgICBuZXh0KHZhbHVlPzogYW55KSB7IHJldHVybiB0aGlzLml0ZXJhdG9yLm5leHQodmFsdWUpOyB9XG4gICAgdGhyb3coZXJyb3I/OiBhbnkpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLml0ZXJhdG9yLnRocm93ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pdGVyYXRvci50aHJvdyhlcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgZG9uZTogdHJ1ZSwgdmFsdWU6IG51bGwgYXMgYW55IH07XG4gICAgfVxuICAgIHJldHVybih2YWx1ZT86IGFueSkge1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMuaXRlcmF0b3IucmV0dXJuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pdGVyYXRvci5yZXR1cm4odmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IGRvbmU6IHRydWUsIHZhbHVlOiBudWxsIGFzIGFueSB9O1xuICAgIH1cbiAgICBwaXBlKHN0cmVhbTogTm9kZUpTLldyaXRhYmxlU3RyZWFtKSB7XG4gICAgICAgIGxldCB7IGVuY29kaW5nIH0gPSB0aGlzO1xuICAgICAgICBsZXQgcmVzOiBJdGVyYXRvclJlc3VsdDxUPjtcbiAgICAgICAgbGV0IHdyaXRlID0gKGVycj86IGFueSkgPT4ge1xuICAgICAgICAgICAgc3RyZWFtWydyZW1vdmVMaXN0ZW5lciddKCdlcnJvcicsIHdyaXRlKTtcbiAgICAgICAgICAgIHN0cmVhbVsncmVtb3ZlTGlzdGVuZXInXSgnZHJhaW4nLCB3cml0ZSk7XG4gICAgICAgICAgICBpZiAoZXJyKSByZXR1cm4gdGhpcy50aHJvdyhlcnIpO1xuICAgICAgICAgICAgaWYgKHN0cmVhbVsnd3JpdGFibGUnXSkge1xuICAgICAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChyZXMgPSB0aGlzLm5leHQoKSkuZG9uZSkgYnJlYWs7XG4gICAgICAgICAgICAgICAgfSB3aGlsZSAoZW1pdChzdHJlYW0sIGVuY29kaW5nLCByZXMudmFsdWUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB3YWl0KHN0cmVhbSwgcmVzICYmIHJlcy5kb25lLCB3cml0ZSk7XG4gICAgICAgIH07XG4gICAgICAgIHdyaXRlKCk7XG4gICAgICAgIHJldHVybiBzdHJlYW07XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgQXN5bmNQaXBlSXRlcmF0b3I8VD4gaW1wbGVtZW50cyBBc3luY0l0ZXJhYmxlSXRlcmF0b3I8VD4ge1xuICAgIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBpdGVyYXRvcjogQXN5bmNJdGVyYWJsZUl0ZXJhdG9yPFQ+LCBwcm90ZWN0ZWQgZW5jb2Rpbmc/OiBhbnkpIHt9XG4gICAgW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSgpIHsgcmV0dXJuIHRoaXMuaXRlcmF0b3I7IH1cbiAgICBuZXh0KHZhbHVlPzogYW55KSB7IHJldHVybiB0aGlzLml0ZXJhdG9yLm5leHQodmFsdWUpOyB9XG4gICAgYXN5bmMgdGhyb3coZXJyb3I/OiBhbnkpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLml0ZXJhdG9yLnRocm93ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pdGVyYXRvci50aHJvdyhlcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgZG9uZTogdHJ1ZSwgdmFsdWU6IG51bGwgYXMgYW55IH07XG4gICAgfVxuICAgIGFzeW5jIHJldHVybih2YWx1ZT86IGFueSkge1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMuaXRlcmF0b3IucmV0dXJuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pdGVyYXRvci5yZXR1cm4odmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IGRvbmU6IHRydWUsIHZhbHVlOiBudWxsIGFzIGFueSB9O1xuICAgIH1cbiAgICBwaXBlKHN0cmVhbTogTm9kZUpTLldyaXRhYmxlU3RyZWFtKSB7XG4gICAgICAgIGxldCB7IGVuY29kaW5nIH0gPSB0aGlzO1xuICAgICAgICBsZXQgcmVzOiBJdGVyYXRvclJlc3VsdDxUPjtcbiAgICAgICAgbGV0IHdyaXRlID0gYXN5bmMgKGVycj86IGFueSkgPT4ge1xuICAgICAgICAgICAgc3RyZWFtWydyZW1vdmVMaXN0ZW5lciddKCdlcnJvcicsIHdyaXRlKTtcbiAgICAgICAgICAgIHN0cmVhbVsncmVtb3ZlTGlzdGVuZXInXSgnZHJhaW4nLCB3cml0ZSk7XG4gICAgICAgICAgICBpZiAoZXJyKSByZXR1cm4gdGhpcy50aHJvdyhlcnIpO1xuICAgICAgICAgICAgaWYgKHN0cmVhbVsnd3JpdGFibGUnXSkge1xuICAgICAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChyZXMgPSBhd2FpdCB0aGlzLm5leHQoKSkuZG9uZSkgYnJlYWs7XG4gICAgICAgICAgICAgICAgfSB3aGlsZSAoZW1pdChzdHJlYW0sIGVuY29kaW5nLCByZXMudmFsdWUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB3YWl0KHN0cmVhbSwgcmVzICYmIHJlcy5kb25lLCB3cml0ZSk7XG4gICAgICAgIH07XG4gICAgICAgIHdyaXRlKCk7XG4gICAgICAgIHJldHVybiBzdHJlYW07XG4gICAgfVxufVxuXG5jb25zdCB0b0J1ZmZlck9yVWludDhBcnJheSA9ICgoKSA9PiB7XG4gICAgLy8gSWYgaW4gbm9kZSwgY29udmVydCBVaW50OEFycmF5cyB0byBCdWZmZXIgaW5zdGFuY2VzLiBUaGlzIGlzIG5lY2Vzc2FyeVxuICAgIC8vIGJlY2F1c2Ugc29tZSBub2RlIEFQSXMgKCdodHRwJyBldGMuKSBkb24ndCB3b3JrIHVubGVzcyB5b3UgZ2l2ZSB0aGVtIEJ1ZmZlcnMuXG4gICAgLy8gVGhpcyBldmFsIGFsc28gZGVmZWF0cyBjbG9zdXJlLWNvbXBpbGVyLCB3aGljaCBkb2Vzbid0IHJlY29nbml6ZSB0aGUgQnVmZmVyIGNvbnN0cnVjdG9yLlxuICAgIGNvbnN0IEJ1ZmZlckN0b3IgPSBldmFsKCd0eXBlb2YgQnVmZmVyICE9PSBcInVuZGVmaW5lZFwiID8gQnVmZmVyIDogbnVsbCcpO1xuICAgIHJldHVybiAhQnVmZmVyQ3RvciA/IChhcnI6IFVpbnQ4QXJyYXkpID0+IGFyciA6XG4gICAgICAgIChhcnI6IFVpbnQ4QXJyYXkpID0+IEJ1ZmZlckN0b3IuZnJvbShhcnIuYnVmZmVyLCBhcnIuYnl0ZU9mZnNldCwgYXJyLmJ5dGVMZW5ndGgpO1xufSkoKTtcblxuZnVuY3Rpb24gZW1pdChzdHJlYW06IE5vZGVKUy5Xcml0YWJsZVN0cmVhbSwgZW5jb2Rpbmc6IHN0cmluZywgdmFsdWU6IGFueSkge1xuICAgIHJldHVybiBzdHJlYW1bJ3dyaXRlJ10oKGVuY29kaW5nID09PSAndXRmOCcgPyB2YWx1ZSArICdcXG4nIDogdG9CdWZmZXJPclVpbnQ4QXJyYXkodmFsdWUpKSBhcyBhbnksIGVuY29kaW5nKTtcbn1cblxuZnVuY3Rpb24gd2FpdChzdHJlYW06IE5vZGVKUy5Xcml0YWJsZVN0cmVhbSwgZG9uZTogYm9vbGVhbiwgd3JpdGU6ICh4PzogYW55KSA9PiB2b2lkKSB7XG4gICAgY29uc3QgcCA9IGV2YWwoJ3Byb2Nlc3MnKTsgLy8gZGVmZWF0IGNsb3N1cmUgY29tcGlsZXJcbiAgICBpZiAoIWRvbmUpIHtcbiAgICAgICAgc3RyZWFtWydvbmNlJ10oJ2Vycm9yJywgd3JpdGUpO1xuICAgICAgICBzdHJlYW1bJ29uY2UnXSgnZHJhaW4nLCB3cml0ZSk7XG4gICAgfSBlbHNlIGlmICghKCFwIHx8IHN0cmVhbSA9PT0gcC5zdGRvdXQpICYmICEoc3RyZWFtIGFzIGFueSlbJ2lzVFRZJ10pIHtcbiAgICAgICAgc3RyZWFtWydlbmQnXSgpO1xuICAgIH1cbn1cbiJdfQ==
