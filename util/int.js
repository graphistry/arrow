"use strict";
// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.  You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.
Object.defineProperty(exports, "__esModule", { value: true });
const carryBit16 = 1 << 16;
function intAsHex(value) {
    if (value < 0) {
        value = 0xFFFFFFFF + value + 1;
    }
    return `0x${value.toString(16)}`;
}
const kInt32DecimalDigits = 8;
const kPowersOfTen = [1,
    10,
    100,
    1000,
    10000,
    100000,
    1000000,
    10000000,
    100000000];
class BaseInt64 {
    constructor(buffer) {
        this.buffer = buffer;
    }
    high() { return this.buffer[1]; }
    low() { return this.buffer[0]; }
    _times(other) {
        // Break the left and right numbers into 16 bit chunks
        // so that we can multiply them without overflow.
        const L = new Uint32Array([
            this.buffer[1] >>> 16,
            this.buffer[1] & 0xFFFF,
            this.buffer[0] >>> 16,
            this.buffer[0] & 0xFFFF
        ]);
        const R = new Uint32Array([
            other.buffer[1] >>> 16,
            other.buffer[1] & 0xFFFF,
            other.buffer[0] >>> 16,
            other.buffer[0] & 0xFFFF
        ]);
        let product = L[3] * R[3];
        this.buffer[0] = product & 0xFFFF;
        let sum = product >>> 16;
        product = L[2] * R[3];
        sum += product;
        product = (L[3] * R[2]) >>> 0;
        sum += product;
        this.buffer[0] += sum << 16;
        this.buffer[1] = (sum >>> 0 < product ? carryBit16 : 0);
        this.buffer[1] += sum >>> 16;
        this.buffer[1] += L[1] * R[3] + L[2] * R[2] + L[3] * R[1];
        this.buffer[1] += (L[0] * R[3] + L[1] * R[2] + L[2] * R[1] + L[3] * R[0]) << 16;
        return this;
    }
    _plus(other) {
        const sum = (this.buffer[0] + other.buffer[0]) >>> 0;
        this.buffer[1] += other.buffer[1];
        if (sum < (this.buffer[0] >>> 0)) {
            ++this.buffer[1];
        }
        this.buffer[0] = sum;
    }
    lessThan(other) {
        return this.buffer[1] < other.buffer[1] ||
            (this.buffer[1] === other.buffer[1] && this.buffer[0] < other.buffer[0]);
    }
    equals(other) {
        return this.buffer[1] === other.buffer[1] && this.buffer[0] == other.buffer[0];
    }
    greaterThan(other) {
        return other.lessThan(this);
    }
    hex() {
        return `${intAsHex(this.buffer[1])} ${intAsHex(this.buffer[0])}`;
    }
}
exports.BaseInt64 = BaseInt64;
class Uint64 extends BaseInt64 {
    times(other) {
        this._times(other);
        return this;
    }
    plus(other) {
        this._plus(other);
        return this;
    }
    /** @nocollapse */
    static from(val, out_buffer = new Uint32Array(2)) {
        return Uint64.fromString(typeof (val) === 'string' ? val : val.toString(), out_buffer);
    }
    /** @nocollapse */
    static fromNumber(num, out_buffer = new Uint32Array(2)) {
        // Always parse numbers as strings - pulling out high and low bits
        // directly seems to lose precision sometimes
        // For example:
        //     > -4613034156400212000 >>> 0
        //     721782784
        // The correct lower 32-bits are 721782752
        return Uint64.fromString(num.toString(), out_buffer);
    }
    /** @nocollapse */
    static fromString(str, out_buffer = new Uint32Array(2)) {
        const length = str.length;
        let out = new Uint64(out_buffer);
        for (let posn = 0; posn < length;) {
            const group = kInt32DecimalDigits < length - posn ?
                kInt32DecimalDigits : length - posn;
            const chunk = new Uint64(new Uint32Array([parseInt(str.substr(posn, group), 10), 0]));
            const multiple = new Uint64(new Uint32Array([kPowersOfTen[group], 0]));
            out.times(multiple);
            out.plus(chunk);
            posn += group;
        }
        return out;
    }
    /** @nocollapse */
    static convertArray(values) {
        const data = new Uint32Array(values.length * 2);
        for (let i = -1, n = values.length; ++i < n;) {
            Uint64.from(values[i], new Uint32Array(data.buffer, data.byteOffset + 2 * i * 4, 2));
        }
        return data;
    }
    /** @nocollapse */
    static multiply(left, right) {
        let rtrn = new Uint64(new Uint32Array(left.buffer));
        return rtrn.times(right);
    }
    /** @nocollapse */
    static add(left, right) {
        let rtrn = new Uint64(new Uint32Array(left.buffer));
        return rtrn.plus(right);
    }
}
exports.Uint64 = Uint64;
class Int64 extends BaseInt64 {
    negate() {
        this.buffer[0] = ~this.buffer[0] + 1;
        this.buffer[1] = ~this.buffer[1];
        if (this.buffer[0] == 0) {
            ++this.buffer[1];
        }
        return this;
    }
    times(other) {
        this._times(other);
        return this;
    }
    plus(other) {
        this._plus(other);
        return this;
    }
    lessThan(other) {
        // force high bytes to be signed
        const this_high = this.buffer[1] << 0;
        const other_high = other.buffer[1] << 0;
        return this_high < other_high ||
            (this_high === other_high && this.buffer[0] < other.buffer[0]);
    }
    /** @nocollapse */
    static from(val, out_buffer = new Uint32Array(2)) {
        return Int64.fromString(typeof (val) === 'string' ? val : val.toString(), out_buffer);
    }
    /** @nocollapse */
    static fromNumber(num, out_buffer = new Uint32Array(2)) {
        // Always parse numbers as strings - pulling out high and low bits
        // directly seems to lose precision sometimes
        // For example:
        //     > -4613034156400212000 >>> 0
        //     721782784
        // The correct lower 32-bits are 721782752
        return Int64.fromString(num.toString(), out_buffer);
    }
    /** @nocollapse */
    static fromString(str, out_buffer = new Uint32Array(2)) {
        // TODO: Assert that out_buffer is 0 and length = 2
        const negate = str.startsWith('-');
        const length = str.length;
        let out = new Int64(out_buffer);
        for (let posn = negate ? 1 : 0; posn < length;) {
            const group = kInt32DecimalDigits < length - posn ?
                kInt32DecimalDigits : length - posn;
            const chunk = new Int64(new Uint32Array([parseInt(str.substr(posn, group), 10), 0]));
            const multiple = new Int64(new Uint32Array([kPowersOfTen[group], 0]));
            out.times(multiple);
            out.plus(chunk);
            posn += group;
        }
        return negate ? out.negate() : out;
    }
    /** @nocollapse */
    static convertArray(values) {
        const data = new Uint32Array(values.length * 2);
        for (let i = -1, n = values.length; ++i < n;) {
            Int64.from(values[i], new Uint32Array(data.buffer, data.byteOffset + 2 * i * 4, 2));
        }
        return data;
    }
    /** @nocollapse */
    static multiply(left, right) {
        let rtrn = new Int64(new Uint32Array(left.buffer));
        return rtrn.times(right);
    }
    /** @nocollapse */
    static add(left, right) {
        let rtrn = new Int64(new Uint32Array(left.buffer));
        return rtrn.plus(right);
    }
}
exports.Int64 = Int64;
class Int128 {
    constructor(buffer) {
        this.buffer = buffer;
        // buffer[3] MSB (high)
        // buffer[2]
        // buffer[1]
        // buffer[0] LSB (low)
    }
    high() {
        return new Int64(new Uint32Array(this.buffer.buffer, this.buffer.byteOffset + 8, 2));
    }
    low() {
        return new Int64(new Uint32Array(this.buffer.buffer, this.buffer.byteOffset, 2));
    }
    negate() {
        this.buffer[0] = ~this.buffer[0] + 1;
        this.buffer[1] = ~this.buffer[1];
        this.buffer[2] = ~this.buffer[2];
        this.buffer[3] = ~this.buffer[3];
        if (this.buffer[0] == 0) {
            ++this.buffer[1];
        }
        if (this.buffer[1] == 0) {
            ++this.buffer[2];
        }
        if (this.buffer[2] == 0) {
            ++this.buffer[3];
        }
        return this;
    }
    times(other) {
        // Break the left and right numbers into 32 bit chunks
        // so that we can multiply them without overflow.
        const L0 = new Uint64(new Uint32Array([this.buffer[3], 0]));
        const L1 = new Uint64(new Uint32Array([this.buffer[2], 0]));
        const L2 = new Uint64(new Uint32Array([this.buffer[1], 0]));
        const L3 = new Uint64(new Uint32Array([this.buffer[0], 0]));
        const R0 = new Uint64(new Uint32Array([other.buffer[3], 0]));
        const R1 = new Uint64(new Uint32Array([other.buffer[2], 0]));
        const R2 = new Uint64(new Uint32Array([other.buffer[1], 0]));
        const R3 = new Uint64(new Uint32Array([other.buffer[0], 0]));
        let product = Uint64.multiply(L3, R3);
        this.buffer[0] = product.low();
        let sum = new Uint64(new Uint32Array([product.high(), 0]));
        product = Uint64.multiply(L2, R3);
        sum.plus(product);
        product = Uint64.multiply(L3, R2);
        sum.plus(product);
        this.buffer[1] = sum.low();
        this.buffer[3] = (sum.lessThan(product) ? 1 : 0);
        this.buffer[2] = sum.high();
        let high = new Uint64(new Uint32Array(this.buffer.buffer, this.buffer.byteOffset + 8, 2));
        high.plus(Uint64.multiply(L1, R3))
            .plus(Uint64.multiply(L2, R2))
            .plus(Uint64.multiply(L3, R1));
        this.buffer[3] += Uint64.multiply(L0, R3)
            .plus(Uint64.multiply(L1, R2))
            .plus(Uint64.multiply(L2, R1))
            .plus(Uint64.multiply(L3, R0)).low();
        return this;
    }
    plus(other) {
        let sums = new Uint32Array(4);
        sums[3] = (this.buffer[3] + other.buffer[3]) >>> 0;
        sums[2] = (this.buffer[2] + other.buffer[2]) >>> 0;
        sums[1] = (this.buffer[1] + other.buffer[1]) >>> 0;
        sums[0] = (this.buffer[0] + other.buffer[0]) >>> 0;
        if (sums[0] < (this.buffer[0] >>> 0)) {
            ++sums[1];
        }
        if (sums[1] < (this.buffer[1] >>> 0)) {
            ++sums[2];
        }
        if (sums[2] < (this.buffer[2] >>> 0)) {
            ++sums[3];
        }
        this.buffer[3] = sums[3];
        this.buffer[2] = sums[2];
        this.buffer[1] = sums[1];
        this.buffer[0] = sums[0];
        return this;
    }
    hex() {
        return `${intAsHex(this.buffer[3])} ${intAsHex(this.buffer[2])} ${intAsHex(this.buffer[1])} ${intAsHex(this.buffer[0])}`;
    }
    /** @nocollapse */
    static multiply(left, right) {
        let rtrn = new Int128(new Uint32Array(left.buffer));
        return rtrn.times(right);
    }
    /** @nocollapse */
    static add(left, right) {
        let rtrn = new Int128(new Uint32Array(left.buffer));
        return rtrn.plus(right);
    }
    /** @nocollapse */
    static from(val, out_buffer = new Uint32Array(4)) {
        return Int128.fromString(typeof (val) === 'string' ? val : val.toString(), out_buffer);
    }
    /** @nocollapse */
    static fromNumber(num, out_buffer = new Uint32Array(4)) {
        // Always parse numbers as strings - pulling out high and low bits
        // directly seems to lose precision sometimes
        // For example:
        //     > -4613034156400212000 >>> 0
        //     721782784
        // The correct lower 32-bits are 721782752
        return Int128.fromString(num.toString(), out_buffer);
    }
    /** @nocollapse */
    static fromString(str, out_buffer = new Uint32Array(4)) {
        // TODO: Assert that out_buffer is 0 and length = 4
        const negate = str.startsWith('-');
        const length = str.length;
        let out = new Int128(out_buffer);
        for (let posn = negate ? 1 : 0; posn < length;) {
            const group = kInt32DecimalDigits < length - posn ?
                kInt32DecimalDigits : length - posn;
            const chunk = new Int128(new Uint32Array([parseInt(str.substr(posn, group), 10), 0, 0, 0]));
            const multiple = new Int128(new Uint32Array([kPowersOfTen[group], 0, 0, 0]));
            out.times(multiple);
            out.plus(chunk);
            posn += group;
        }
        return negate ? out.negate() : out;
    }
    /** @nocollapse */
    static convertArray(values) {
        // TODO: Distinguish between string and number at compile-time
        const data = new Uint32Array(values.length * 4);
        for (let i = -1, n = values.length; ++i < n;) {
            Int128.from(values[i], new Uint32Array(data.buffer, data.byteOffset + 4 * 4 * i, 4));
        }
        return data;
    }
}
exports.Int128 = Int128;

//# sourceMappingURL=data:application/json;charset=utf8;base64,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Q0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEtBQUssQ0FBQyxHQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUV4RCxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLEdBQUcsS0FBSyxFQUFFLENBQUM7UUFDN0IsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMxRCxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUVoRixPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7SUFFTyxLQUFLLENBQUMsS0FBZ0I7UUFDNUIsTUFBTSxHQUFHLEdBQUcsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDckQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2xDLElBQUksR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLE1B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UUFDdEQsaURBQWlEO1FBQ2pELE1BQU0sRUFBRSxHQUFHLElBQUksTUFBTSxDQUFDLElBQUksV0FBVyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDN0QsTUFBTSxFQUFFLEdBQUcsSUFBSSxNQUFNLENBQUMsSUFBSSxXQUFXLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM3RCxNQUFNLEVBQUUsR0FBRyxJQUFJLE1BQU0sQ0FBQyxJQUFJLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdELE1BQU0sRUFBRSxHQUFHLElBQUksTUFBTSxDQUFDLElBQUksV0FBVyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFN0QsTUFBTSxFQUFFLEdBQUcsSUFBSSxNQUFNLENBQUMsSUFBSSxXQUFXLENBQUMsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM3RCxNQUFNLEVBQUUsR0FBRyxJQUFJLE1BQU0sQ0FBQyxJQUFJLFdBQVcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdELE1BQU0sRUFBRSxHQUFHLElBQUksTUFBTSxDQUFDLElBQUksV0FBVyxDQUFDLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDN0QsTUFBTSxFQUFFLEdBQUcsSUFBSSxNQUFNLENBQUMsSUFBSSxXQUFXLENBQUMsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFD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QUFRLENBQUMsQ0FBQztZQUNwQixHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRWhCLElBQUksSUFBSSxLQUFLLENBQUM7U0FDakI7UUFFRCxPQUFPLE1BQU0sQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUM7SUFDdkMsQ0FBQztJQUVELGtCQUFrQjtJQUNYLE1BQU0sQ0FBQyxZQUFZLENBQUMsTUFBeUI7UUFDaEQsOERBQThEO1FBQzlELE1BQU0sSUFBSSxHQUFHLElBQUksV0FBVyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDaEQsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLEdBQUcsTUFBTSxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsR0FBRyxDQUFDLEdBQUc7WUFDMUMsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxXQUFXLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsVUFBVSxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDeEY7UUFDRCxPQUFPLElBQUksQ0FBQztJQUNoQixDQUFDO0NBQ0o7QUFqS0Qsd0JBaUtDIiwiZmlsZSI6InV0aWwvaW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZVxuLy8gb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXG4vLyBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuLy8gcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZVxuLy8gdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxuLy8gXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4vLyB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4vL1xuLy8gICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbi8vXG4vLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4vLyBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxuLy8gXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbi8vIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZVxuLy8gc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xuLy8gdW5kZXIgdGhlIExpY2Vuc2UuXG5cbmNvbnN0IGNhcnJ5Qml0MTYgPSAxIDw8IDE2O1xuXG5mdW5jdGlvbiBpbnRBc0hleCh2YWx1ZTogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBpZiAodmFsdWUgPCAwKSB7XG4gICAgICAgIHZhbHVlID0gMHhGRkZGRkZGRiArIHZhbHVlICsgMTtcbiAgICB9XG4gICAgcmV0dXJuIGAweCR7dmFsdWUudG9TdHJpbmcoMTYpfWA7XG59XG5cbmNvbnN0IGtJbnQzMkRlY2ltYWxEaWdpdHMgPSA4O1xuY29uc3Qga1Bvd2Vyc09mVGVuID0gWzEsXG4gICAgICAgICAgICAgICAgICAgICAgMTAsXG4gICAgICAgICAgICAgICAgICAgICAgMTAwLFxuICAgICAgICAgICAgICAgICAgICAgIDEwMDAsXG4gICAgICAgICAgICAgICAgICAgICAgMTAwMDAsXG4gICAgICAgICAgICAgICAgICAgICAgMTAwMDAwLFxuICAgICAgICAgICAgICAgICAgICAgIDEwMDAwMDAsXG4gICAgICAgICAgICAgICAgICAgICAgMTAwMDAwMDAsXG4gICAgICAgICAgICAgICAgICAgICAgMTAwMDAwMDAwXTtcblxuZXhwb3J0IGNsYXNzIEJhc2VJbnQ2NCB7XG4gICAgY29uc3RydWN0b3IgKHByb3RlY3RlZCBidWZmZXI6IFVpbnQzMkFycmF5KSB7fVxuXG4gICAgcHVibGljIGhpZ2goKTogbnVtYmVyIHsgcmV0dXJuIHRoaXMuYnVmZmVyWzFdOyB9XG4gICAgcHVibGljIGxvdyAoKTogbnVtYmVyIHsgcmV0dXJuIHRoaXMuYnVmZmVyWzBdOyB9XG5cbiAgICBwcm90ZWN0ZWQgX3RpbWVzKG90aGVyOiBCYXNlSW50NjQpIHtcbiAgICAgICAgLy8gQnJlYWsgdGhlIGxlZnQgYW5kIHJpZ2h0IG51bWJlcnMgaW50byAxNiBiaXQgY2h1bmtzXG4gICAgICAgIC8vIHNvIHRoYXQgd2UgY2FuIG11bHRpcGx5IHRoZW0gd2l0aG91dCBvdmVyZmxvdy5cbiAgICAgICAgY29uc3QgTCA9IG5ldyBVaW50MzJBcnJheShbXG4gICAgICAgICAgICB0aGlzLmJ1ZmZlclsxXSA+Pj4gMTYsXG4gICAgICAgICAgICB0aGlzLmJ1ZmZlclsxXSAmIDB4RkZGRixcbiAgICAgICAgICAgIHRoaXMuYnVmZmVyWzBdID4+PiAxNixcbiAgICAgICAgICAgIHRoaXMuYnVmZmVyWzBdICYgMHhGRkZGXG4gICAgICAgIF0pO1xuXG4gICAgICAgIGNvbnN0IFIgPSBuZXcgVWludDMyQXJyYXkoW1xuICAgICAgICAgICAgb3RoZXIuYnVmZmVyWzFdID4+PiAxNixcbiAgICAgICAgICAgIG90aGVyLmJ1ZmZlclsxXSAmIDB4RkZGRixcbiAgICAgICAgICAgIG90aGVyLmJ1ZmZlclswXSA+Pj4gMTYsXG4gICAgICAgICAgICBvdGhlci5idWZmZXJbMF0gJiAweEZGRkZcbiAgICAgICAgXSk7XG5cbiAgICAgICAgbGV0IHByb2R1Y3QgPSBMWzNdICogUlszXTtcbiAgICAgICAgdGhpcy5idWZmZXJbMF0gPSBwcm9kdWN0ICYgMHhGRkZGO1xuXG4gICAgICAgIGxldCBzdW0gPSBwcm9kdWN0ID4+PiAxNjtcblxuICAgICAgICBwcm9kdWN0ID0gTFsyXSAqIFJbM107XG4gICAgICAgIHN1bSArPSBwcm9kdWN0O1xuXG4gICAgICAgIHByb2R1Y3QgPSAoTFszXSAqIFJbMl0pID4+PiAwO1xuICAgICAgICBzdW0gKz0gcHJvZHVjdDtcblxuICAgICAgICB0aGlzLmJ1ZmZlclswXSArPSBzdW0gPDwgMTY7XG5cbiAgICAgICAgdGhpcy5idWZmZXJbMV0gPSAoc3VtID4+PiAwIDwgcHJvZHVjdCA/IGNhcnJ5Qml0MTYgOiAwKTtcblxuICAgICAgICB0aGlzLmJ1ZmZlclsxXSArPSBzdW0gPj4+IDE2O1xuICAgICAgICB0aGlzLmJ1ZmZlclsxXSArPSBMWzFdICogUlszXSArIExbMl0gKiBSWzJdICsgTFszXSAqIFJbMV07XG4gICAgICAgIHRoaXMuYnVmZmVyWzFdICs9IChMWzBdICogUlszXSArIExbMV0gKiBSWzJdICsgTFsyXSAqIFJbMV0gKyBMWzNdICogUlswXSkgPDwgMTY7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICBwcm90ZWN0ZWQgX3BsdXMob3RoZXI6IEJhc2VJbnQ2NCkge1xuICAgICAgICBjb25zdCBzdW0gPSAodGhpcy5idWZmZXJbMF0gKyBvdGhlci5idWZmZXJbMF0pID4+PiAwO1xuICAgICAgICB0aGlzLmJ1ZmZlclsxXSArPSBvdGhlci5idWZmZXJbMV07XG4gICAgICAgIGlmIChzdW0gPCAodGhpcy5idWZmZXJbMF0gPj4+IDApKSB7XG4gICAgICAgICAgKyt0aGlzLmJ1ZmZlclsxXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmJ1ZmZlclswXSA9IHN1bTtcbiAgICB9XG5cbiAgICBwdWJsaWMgbGVzc1RoYW4ob3RoZXI6IEJhc2VJbnQ2NCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5idWZmZXJbMV0gPCBvdGhlci5idWZmZXJbMV0gfHxcbiAgICAgICAgICAgICh0aGlzLmJ1ZmZlclsxXSA9PT0gb3RoZXIuYnVmZmVyWzFdICYmIHRoaXMuYnVmZmVyWzBdIDwgb3RoZXIuYnVmZmVyWzBdKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZXF1YWxzKG90aGVyOiBCYXNlSW50NjQpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYnVmZmVyWzFdID09PSBvdGhlci5idWZmZXJbMV0gJiYgdGhpcy5idWZmZXJbMF0gPT0gb3RoZXIuYnVmZmVyWzBdO1xuICAgIH1cblxuICAgIHB1YmxpYyBncmVhdGVyVGhhbihvdGhlcjogQmFzZUludDY0KTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBvdGhlci5sZXNzVGhhbih0aGlzKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgaGV4KCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgJHtpbnRBc0hleCh0aGlzLmJ1ZmZlclsxXSl9ICR7aW50QXNIZXgodGhpcy5idWZmZXJbMF0pfWA7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgVWludDY0IGV4dGVuZHMgQmFzZUludDY0IHtcbiAgICBwdWJsaWMgdGltZXMob3RoZXI6IFVpbnQ2NCk6IFVpbnQ2NCB7XG4gICAgICAgIHRoaXMuX3RpbWVzKG90aGVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgcHVibGljIHBsdXMob3RoZXI6IFVpbnQ2NCk6IFVpbnQ2NCB7XG4gICAgICAgIHRoaXMuX3BsdXMob3RoZXIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKiogQG5vY29sbGFwc2UgKi9cbiAgICBwdWJsaWMgc3RhdGljIGZyb20odmFsOiBhbnksIG91dF9idWZmZXIgPSBuZXcgVWludDMyQXJyYXkoMikpOiBVaW50NjQge1xuICAgICAgICByZXR1cm4gVWludDY0LmZyb21TdHJpbmcoXG4gICAgICAgICAgICB0eXBlb2YodmFsKSA9PT0gJ3N0cmluZycgPyB2YWwgOiB2YWwudG9TdHJpbmcoKSxcbiAgICAgICAgICAgIG91dF9idWZmZXJcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvKiogQG5vY29sbGFwc2UgKi9cbiAgICBwdWJsaWMgc3RhdGljIGZyb21OdW1iZXIobnVtOiBudW1iZXIsIG91dF9idWZmZXIgPSBuZXcgVWludDMyQXJyYXkoMikpOiBVaW50NjQge1xuICAgICAgICAvLyBBbHdheXMgcGFyc2UgbnVtYmVycyBhcyBzdHJpbmdzIC0gcHVsbGluZyBvdXQgaGlnaCBhbmQgbG93IGJpdHNcbiAgICAgICAgLy8gZGlyZWN0bHkgc2VlbXMgdG8gbG9zZSBwcmVjaXNpb24gc29tZXRpbWVzXG4gICAgICAgIC8vIEZvciBleGFtcGxlOlxuICAgICAgICAvLyAgICAgPiAtNDYxMzAzNDE1NjQwMDIxMjAwMCA+Pj4gMFxuICAgICAgICAvLyAgICAgNzIxNzgyNzg0XG4gICAgICAgIC8vIFRoZSBjb3JyZWN0IGxvd2VyIDMyLWJpdHMgYXJlIDcyMTc4Mjc1MlxuICAgICAgICByZXR1cm4gVWludDY0LmZyb21TdHJpbmcobnVtLnRvU3RyaW5nKCksIG91dF9idWZmZXIpO1xuICAgIH1cblxuICAgIC8qKiBAbm9jb2xsYXBzZSAqL1xuICAgIHB1YmxpYyBzdGF0aWMgZnJvbVN0cmluZyhzdHI6IHN0cmluZywgb3V0X2J1ZmZlciA9IG5ldyBVaW50MzJBcnJheSgyKSk6IFVpbnQ2NCB7XG4gICAgICAgIGNvbnN0IGxlbmd0aCA9IHN0ci5sZW5ndGg7XG5cbiAgICAgICAgbGV0IG91dCA9IG5ldyBVaW50NjQob3V0X2J1ZmZlcik7XG4gICAgICAgIGZvciAobGV0IHBvc24gPSAwOyBwb3NuIDwgbGVuZ3RoOykge1xuICAgICAgICAgICAgY29uc3QgZ3JvdXAgPSBrSW50MzJEZWNpbWFsRGlnaXRzIDwgbGVuZ3RoIC0gcG9zbiA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGtJbnQzMkRlY2ltYWxEaWdpdHMgOiBsZW5ndGggLSBwb3NuO1xuICAgICAgICAgICAgY29uc3QgY2h1bmsgPSBuZXcgVWludDY0KG5ldyBVaW50MzJBcnJheShbcGFyc2VJbnQoc3RyLnN1YnN0cihwb3NuLCBncm91cCksIDEwKSwgMF0pKTtcbiAgICAgICAgICAgIGNvbnN0IG11bHRpcGxlID0gbmV3IFVpbnQ2NChuZXcgVWludDMyQXJyYXkoW2tQb3dlcnNPZlRlbltncm91cF0sIDBdKSk7XG5cbiAgICAgICAgICAgIG91dC50aW1lcyhtdWx0aXBsZSk7XG4gICAgICAgICAgICBvdXQucGx1cyhjaHVuayk7XG5cbiAgICAgICAgICAgIHBvc24gKz0gZ3JvdXA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH1cblxuICAgIC8qKiBAbm9jb2xsYXBzZSAqL1xuICAgIHB1YmxpYyBzdGF0aWMgY29udmVydEFycmF5KHZhbHVlczogKHN0cmluZ3xudW1iZXIpW10pOiBVaW50MzJBcnJheSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBuZXcgVWludDMyQXJyYXkodmFsdWVzLmxlbmd0aCAqIDIpO1xuICAgICAgICBmb3IgKGxldCBpID0gLTEsIG4gPSB2YWx1ZXMubGVuZ3RoOyArK2kgPCBuOykge1xuICAgICAgICAgICAgVWludDY0LmZyb20odmFsdWVzW2ldLCBuZXcgVWludDMyQXJyYXkoZGF0YS5idWZmZXIsIGRhdGEuYnl0ZU9mZnNldCArIDIgKiBpICogNCwgMikpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cblxuICAgIC8qKiBAbm9jb2xsYXBzZSAqL1xuICAgIHB1YmxpYyBzdGF0aWMgbXVsdGlwbHkobGVmdDogVWludDY0LCByaWdodDogVWludDY0KTogVWludDY0IHtcbiAgICAgICAgbGV0IHJ0cm4gPSBuZXcgVWludDY0KG5ldyBVaW50MzJBcnJheShsZWZ0LmJ1ZmZlcikpO1xuICAgICAgICByZXR1cm4gcnRybi50aW1lcyhyaWdodCk7XG4gICAgfVxuXG4gICAgLyoqIEBub2NvbGxhcHNlICovXG4gICAgcHVibGljIHN0YXRpYyBhZGQobGVmdDogVWludDY0LCByaWdodDogVWludDY0KTogVWludDY0IHtcbiAgICAgICAgbGV0IHJ0cm4gPSBuZXcgVWludDY0KG5ldyBVaW50MzJBcnJheShsZWZ0LmJ1ZmZlcikpO1xuICAgICAgICByZXR1cm4gcnRybi5wbHVzKHJpZ2h0KTtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBJbnQ2NCBleHRlbmRzIEJhc2VJbnQ2NCB7XG4gICAgcHVibGljIG5lZ2F0ZSgpOiBJbnQ2NCB7XG4gICAgICAgIHRoaXMuYnVmZmVyWzBdID0gfnRoaXMuYnVmZmVyWzBdICsgMTtcbiAgICAgICAgdGhpcy5idWZmZXJbMV0gPSB+dGhpcy5idWZmZXJbMV07XG5cbiAgICAgICAgaWYgKHRoaXMuYnVmZmVyWzBdID09IDApIHsgKyt0aGlzLmJ1ZmZlclsxXTsgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBwdWJsaWMgdGltZXMob3RoZXI6IEludDY0KTogSW50NjQge1xuICAgICAgICB0aGlzLl90aW1lcyhvdGhlcik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIHB1YmxpYyBwbHVzKG90aGVyOiBJbnQ2NCk6IEludDY0IHtcbiAgICAgICAgdGhpcy5fcGx1cyhvdGhlcik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIHB1YmxpYyBsZXNzVGhhbihvdGhlcjogSW50NjQpOiBib29sZWFuIHtcbiAgICAgICAgLy8gZm9yY2UgaGlnaCBieXRlcyB0byBiZSBzaWduZWRcbiAgICAgICAgY29uc3QgdGhpc19oaWdoID0gdGhpcy5idWZmZXJbMV0gPDwgMDtcbiAgICAgICAgY29uc3Qgb3RoZXJfaGlnaCA9IG90aGVyLmJ1ZmZlclsxXSA8PCAwO1xuICAgICAgICByZXR1cm4gdGhpc19oaWdoIDwgb3RoZXJfaGlnaCB8fFxuICAgICAgICAgICAgKHRoaXNfaGlnaCA9PT0gb3RoZXJfaGlnaCAmJiB0aGlzLmJ1ZmZlclswXSA8IG90aGVyLmJ1ZmZlclswXSk7XG4gICAgfVxuXG4gICAgLyoqIEBub2NvbGxhcHNlICovXG4gICAgcHVibGljIHN0YXRpYyBmcm9tKHZhbDogYW55LCBvdXRfYnVmZmVyID0gbmV3IFVpbnQzMkFycmF5KDIpKTogSW50NjQge1xuICAgICAgICByZXR1cm4gSW50NjQuZnJvbVN0cmluZyhcbiAgICAgICAgICAgIHR5cGVvZih2YWwpID09PSAnc3RyaW5nJyA/IHZhbCA6IHZhbC50b1N0cmluZygpLFxuICAgICAgICAgICAgb3V0X2J1ZmZlclxuICAgICAgICApO1xuICAgIH1cblxuICAgIC8qKiBAbm9jb2xsYXBzZSAqL1xuICAgIHB1YmxpYyBzdGF0aWMgZnJvbU51bWJlcihudW06IG51bWJlciwgb3V0X2J1ZmZlciA9IG5ldyBVaW50MzJBcnJheSgyKSk6IEludDY0IHtcbiAgICAgICAgLy8gQWx3YXlzIHBhcnNlIG51bWJlcnMgYXMgc3RyaW5ncyAtIHB1bGxpbmcgb3V0IGhpZ2ggYW5kIGxvdyBiaXRzXG4gICAgICAgIC8vIGRpcmVjdGx5IHNlZW1zIHRvIGxvc2UgcHJlY2lzaW9uIHNvbWV0aW1lc1xuICAgICAgICAvLyBGb3IgZXhhbXBsZTpcbiAgICAgICAgLy8gICAgID4gLTQ2MTMwMzQxNTY0MDAyMTIwMDAgPj4+IDBcbiAgICAgICAgLy8gICAgIDcyMTc4Mjc4NFxuICAgICAgICAvLyBUaGUgY29ycmVjdCBsb3dlciAzMi1iaXRzIGFyZSA3MjE3ODI3NTJcbiAgICAgICAgcmV0dXJuIEludDY0LmZyb21TdHJpbmcobnVtLnRvU3RyaW5nKCksIG91dF9idWZmZXIpO1xuICAgIH1cblxuICAgIC8qKiBAbm9jb2xsYXBzZSAqL1xuICAgIHB1YmxpYyBzdGF0aWMgZnJvbVN0cmluZyhzdHI6IHN0cmluZywgb3V0X2J1ZmZlciA9IG5ldyBVaW50MzJBcnJheSgyKSk6IEludDY0IHtcbiAgICAgICAgLy8gVE9ETzogQXNzZXJ0IHRoYXQgb3V0X2J1ZmZlciBpcyAwIGFuZCBsZW5ndGggPSAyXG4gICAgICAgIGNvbnN0IG5lZ2F0ZSA9IHN0ci5zdGFydHNXaXRoKCctJyk7XG4gICAgICAgIGNvbnN0IGxlbmd0aCA9IHN0ci5sZW5ndGg7XG5cbiAgICAgICAgbGV0IG91dCA9IG5ldyBJbnQ2NChvdXRfYnVmZmVyKTtcbiAgICAgICAgZm9yIChsZXQgcG9zbiA9IG5lZ2F0ZSA/IDEgOiAwOyBwb3NuIDwgbGVuZ3RoOykge1xuICAgICAgICAgICAgY29uc3QgZ3JvdXAgPSBrSW50MzJEZWNpbWFsRGlnaXRzIDwgbGVuZ3RoIC0gcG9zbiA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGtJbnQzMkRlY2ltYWxEaWdpdHMgOiBsZW5ndGggLSBwb3NuO1xuICAgICAgICAgICAgY29uc3QgY2h1bmsgPSBuZXcgSW50NjQobmV3IFVpbnQzMkFycmF5KFtwYXJzZUludChzdHIuc3Vic3RyKHBvc24sIGdyb3VwKSwgMTApLCAwXSkpO1xuICAgICAgICAgICAgY29uc3QgbXVsdGlwbGUgPSBuZXcgSW50NjQobmV3IFVpbnQzMkFycmF5KFtrUG93ZXJzT2ZUZW5bZ3JvdXBdLCAwXSkpO1xuXG4gICAgICAgICAgICBvdXQudGltZXMobXVsdGlwbGUpO1xuICAgICAgICAgICAgb3V0LnBsdXMoY2h1bmspO1xuXG4gICAgICAgICAgICBwb3NuICs9IGdyb3VwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZWdhdGUgPyBvdXQubmVnYXRlKCkgOiBvdXQ7XG4gICAgfVxuXG4gICAgLyoqIEBub2NvbGxhcHNlICovXG4gICAgcHVibGljIHN0YXRpYyBjb252ZXJ0QXJyYXkodmFsdWVzOiAoc3RyaW5nfG51bWJlcilbXSk6IFVpbnQzMkFycmF5IHtcbiAgICAgICAgY29uc3QgZGF0YSA9IG5ldyBVaW50MzJBcnJheSh2YWx1ZXMubGVuZ3RoICogMik7XG4gICAgICAgIGZvciAobGV0IGkgPSAtMSwgbiA9IHZhbHVlcy5sZW5ndGg7ICsraSA8IG47KSB7XG4gICAgICAgICAgICBJbnQ2NC5mcm9tKHZhbHVlc1tpXSwgbmV3IFVpbnQzMkFycmF5KGRhdGEuYnVmZmVyLCBkYXRhLmJ5dGVPZmZzZXQgKyAyICogaSAqIDQsIDIpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG5cbiAgICAvKiogQG5vY29sbGFwc2UgKi9cbiAgICBwdWJsaWMgc3RhdGljIG11bHRpcGx5KGxlZnQ6IEludDY0LCByaWdodDogSW50NjQpOiBJbnQ2NCB7XG4gICAgICAgIGxldCBydHJuID0gbmV3IEludDY0KG5ldyBVaW50MzJBcnJheShsZWZ0LmJ1ZmZlcikpO1xuICAgICAgICByZXR1cm4gcnRybi50aW1lcyhyaWdodCk7XG4gICAgfVxuXG4gICAgLyoqIEBub2NvbGxhcHNlICovXG4gICAgcHVibGljIHN0YXRpYyBhZGQobGVmdDogSW50NjQsIHJpZ2h0OiBJbnQ2NCk6IEludDY0IHtcbiAgICAgICAgbGV0IHJ0cm4gPSBuZXcgSW50NjQobmV3IFVpbnQzMkFycmF5KGxlZnQuYnVmZmVyKSk7XG4gICAgICAgIHJldHVybiBydHJuLnBsdXMocmlnaHQpO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIEludDEyOCB7XG4gICAgY29uc3RydWN0b3IgKHByaXZhdGUgYnVmZmVyOiBVaW50MzJBcnJheSkge1xuICAgICAgICAvLyBidWZmZXJbM10gTVNCIChoaWdoKVxuICAgICAgICAvLyBidWZmZXJbMl1cbiAgICAgICAgLy8gYnVmZmVyWzFdXG4gICAgICAgIC8vIGJ1ZmZlclswXSBMU0IgKGxvdylcbiAgICB9XG5cbiAgICBwdWJsaWMgaGlnaCgpOiBJbnQ2NCB7XG4gICAgICAgIHJldHVybiBuZXcgSW50NjQobmV3IFVpbnQzMkFycmF5KHRoaXMuYnVmZmVyLmJ1ZmZlciwgdGhpcy5idWZmZXIuYnl0ZU9mZnNldCArIDgsIDIpKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgbG93KCk6IEludDY0IHtcbiAgICAgICAgcmV0dXJuIG5ldyBJbnQ2NChuZXcgVWludDMyQXJyYXkodGhpcy5idWZmZXIuYnVmZmVyLCB0aGlzLmJ1ZmZlci5ieXRlT2Zmc2V0LCAyKSk7XG4gICAgfVxuXG4gICAgcHVibGljIG5lZ2F0ZSgpOiBJbnQxMjgge1xuICAgICAgICB0aGlzLmJ1ZmZlclswXSA9IH50aGlzLmJ1ZmZlclswXSArIDE7XG4gICAgICAgIHRoaXMuYnVmZmVyWzFdID0gfnRoaXMuYnVmZmVyWzFdO1xuICAgICAgICB0aGlzLmJ1ZmZlclsyXSA9IH50aGlzLmJ1ZmZlclsyXTtcbiAgICAgICAgdGhpcy5idWZmZXJbM10gPSB+dGhpcy5idWZmZXJbM107XG5cbiAgICAgICAgaWYgKHRoaXMuYnVmZmVyWzBdID09IDApIHsgKyt0aGlzLmJ1ZmZlclsxXTsgfVxuICAgICAgICBpZiAodGhpcy5idWZmZXJbMV0gPT0gMCkgeyArK3RoaXMuYnVmZmVyWzJdOyB9XG4gICAgICAgIGlmICh0aGlzLmJ1ZmZlclsyXSA9PSAwKSB7ICsrdGhpcy5idWZmZXJbM107IH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgcHVibGljIHRpbWVzKG90aGVyOiBJbnQxMjgpOiBJbnQxMjgge1xuICAgICAgICAvLyBCcmVhayB0aGUgbGVmdCBhbmQgcmlnaHQgbnVtYmVycyBpbnRvIDMyIGJpdCBjaHVua3NcbiAgICAgICAgLy8gc28gdGhhdCB3ZSBjYW4gbXVsdGlwbHkgdGhlbSB3aXRob3V0IG92ZXJmbG93LlxuICAgICAgICBjb25zdCBMMCA9IG5ldyBVaW50NjQobmV3IFVpbnQzMkFycmF5KFt0aGlzLmJ1ZmZlclszXSwgIDBdKSk7XG4gICAgICAgIGNvbnN0IEwxID0gbmV3IFVpbnQ2NChuZXcgVWludDMyQXJyYXkoW3RoaXMuYnVmZmVyWzJdLCAgMF0pKTtcbiAgICAgICAgY29uc3QgTDIgPSBuZXcgVWludDY0KG5ldyBVaW50MzJBcnJheShbdGhpcy5idWZmZXJbMV0sICAwXSkpO1xuICAgICAgICBjb25zdCBMMyA9IG5ldyBVaW50NjQobmV3IFVpbnQzMkFycmF5KFt0aGlzLmJ1ZmZlclswXSwgIDBdKSk7XG5cbiAgICAgICAgY29uc3QgUjAgPSBuZXcgVWludDY0KG5ldyBVaW50MzJBcnJheShbb3RoZXIuYnVmZmVyWzNdLCAwXSkpO1xuICAgICAgICBjb25zdCBSMSA9IG5ldyBVaW50NjQobmV3IFVpbnQzMkFycmF5KFtvdGhlci5idWZmZXJbMl0sIDBdKSk7XG4gICAgICAgIGNvbnN0IFIyID0gbmV3IFVpbnQ2NChuZXcgVWludDMyQXJyYXkoW290aGVyLmJ1ZmZlclsxXSwgMF0pKTtcbiAgICAgICAgY29uc3QgUjMgPSBuZXcgVWludDY0KG5ldyBVaW50MzJBcnJheShbb3RoZXIuYnVmZmVyWzBdLCAwXSkpO1xuXG4gICAgICAgIGxldCBwcm9kdWN0ID0gVWludDY0Lm11bHRpcGx5KEwzLCBSMyk7XG4gICAgICAgIHRoaXMuYnVmZmVyWzBdID0gcHJvZHVjdC5sb3coKTtcblxuICAgICAgICBsZXQgc3VtID0gbmV3IFVpbnQ2NChuZXcgVWludDMyQXJyYXkoW3Byb2R1Y3QuaGlnaCgpLCAwXSkpO1xuXG4gICAgICAgIHByb2R1Y3QgPSBVaW50NjQubXVsdGlwbHkoTDIsIFIzKTtcbiAgICAgICAgc3VtLnBsdXMocHJvZHVjdCk7XG5cbiAgICAgICAgcHJvZHVjdCA9IFVpbnQ2NC5tdWx0aXBseShMMywgUjIpO1xuICAgICAgICBzdW0ucGx1cyhwcm9kdWN0KTtcblxuICAgICAgICB0aGlzLmJ1ZmZlclsxXSA9IHN1bS5sb3coKTtcblxuICAgICAgICB0aGlzLmJ1ZmZlclszXSA9IChzdW0ubGVzc1RoYW4ocHJvZHVjdCkgPyAxIDogMCk7XG5cbiAgICAgICAgdGhpcy5idWZmZXJbMl0gPSBzdW0uaGlnaCgpO1xuICAgICAgICBsZXQgaGlnaCA9IG5ldyBVaW50NjQobmV3IFVpbnQzMkFycmF5KHRoaXMuYnVmZmVyLmJ1ZmZlciwgdGhpcy5idWZmZXIuYnl0ZU9mZnNldCArIDgsIDIpKTtcblxuICAgICAgICBoaWdoLnBsdXMoVWludDY0Lm11bHRpcGx5KEwxLCBSMykpXG4gICAgICAgICAgICAucGx1cyhVaW50NjQubXVsdGlwbHkoTDIsIFIyKSlcbiAgICAgICAgICAgIC5wbHVzKFVpbnQ2NC5tdWx0aXBseShMMywgUjEpKTtcbiAgICAgICAgdGhpcy5idWZmZXJbM10gKz0gVWludDY0Lm11bHRpcGx5KEwwLCBSMylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wbHVzKFVpbnQ2NC5tdWx0aXBseShMMSwgUjIpKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnBsdXMoVWludDY0Lm11bHRpcGx5KEwyLCBSMSkpXG4gICAgICAgICAgICAgICAgICAgICAgICAucGx1cyhVaW50NjQubXVsdGlwbHkoTDMsIFIwKSkubG93KCk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgcHVibGljIHBsdXMob3RoZXI6IEludDEyOCk6IEludDEyOCB7XG4gICAgICAgIGxldCBzdW1zID0gbmV3IFVpbnQzMkFycmF5KDQpO1xuICAgICAgICBzdW1zWzNdID0gKHRoaXMuYnVmZmVyWzNdICsgb3RoZXIuYnVmZmVyWzNdKSA+Pj4gMDtcbiAgICAgICAgc3Vtc1syXSA9ICh0aGlzLmJ1ZmZlclsyXSArIG90aGVyLmJ1ZmZlclsyXSkgPj4+IDA7XG4gICAgICAgIHN1bXNbMV0gPSAodGhpcy5idWZmZXJbMV0gKyBvdGhlci5idWZmZXJbMV0pID4+PiAwO1xuICAgICAgICBzdW1zWzBdID0gKHRoaXMuYnVmZmVyWzBdICsgb3RoZXIuYnVmZmVyWzBdKSA+Pj4gMDtcblxuICAgICAgICBpZiAoc3Vtc1swXSA8ICh0aGlzLmJ1ZmZlclswXSA+Pj4gMCkpIHtcbiAgICAgICAgICAgICsrc3Vtc1sxXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3Vtc1sxXSA8ICh0aGlzLmJ1ZmZlclsxXSA+Pj4gMCkpIHtcbiAgICAgICAgICAgICsrc3Vtc1syXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3Vtc1syXSA8ICh0aGlzLmJ1ZmZlclsyXSA+Pj4gMCkpIHtcbiAgICAgICAgICAgICsrc3Vtc1szXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuYnVmZmVyWzNdID0gc3Vtc1szXTtcbiAgICAgICAgdGhpcy5idWZmZXJbMl0gPSBzdW1zWzJdO1xuICAgICAgICB0aGlzLmJ1ZmZlclsxXSA9IHN1bXNbMV07XG4gICAgICAgIHRoaXMuYnVmZmVyWzBdID0gc3Vtc1swXTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBwdWJsaWMgaGV4KCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgJHtpbnRBc0hleCh0aGlzLmJ1ZmZlclszXSl9ICR7aW50QXNIZXgodGhpcy5idWZmZXJbMl0pfSAke2ludEFzSGV4KHRoaXMuYnVmZmVyWzFdKX0gJHtpbnRBc0hleCh0aGlzLmJ1ZmZlclswXSl9YDtcbiAgICB9XG5cbiAgICAvKiogQG5vY29sbGFwc2UgKi9cbiAgICBwdWJsaWMgc3RhdGljIG11bHRpcGx5KGxlZnQ6IEludDEyOCwgcmlnaHQ6IEludDEyOCk6IEludDEyOCB7XG4gICAgICAgIGxldCBydHJuID0gbmV3IEludDEyOChuZXcgVWludDMyQXJyYXkobGVmdC5idWZmZXIpKTtcbiAgICAgICAgcmV0dXJuIHJ0cm4udGltZXMocmlnaHQpO1xuICAgIH1cblxuICAgIC8qKiBAbm9jb2xsYXBzZSAqL1xuICAgIHB1YmxpYyBzdGF0aWMgYWRkKGxlZnQ6IEludDEyOCwgcmlnaHQ6IEludDEyOCk6IEludDEyOCB7XG4gICAgICAgIGxldCBydHJuID0gbmV3IEludDEyOChuZXcgVWludDMyQXJyYXkobGVmdC5idWZmZXIpKTtcbiAgICAgICAgcmV0dXJuIHJ0cm4ucGx1cyhyaWdodCk7XG4gICAgfVxuXG4gICAgLyoqIEBub2NvbGxhcHNlICovXG4gICAgcHVibGljIHN0YXRpYyBmcm9tKHZhbDogYW55LCBvdXRfYnVmZmVyID0gbmV3IFVpbnQzMkFycmF5KDQpKTogSW50MTI4IHtcbiAgICAgICAgcmV0dXJuIEludDEyOC5mcm9tU3RyaW5nKFxuICAgICAgICAgICAgdHlwZW9mKHZhbCkgPT09ICdzdHJpbmcnID8gdmFsIDogdmFsLnRvU3RyaW5nKCksXG4gICAgICAgICAgICBvdXRfYnVmZmVyXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqIEBub2NvbGxhcHNlICovXG4gICAgcHVibGljIHN0YXRpYyBmcm9tTnVtYmVyKG51bTogbnVtYmVyLCBvdXRfYnVmZmVyID0gbmV3IFVpbnQzMkFycmF5KDQpKTogSW50MTI4IHtcbiAgICAgICAgLy8gQWx3YXlzIHBhcnNlIG51bWJlcnMgYXMgc3RyaW5ncyAtIHB1bGxpbmcgb3V0IGhpZ2ggYW5kIGxvdyBiaXRzXG4gICAgICAgIC8vIGRpcmVjdGx5IHNlZW1zIHRvIGxvc2UgcHJlY2lzaW9uIHNvbWV0aW1lc1xuICAgICAgICAvLyBGb3IgZXhhbXBsZTpcbiAgICAgICAgLy8gICAgID4gLTQ2MTMwMzQxNTY0MDAyMTIwMDAgPj4+IDBcbiAgICAgICAgLy8gICAgIDcyMTc4Mjc4NFxuICAgICAgICAvLyBUaGUgY29ycmVjdCBsb3dlciAzMi1iaXRzIGFyZSA3MjE3ODI3NTJcbiAgICAgICAgcmV0dXJuIEludDEyOC5mcm9tU3RyaW5nKG51bS50b1N0cmluZygpLCBvdXRfYnVmZmVyKTtcbiAgICB9XG5cbiAgICAvKiogQG5vY29sbGFwc2UgKi9cbiAgICBwdWJsaWMgc3RhdGljIGZyb21TdHJpbmcoc3RyOiBzdHJpbmcsIG91dF9idWZmZXIgPSBuZXcgVWludDMyQXJyYXkoNCkpOiBJbnQxMjgge1xuICAgICAgICAvLyBUT0RPOiBBc3NlcnQgdGhhdCBvdXRfYnVmZmVyIGlzIDAgYW5kIGxlbmd0aCA9IDRcbiAgICAgICAgY29uc3QgbmVnYXRlID0gc3RyLnN0YXJ0c1dpdGgoJy0nKTtcbiAgICAgICAgY29uc3QgbGVuZ3RoID0gc3RyLmxlbmd0aDtcblxuICAgICAgICBsZXQgb3V0ID0gbmV3IEludDEyOChvdXRfYnVmZmVyKTtcbiAgICAgICAgZm9yIChsZXQgcG9zbiA9IG5lZ2F0ZSA/IDEgOiAwOyBwb3NuIDwgbGVuZ3RoOykge1xuICAgICAgICAgICAgY29uc3QgZ3JvdXAgPSBrSW50MzJEZWNpbWFsRGlnaXRzIDwgbGVuZ3RoIC0gcG9zbiA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGtJbnQzMkRlY2ltYWxEaWdpdHMgOiBsZW5ndGggLSBwb3NuO1xuICAgICAgICAgICAgY29uc3QgY2h1bmsgPSBuZXcgSW50MTI4KG5ldyBVaW50MzJBcnJheShbcGFyc2VJbnQoc3RyLnN1YnN0cihwb3NuLCBncm91cCksIDEwKSwgMCwgMCwgMF0pKTtcbiAgICAgICAgICAgIGNvbnN0IG11bHRpcGxlID0gbmV3IEludDEyOChuZXcgVWludDMyQXJyYXkoW2tQb3dlcnNPZlRlbltncm91cF0sIDAsIDAsIDBdKSk7XG5cbiAgICAgICAgICAgIG91dC50aW1lcyhtdWx0aXBsZSk7XG4gICAgICAgICAgICBvdXQucGx1cyhjaHVuayk7XG5cbiAgICAgICAgICAgIHBvc24gKz0gZ3JvdXA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmVnYXRlID8gb3V0Lm5lZ2F0ZSgpIDogb3V0O1xuICAgIH1cblxuICAgIC8qKiBAbm9jb2xsYXBzZSAqL1xuICAgIHB1YmxpYyBzdGF0aWMgY29udmVydEFycmF5KHZhbHVlczogKHN0cmluZ3xudW1iZXIpW10pOiBVaW50MzJBcnJheSB7XG4gICAgICAgIC8vIFRPRE86IERpc3Rpbmd1aXNoIGJldHdlZW4gc3RyaW5nIGFuZCBudW1iZXIgYXQgY29tcGlsZS10aW1lXG4gICAgICAgIGNvbnN0IGRhdGEgPSBuZXcgVWludDMyQXJyYXkodmFsdWVzLmxlbmd0aCAqIDQpO1xuICAgICAgICBmb3IgKGxldCBpID0gLTEsIG4gPSB2YWx1ZXMubGVuZ3RoOyArK2kgPCBuOykge1xuICAgICAgICAgICAgSW50MTI4LmZyb20odmFsdWVzW2ldLCBuZXcgVWludDMyQXJyYXkoZGF0YS5idWZmZXIsIGRhdGEuYnl0ZU9mZnNldCArIDQgKiA0ICogaSwgNCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cbn1cbiJdfQ==
