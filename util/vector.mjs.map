{"version":3,"sources":["util/vector.ts"],"names":[],"mappings":"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","file":"vector.js","sourcesContent":["// Licensed to the Apache Software Foundation (ASF) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The ASF licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\nimport { Vector } from '../vector';\nimport { Row, kLength } from '../vector/row';\nimport { compareArrayLike } from '../util/buffer';\nimport { BigInt, BigIntAvailable } from './compat';\n\n/** @ignore */\ntype RangeLike = { length: number; stride?: number };\n/** @ignore */\ntype ClampThen<T extends RangeLike> = (source: T, index: number) => any;\n/** @ignore */\ntype ClampRangeThen<T extends RangeLike> = (source: T, offset: number, length: number) => any;\n\nexport function clampIndex<T extends RangeLike>(source: T, index: number): number;\nexport function clampIndex<T extends RangeLike, N extends ClampThen<T> = ClampThen<T>>(source: T, index: number, then: N): ReturnType<N>;\n/** @ignore */\nexport function clampIndex<T extends RangeLike, N extends ClampThen<T> = ClampThen<T>>(source: T, index: number, then?: N) {\n    const length = source.length;\n    const adjust = index > -1 ? index : (length + (index % length));\n    return then ? then(source, adjust) : adjust;\n}\n\n/** @ignore */\nlet tmp: number;\nexport function clampRange<T extends RangeLike>(source: T, begin: number | undefined, end: number | undefined): [number, number];\nexport function clampRange<T extends RangeLike, N extends ClampRangeThen<T> = ClampRangeThen<T>>(source: T, begin: number | undefined, end: number | undefined, then: N): ReturnType<N>;\n/** @ignore */\nexport function clampRange<T extends RangeLike, N extends ClampRangeThen<T> = ClampRangeThen<T>>(source: T, begin: number | undefined, end: number | undefined, then?: N) {\n\n    // Adjust args similar to Array.prototype.slice. Normalize begin/end to\n    // clamp between 0 and length, and wrap around on negative indices, e.g.\n    // slice(-1, 5) or slice(5, -1)\n    let { length: len = 0 } = source;\n    let lhs = typeof begin !== 'number' ? 0 : begin;\n    let rhs = typeof end !== 'number' ? len : end;\n    // wrap around on negative start/end positions\n    (lhs < 0) && (lhs = ((lhs % len) + len) % len);\n    (rhs < 0) && (rhs = ((rhs % len) + len) % len);\n    // ensure lhs <= rhs\n    (rhs < lhs) && (tmp = lhs, lhs = rhs, rhs = tmp);\n     // ensure rhs <= length\n    (rhs > len) && (rhs = len);\n\n    return then ? then(source, lhs, rhs) : [lhs, rhs];\n}\n\nconst big0 = BigIntAvailable ? BigInt(0) : 0;\n\n/** @ignore */\nexport function createElementComparator(search: any) {\n    let typeofSearch = typeof search;\n    // Compare primitives\n    if (typeofSearch !== 'object' || search === null) {\n        return typeofSearch !== 'bigint'\n            ? (value: any) => value === search\n            : (value: any) => (big0 + value) === search;\n    }\n    // Compare Dates\n    if (search instanceof Date) {\n        const valueOfSearch = search.valueOf();\n        return (value: any) => value instanceof Date ? (value.valueOf() === valueOfSearch) : false;\n    }\n    if (ArrayBuffer.isView(search)) {\n        return (value: any) => value ? compareArrayLike(search, value) : false;\n    }\n    // Compare Array-likes\n    if (Array.isArray(search)) {\n        return createArrayLikeComparator(search);\n    }\n    // Compare Rows\n    if (search instanceof Row) {\n        return createRowComparator(search);\n    }\n    // Compare Vectors\n    if (search instanceof Vector) {\n        return createVectorComparator(search);\n    }\n    // Compare non-empty Objects\n    const keys = Object.keys(search);\n    if (keys.length > 0) {\n        return createObjectKeysComparator(search, keys);\n    }\n    // No valid comparator\n    return () => false;\n}\n\n/** @ignore */\nfunction createArrayLikeComparator(search: ArrayLike<any>) {\n    const n = search.length;\n    const fns = [] as ((x: any) => boolean)[];\n    for (let i = -1; ++i < n;) {\n        fns[i] = createElementComparator((search as any)[i]);\n    }\n    return (value: any) => {\n        if (!value) { return false; }\n        // Handle the case where the search element is an Array, but the\n        // values are Rows or Vectors, e.g. list.indexOf(['foo', 'bar'])\n        if (value instanceof Row) {\n            if (value[kLength] !== n) { return false; }\n            for (let i = -1; ++i < n;) {\n                if (!(fns[i](value.get(i)))) { return false; }\n            }\n            return true;\n        }\n        if (value.length !== n) { return false; }\n        if (value instanceof Vector) {\n            for (let i = -1; ++i < n;) {\n                if (!(fns[i](value.get(i)))) { return false; }\n            }\n            return true;\n        }\n        for (let i = -1; ++i < n;) {\n            if (!(fns[i](value[i]))) { return false; }\n        }\n        return true;\n    };\n}\n\n/** @ignore */\nfunction createRowComparator(search: Row<any>) {\n    const n = search[kLength];\n    const C = search.constructor as any;\n    const fns = [] as ((x: any) => boolean)[];\n    for (let i = -1; ++i < n;) {\n        fns[i] = createElementComparator(search.get(i));\n    }\n    return (value: any) => {\n        if (!(value instanceof C)) { return false; }\n        if (!(value[kLength] === n)) { return false; }\n        for (let i = -1; ++i < n;) {\n            if (!(fns[i](value.get(i)))) { return false; }\n        }\n        return true;\n    };\n}\n\n/** @ignore */\nfunction createVectorComparator(search: Vector<any>) {\n    const n = search.length;\n    const C = search.constructor as any;\n    const fns = [] as ((x: any) => boolean)[];\n    for (let i = -1; ++i < n;) {\n        fns[i] = createElementComparator((search as any).get(i));\n    }\n    return (value: any) => {\n        if (!(value instanceof C)) { return false; }\n        if (!(value.length === n)) { return false; }\n        for (let i = -1; ++i < n;) {\n            if (!(fns[i](value.get(i)))) { return false; }\n        }\n        return true;\n    };\n}\n\n/** @ignore */\nfunction createObjectKeysComparator(search: any, keys: string[]) {\n    const n = keys.length;\n    const fns = [] as ((x: any) => boolean)[];\n    for (let i = -1; ++i < n;) {\n        fns[i] = createElementComparator(search[keys[i]]);\n    }\n    return (value: any) => {\n        if (!value || typeof value !== 'object') { return false; }\n        for (let i = -1; ++i < n;) {\n            if (!(fns[i](value[keys[i]]))) { return false; }\n        }\n        return true;\n    };\n}\n"]}